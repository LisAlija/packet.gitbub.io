function ColorLuminance(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e}function moduleXmlloader(){}var Helpers=Helpers||{};Helpers.tweenObject=function(a,b,c,d){function e(a){var b,c,i,j,k,l,m=-1,n=-1,o=.5;(null!=f[a].getAttribute("alpha")||void 0!=f[a].getAttribute("alpha"))&&(b=f[a].getAttribute("alpha")),(null!=f[a].getAttribute("x")||void 0!=f[a].getAttribute("x"))&&(c=f[a].getAttribute("x")),(null!=f[a].getAttribute("y")||void 0!=f[a].getAttribute("y"))&&(i=f[a].getAttribute("y")),(null!=f[a].getAttribute("scaleX")||void 0!=f[a].getAttribute("scaleX"))&&(k=f[a].getAttribute("scaleX"),m=g.width*k),(null!=f[a].getAttribute("scaleY")||void 0!=f[a].getAttribute("scaleY"))&&(l=f[a].getAttribute("scaleY"),n=g.height*l),(null!=f[a].getAttribute("delay")||void 0!=f[a].getAttribute("delay"))&&(j=f[a].getAttribute("delay")),(null!=f[a].getAttribute("speed")||void 0!=f[a].getAttribute("speed"))&&(o=f[a].getAttribute("speed")),-1!==m?d?h.append(new TweenLite(g,o,{alpha:b,delay:j,x:c,y:i,scaleX:k,scaleY:l})):h.append(new TweenLite(g,o,{alpha:b,delay:j,x:c,y:i,width:m,height:n})):h.append(new TweenLite(g,o,{alpha:b,delay:j,x:c,y:i})),a<f.length-1&&e(a+1)}var f,g,h;f=a,g=b,h=c,e(0)},Helpers.popup=function(){this.width=909,this.height=462,this.x=-1,this.y=-1,this["class"]="feedbackpopup",this.closebtn=!0,this.html="<div></div>",this.name="name",this.sound=!1,this.soundName,this.owner,this.autoX=function(){var a=$("#holder").width(),b=$("#holder").height();this.x=a/2-this.width/2,this.y=b/2-this.height/2},this.setClass=function(a){this["class"]=a},this.setX=function(a){this.x=a},this.setY=function(a){this.y=a},this.setWidth=function(a){this.width=a},this.setHeight=function(a){this.height=a},this.setName=function(a){this.name=a},this.setClosebtn=function(a){this.closebtn=a},this.setOwnerObject=function(a){this.owner=a},this.includeSound=function(a){this.sound=a},this.addToStage=function(a){this.html='<div id="'+this.name+'" class="'+this["class"]+'"></div>',$(a).append(this.html);var b="#"+this.name;$(b).css({width:this.width+"px",height:this.height+"px","z-index":2e3}),this.x<0&&this.autoX(a);var c=new TimelineLite;if(c.set(b,{position:"absolute",left:this.x,top:this.y-10,opacity:0}),c.append(TweenLite.to(b,.5,{left:this.x,top:this.y,opacity:1})),this.closebtn){var d=this.name+"-boxclose";Helpers.addCloseBtn($("#"+this.name),this.width,d,this)}},this.addText=function(a){$("#"+this.name).prepend('<p id="'+this.name+'_text">'+a+"</p>"),TweenLite.set($("#"+this.name+"_text"),{position:"absolute",x:10,y:10,width:this.width-10})},this.removeFromStage=function(){$("#"+this.name).remove(),this.sound&&Global.soundController.stopSound()}},Helpers.listBox=function(){var a,b,c=25,d=100,e="#7A719F",f="#7A719F",g="#FF9E51",h="#858585",i="#D47272",j="#2D8019";this.setWidth=function(a){c=a},this.setHeight=function(a){d=a},this.setColour=function(a){f=a},this.setTextColour=function(a){e=a},this.setId=function(b){a=b},this.setOverColour=function(a){g=a},this.setSelectColour=function(a){h=a},this.setState=function(c){switch(b=c){case"active":$("#"+a).css({cursor:"pointer",opacity:"1",backgroundColor:f}).mouseenter(function(){$(this).css("background",g)}).mouseleave(function(){$(this).css("background",f)});break;case"over":$("#"+a).css({cursor:"pointer",opacity:"1",backgroundColor:g}).mouseenter(function(){$(this).css("background",f)}).mouseleave(function(){$(this).css("background",g)});break;case"selected":$("#"+a).css({cursor:"pointer",opacity:"1",backgroundColor:h}).mouseenter(function(){$(this).css("background",g)}).mouseleave(function(){$(this).css("background",h)});break;case"correct":$("#"+a).css({cursor:"pointer",opacity:"1",backgroundColor:j}).mouseenter(function(){$(this).css("background",g)}).mouseleave(function(){$(this).css("background",j)});break;case"incorrect":$("#"+a).css({cursor:"pointer",opacity:"1",backgroundColor:i}).mouseenter(function(){$(this).css("background",g)}).mouseleave(function(){$(this).css("background",i)})}},this.removeInteraction=function(){$("#"+a).off(),$("#"+a).css({cursor:"auto"})},this.drawBox=function(b){$(b).append('<div class="listbox-outer" id='+a+"><div id="+a+'-inner class="listbox-gradient"></div></div>'),TweenLite.set($("#"+a),{width:c,height:d,display:"block",color:e,backgroundColor:f}),TweenLite.set($("#"+a+"-inner"),{width:c-2,x:1,y:1})}},Helpers.iconBox=function(){var a,b,c,d,e=245,f=100,g="#B8B4CB",h="#FF9E51",i="#ADADAD",j="#D47272",k="#56AF68",l=!1;this.setWidth=function(a){e=a},this.setHeight=function(a){f=a},this.seticonColour=function(a){g=a},this.iconOverColour=function(a){h=a},this.iconSelectColour=function(a){i=a},this.setId=function(b){a=b},this.getId=function(){return a},this.getState=function(){return b},this.setCorrect=function(b){b?TweenLite.set($("#"+a+"-inner"),{backgroundImage:'url("../common/images/complete.png")',backgroundRepeat:"no-repeat",backgroundPosition:"right center",backgroundSize:"10%, 10%"}):TweenLite.set($("#"+a+"-inner"),{backgroundImage:'url("../common/images/cross.png")',backgroundRepeat:"no-repeat",backgroundPosition:"right center",backgroundSize:"10%, 10%"})},this.setState=function(c){switch(b=c){case"active":$("#"+a).css({cursor:"pointer",opacity:"1"}).mouseenter(function(){$("#"+a+"-inner").css("background",h)}).mouseleave(function(){$("#"+a+"-inner").css("background",g)}),$("#"+a+"-inner").css({backgroundColor:g});break;case"over":$("#"+a).css({cursor:"pointer",opacity:"1"}).mouseenter(function(){$("#"+a+"-inner").css("background",g)}).mouseleave(function(){$("#"+a+"-inner").css("background",h)}),$("#"+a+"-inner").css({backgroundColor:h});break;case"correct":$("#"+a).css({cursor:"pointer",opacity:"1"}).mouseenter(function(){$("#"+a+"-inner").css("background",h)}).mouseleave(function(){$("#"+a+"-inner").css("background",k)}),$("#"+a+"-inner").css({backgroundColor:k});break;case"selected":$("#"+a).css({cursor:"pointer",opacity:"1"}).mouseenter(function(){$("#"+a+"-inner").css("background",h)}).mouseleave(function(){$("#"+a+"-inner").css("background",i)}),$("#"+a+"-inner").css({backgroundColor:i});break;case"incorrect":$("#"+a).css({cursor:"pointer",opacity:"1"}).mouseenter(function(){$("#"+a+"-inner").css("background",h)}).mouseleave(function(){$("#"+a+"-inner").css("background",j)}),$("#"+a+"-inner").css({backgroundColor:j})}},this.removeInteraction=function(){$("#"+a).off(),$("#"+a).css({cursor:"default"})},this.addClass=function(b){l?$("#"+a).addClass(b):d?d+=" "+b:d=b},this.drawIcon=function(b){c=b,$(c).append('<div class="iconbox-outer" id='+a+"><div id="+a+'-inner class="iconbox-inner"></div><div id='+a+'-gradient class="iconbox-gradient"></div>'),d&&$("#"+a).addClass(d),TweenLite.set($("#"+a),{width:e,height:f,display:"block"}),TweenLite.set($("#"+a+"-inner"),{backgroundColor:g,height:f-2,width:e-2,top:1,left:1,display:"block"}),TweenLite.set($("#"+a+"-gradient"),{width:e-2,height:f/2,x:1,y:1}),l=!0},this.removeBg=function(b,c,d,g){var h=c?c:.2,i=d?d:e,j=g?g:f;TweenLite.to($("#"+a),h,{backgroundColor:"transparent",borderColor:"transparent"}),TweenLite.to($("#"+a+"-inner"),h,{backgroundColor:"transparent",width:i,height:j}),$("#"+a+"-gradient").prependTo("#"+a),TweenLite.to($("#"+a+"-gradient"),h,{className:"iconbox-gradiens-whiter",height:"100%",width:"100%"})},this.addrighthtml=function(b,c){$("#"+a).append(b);var d=$("#"+c).width(),g=$("#"+c).height();TweenLite.set($("#"+c),{position:"absolute",x:e-d/2,y:f/2-g/2-10,opacity:0}),TweenLite.to($("#"+c),.3,{y:f/2-g/2,opacity:1})}},Helpers.addCloseBtn=function(a,b,c,d){$(a).append('<a id="'+c+'" class="boxclose"></a>'),TweenLite.set($("#"+c),{x:b-36,y:5}),$("#"+c).on("click",function(b){$(a).remove(),Global.soundController.stopSound(),d.owner&&d.owner.popupClosed(d.name)})},Helpers.convertColour=function(a){var b=a.replace(/^0x+/,"#");return b},Helpers.shuffleArray=function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},Helpers.isInArray=function(a,b){"use strict";for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return!0;return!1},Helpers.Button=function(a){var b,c,d=160,e=30,f="#673E90",g="#27bcf2",h="#CC6600",i="#FFFFCC",j=a,k=14,l="#ffffff";this.setWidth=function(a){d=a},this.setHeight=function(a){e=a},this.setButtonColour=function(a){f=Helpers.convertColour(a)},this.setRollOverColour=function(a){g=Helpers.convertColour(a)},this.setSelectColour=function(a){h=Helpers.convertColour(a)},this.setState4Colour=function(a){i=a},this.setFontColour=function(a){l=Helpers.convertColour(a)},this.setFontSize=function(a){k=a},this.setText=function(a){j=a,$("#"+c+" p").contents().replaceWith(j)},this.setId=function(a){c=a},this.getId=function(a){return c},this.setState=function(a){switch(b=a){case"active":$("#"+c).css({cursor:"pointer",opacity:"1",backgroundColor:f}).mouseenter(function(){$(this).css("background",g)}).mouseleave(function(){$(this).css("background",f)});break;case"inactive":$("#"+c).css({cursor:"not-allowed",opacity:"0.4",backgroundColor:i}).off("mouseenter").off("mouseleave")}},this.getState=function(){return b},this.drawButton=function(a){$(a).append('<div id="'+c+'" class="activity-btn"><p>'+j+"</p></div>"),TweenLite.set($("#"+c),{color:l,width:d,height:e,backgroundColor:f,cursor:"pointer"});var b=($("#"+c).height(),$("#"+c+" p").height()),g=e/2-b/2;TweenLite.set($("#"+c+" p"),{y:g})},this.removeFromStage=function(){$("#"+c).remove()}},Helpers.buttonImage=function(a){"use strict";var b,c,d,e,f,g,h,i,j;this.setState1Image=function(a){b=a,c=a,d=a,e=a},this.setState2Image=function(a){c=a},this.setState3Image=function(a){d=a},this.setState4Image=function(a){e=a},this.setId=function(a){g=a},this.setCorrect=function(a){i=a},this.getCorrect=function(){return i},this.setSelected=function(a){j=a},this.getSelected=function(a){return j},this.getButton=function(){return h},this.getId=function(){return g},this.setState=function(a,i){switch(f=a){case"active":j=!1,$(h).off("mouseenter").off("mouseleave").off("touchleave").off("mouseup").contents().replaceWith(b),$(h).on("mouseleave mouseup",function(){$(this).contents().replaceWith(b)}).on("mouseenter",function(){$(this).contents().replaceWith(c)}).css({cursor:"pointer",opacity:"1"});break;case"inactive":$("#"+g).css({cursor:"not-allowed",opacity:"0.4"}).off("mouseenter").off("mouseleave");break;case"selected":j=!0,$(h).off("mouseenter").off("mouseleave").contents().replaceWith(d),$(h).mouseleave(function(){$(this).contents().replaceWith(d),$(this).mouseenter(function(){$(this).contents().replaceWith(c)})});break;case"done":$(h).off("mouseenter").off("mouseleave").contents().replaceWith(e)}},this.setBg=function(a){switch(a){case 1:$(h).contents().replaceWith(b);break;case 2:$(h).contents().replaceWith(c);break;case 3:$(h).contents().replaceWith(d);break;case 4:$(h).contents().replaceWith(e)}},this.getState=function(){return f},this.drawButton=function(a){$(a).append('<a id="'+g+'" class="image-btn"></a>'),h=$("#"+g).append(b)},this.removeInteraction=function(){$("#"+g).off(),$("#"+g).css({cursor:"default"})}},Helpers.findImage=function(a,b){"use strict";for(var c=0,d=b.length;d>c;c++)if(b[c].id===a)return b[c].pic;return!1},Helpers.imageExists=function(a,b){"use strict";for(var c=0,d=b.length;d>c;c++)if(b[c].id===a)return!0;return!1},Helpers.addImage=function(a,b,c){"use strict";for(var d=0,e=b.length;e>d;d++)if(b[d].id===a)return $(c).append(b[d].pic),$(b[d].pic).css({position:"absolute"}),b[d]},Helpers.verticalAlignImage=function(a,b){"use strict";return b.height()/2-a.height/2},Helpers.horizontalAlignImage=function(a,b){"use strict";return b.width()/2-a.width/2},Helpers.horizontalCentreWidth=function(a,b){"use strict";return b.width()-2*a},Helpers.verticalAlignText=function(a,b){"use strict";return b.height()/2-a.height()/2},Helpers.uniqueArray=function(a){"use strict";return a.sort().filter(function(a,b,c){return!b||a!=c[b-1]})},Helpers.getPosition=function(a,b,c){"use strict";var d=a.offset(),e=$(c).offset();return{x:d.left-e.left+b.left,y:d.top-e.top+b.top}},Helpers.modifyRect=function(a){var b=a;return createjs.BrowserDetect.isChrome||(b.height=b.height*(1/Global.model.zoom),b.width=b.width*(1/Global.model.zoom)),b},!function(a,b,c){"use strict";function d(b,p,q){function K(c){var d=0,e=Ga.length;if(ya.old=a.extend({},ya),wa=ta?0:ua[ra.horizontal?"width":"height"](),Ba=za[ra.horizontal?"width":"height"](),xa=ta?b:va[ra.horizontal?"outerWidth":"outerHeight"](),Ga.length=0,ya.start=0,ya.end=H(xa-wa,0),Ra){d=Ia.length,Ha=va.children(ra.itemSelector),Ia.length=0;var f,g=j(va,ra.horizontal?"paddingLeft":"paddingTop"),h=j(va,ra.horizontal?"paddingRight":"paddingBottom"),i="border-box"===a(Ha).css("boxSizing"),l="none"!==Ha.css("float"),m=0,n=Ha.length-1;xa=0,Ha.each(function(b,c){var d=a(c),e=Helpers.modifyRect(c.getBoundingClientRect()),i=G(ra.horizontal?e.width||e.right-e.left:e.height||e.bottom-e.top),k=j(d,ra.horizontal?"marginLeft":"marginTop"),o=j(d,ra.horizontal?"marginRight":"marginBottom"),p=i+k+o,q=!k||!o,r={};r.el=c,r.size=q?i:p,r.half=r.size/2,r.start=xa+(q?k:0),r.center=r.start-G(wa/2-r.size/2),r.end=r.start-wa+r.size,b||(xa+=g),xa+=p,ra.horizontal||l||o&&k&&b>0&&(xa-=I(k,o)),b===n&&(r.end+=h,xa+=h,m=q?o:0),Ia.push(r),f=r}),va[0].style[ra.horizontal?"width":"height"]=(i?xa:xa-g-h)+"px",xa-=m,Ia.length?(ya.start=Ia[0][Pa?"center":"start"],ya.end=Pa?f.center:xa>wa?f.end:ya.start):ya.start=ya.end=0}if(ya.center=G(ya.end/2+ya.start/2),V(),Aa.length&&Ba>0&&(ra.dynamicHandle?(Ca=ya.start===ya.end?Ba:G(Ba*wa/xa),Ca=k(Ca,ra.minHandleSize,Ba),Aa[0].style[ra.horizontal?"width":"height"]=Ca+"px"):Ca=Aa[ra.horizontal?"outerWidth":"outerHeight"](),Da.end=Ba-Ca,eb||N()),!ta&&wa>0){var o=ya.start,p="";if(Ra)a.each(Ia,function(a,b){Pa?Ga.push(b.center):b.start+b.size>o&&o<=ya.end&&(o=b.start,Ga.push(o),o+=wa,o>ya.end&&o<ya.end+wa&&Ga.push(ya.end))});else for(;o-wa<ya.end;)Ga.push(o),o+=wa;if(Ea[0]&&e!==Ga.length){for(var q=0;q<Ga.length;q++)p+=ra.pageBuilder.call(sa,q);Fa=Ea.html(p).children(),Fa.eq(Ja.activePage).addClass(ra.activeClass)}}if(Ja.slideeSize=xa,Ja.frameSize=wa,Ja.sbSize=Ba,Ja.handleSize=Ca,Ra){c&&null!=ra.startAt&&(T(ra.startAt),sa[Qa?"toCenter":"toStart"](ra.startAt));var r=Ia[Ja.activeItem];L(Qa&&r?r.center:k(ya.dest,ya.start,ya.end))}else c?null!=ra.startAt&&L(ra.startAt,1):L(k(ya.dest,ya.start,ya.end));oa("load")}function L(a,b,c){if(Ra&&cb.released&&!c){var d=U(a),e=a>ya.start&&a<ya.end;Qa?(e&&(a=Ia[d.centerItem].center),Pa&&ra.activateMiddle&&T(d.centerItem)):e&&(a=Ia[d.firstItem].start)}cb.init&&cb.slidee&&ra.elasticBounds?a>ya.end?a=ya.end+(a-ya.end)/6:a<ya.start&&(a=ya.start+(a-ya.start)/6):a=k(a,ya.start,ya.end),ab.start=+new Date,ab.time=0,ab.from=ya.cur,ab.to=a,ab.delta=a-ya.cur,ab.tweesing=cb.tweese||cb.init&&!cb.slidee,ab.immediate=!ab.tweesing&&(b||cb.init&&cb.slidee||!ra.speed),cb.tweese=0,a!==ya.dest&&(ya.dest=a,oa("change"),eb||M()),Z(),V(),W(),O()}function M(){if(sa.initialized){if(!eb)return eb=t(M),void(cb.released&&oa("moveStart"));ab.immediate?ya.cur=ab.to:ab.tweesing?(ab.tweeseDelta=ab.to-ya.cur,D(ab.tweeseDelta)<.1?ya.cur=ab.to:ya.cur+=ab.tweeseDelta*(cb.released?ra.swingSpeed:ra.syncSpeed)):(ab.time=I(+new Date-ab.start,ra.speed),ya.cur=ab.from+ab.delta*a.easing[ra.easing](ab.time/ra.speed,ab.time,0,1,ra.speed)),ab.to===ya.cur?(ya.cur=ab.to,cb.tweese=eb=0):eb=t(M),oa("move"),ta||(m?va[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+-ya.cur+"px)":va[0].style[ra.horizontal?"left":"top"]=-G(ya.cur)+"px"),!eb&&cb.released&&oa("moveEnd"),N()}}function N(){Aa.length&&(Da.cur=ya.start===ya.end?0:((cb.init&&!cb.slidee?ya.dest:ya.cur)-ya.start)/(ya.end-ya.start)*Da.end,Da.cur=k(G(Da.cur),Da.start,Da.end),_a.hPos!==Da.cur&&(_a.hPos=Da.cur,m?Aa[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+Da.cur+"px)":Aa[0].style[ra.horizontal?"left":"top"]=Da.cur+"px"))}function O(){Fa[0]&&_a.page!==Ja.activePage&&(_a.page=Ja.activePage,Fa.removeClass(ra.activeClass).eq(Ja.activePage).addClass(ra.activeClass),oa("activePage",_a.page))}function P(){bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)||sa.stop(),hb=cb.init?t(P):0,bb.now=+new Date,bb.pos=ya.cur+(bb.now-bb.lastTime)/1e3*bb.speed,L(cb.init?bb.pos:G(bb.pos)),cb.init||ya.cur!==ya.dest||oa("moveEnd"),bb.lastTime=bb.now}function Q(a,b,d){if("boolean"===e(b)&&(d=b,b=c),b===c)L(ya[a],d);else{if(Qa&&"center"!==a)return;var f=sa.getPos(b);f&&L(f[a],d,!Qa)}}function R(a){return null!=a?i(a)?a>=0&&a<Ia.length?a:-1:Ha.index(a):-1}function S(a){return R(i(a)&&0>a?a+Ia.length:a)}function T(a,b){var c=R(a);return!Ra||0>c?!1:((_a.active!==c||b)&&(Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ha.eq(c).addClass(ra.activeClass),_a.active=Ja.activeItem=c,W(),oa("active",c)),c)}function U(a){a=k(i(a)?a:ya.dest,ya.start,ya.end);var b={},c=Pa?0:wa/2;if(!ta)for(var d=0,e=Ga.length;e>d;d++){if(a>=ya.end||d===Ga.length-1){b.activePage=Ga.length-1;break}if(a<=Ga[d]+c){b.activePage=d;break}}if(Ra){for(var f=!1,g=!1,h=!1,j=0,l=Ia.length;l>j;j++)if(f===!1&&a<=Ia[j].start+Ia[j].half&&(f=j),h===!1&&a<=Ia[j].center+Ia[j].half&&(h=j),j===l-1||a<=Ia[j].end+Ia[j].half){g=j;break}b.firstItem=i(f)?f:0,b.centerItem=i(h)?h:b.firstItem,b.lastItem=i(g)?g:b.centerItem}return b}function V(b){a.extend(Ja,U(b))}function W(){var a=ya.dest<=ya.start,b=ya.dest>=ya.end,c=(a?1:0)|(b?2:0);if(_a.slideePosState!==c&&(_a.slideePosState=c,Ya.is("button,input")&&Ya.prop("disabled",a),Za.is("button,input")&&Za.prop("disabled",b),Ya.add(Va)[a?"addClass":"removeClass"](ra.disabledClass),Za.add(Ua)[b?"addClass":"removeClass"](ra.disabledClass)),_a.fwdbwdState!==c&&cb.released&&(_a.fwdbwdState=c,Va.is("button,input")&&Va.prop("disabled",a),Ua.is("button,input")&&Ua.prop("disabled",b)),Ra&&null!=Ja.activeItem){var d=0===Ja.activeItem,e=Ja.activeItem>=Ia.length-1,f=(d?1:0)|(e?2:0);_a.itemsButtonState!==f&&(_a.itemsButtonState=f,Wa.is("button,input")&&Wa.prop("disabled",d),Xa.is("button,input")&&Xa.prop("disabled",e),Wa[d?"addClass":"removeClass"](ra.disabledClass),Xa[e?"addClass":"removeClass"](ra.disabledClass))}}function X(a,b,c){if(a=S(a),b=S(b),a>-1&&b>-1&&a!==b&&(!c||b!==a-1)&&(c||b!==a+1)){Ha.eq(a)[c?"insertAfter":"insertBefore"](Ia[b].el);var d=b>a?a:c?b:b-1,e=a>b?a:c?b+1:b,f=a>b;null!=Ja.activeItem&&(a===Ja.activeItem?_a.active=Ja.activeItem=c?f?b+1:b:f?b:b-1:Ja.activeItem>d&&Ja.activeItem<e&&(_a.active=Ja.activeItem+=f?1:-1)),K()}}function Y(a,b){for(var c=0,d=$a[a].length;d>c;c++)if($a[a][c]===b)return c;return-1}function Z(){cb.released&&!sa.isPaused&&sa.resume()}function $(a){return G(k(a,Da.start,Da.end)/Da.end*(ya.end-ya.start))+ya.start}function _(){cb.history[0]=cb.history[1],cb.history[1]=cb.history[2],cb.history[2]=cb.history[3],cb.history[3]=cb.delta}function aa(a){cb.released=0,cb.source=a,cb.slidee="slidee"===a}function ba(b){var c="touchstart"===b.type,d=b.data.source,e="slidee"===d;cb.init||!c&&ea(b.target)||("handle"!==d||ra.dragHandle&&Da.start!==Da.end)&&(!e||(c?ra.touchDragging:ra.mouseDragging&&b.which<2))&&(c||f(b),aa(d),cb.init=0,cb.$source=a(b.target),cb.touch=c,cb.pointer=c?b.originalEvent.touches[0]:b,cb.initX=cb.pointer.pageX,cb.initY=cb.pointer.pageY,cb.initPos=e?ya.cur:Da.cur,cb.start=+new Date,cb.time=0,cb.path=0,cb.delta=0,cb.locked=0,cb.history=[0,0,0,0],cb.pathToLock=e?c?30:10:0,u.on(c?x:w,ca),sa.pause(1),(e?va:Aa).addClass(ra.draggedClass),oa("moveStart"),e&&(fb=setInterval(_,10)))}function ca(a){if(cb.released="mouseup"===a.type||"touchend"===a.type,cb.pointer=cb.touch?a.originalEvent[cb.released?"changedTouches":"touches"][0]:a,cb.pathX=cb.pointer.pageX-cb.initX,cb.pathY=cb.pointer.pageY-cb.initY,cb.path=E(F(cb.pathX,2)+F(cb.pathY,2)),cb.delta=ra.horizontal?cb.pathX:cb.pathY,cb.released||!(cb.path<1)){if(!cb.init){if(!(ra.horizontal?D(cb.pathX)>D(cb.pathY):D(cb.pathX)<D(cb.pathY)))return da();cb.init=1}f(a),!cb.locked&&cb.path>cb.pathToLock&&cb.slidee&&(cb.locked=1,cb.$source.on(z,g)),cb.released&&(da(),ra.releaseSwing&&cb.slidee&&(cb.swing=(cb.delta-cb.history[0])/40*300,cb.delta+=cb.swing,cb.tweese=D(cb.swing)>10)),L(cb.slidee?G(cb.initPos-cb.delta):$(cb.initPos+cb.delta))}}function da(){clearInterval(fb),cb.released=!0,u.off(cb.touch?x:w,ca),(cb.slidee?va:Aa).removeClass(ra.draggedClass),setTimeout(function(){cb.$source.off(z,g)}),ya.cur===ya.dest&&cb.init&&oa("moveEnd"),sa.resume(1),cb.init=0}function ea(b){return~a.inArray(b.nodeName,B)||a(b).is(ra.interactive)}function fa(){sa.stop(),u.off("mouseup",fa)}function ga(a){switch(f(a),this){case Ua[0]:case Va[0]:sa.moveBy(Ua.is(this)?ra.moveBy:-ra.moveBy),u.on("mouseup",fa);break;case Wa[0]:sa.prev();break;case Xa[0]:sa.next();break;case Ya[0]:sa.prevPage();break;case Za[0]:sa.nextPage()}}function ha(a){return db.curDelta=(ra.horizontal?a.deltaY||a.deltaX:a.deltaY)||-a.wheelDelta,db.curDelta/=1===a.deltaMode?3:100,Ra?(o=+new Date,db.last<o-db.resetTime&&(db.delta=0),db.last=o,db.delta+=db.curDelta,D(db.delta)<1?db.finalDelta=0:(db.finalDelta=G(db.delta/1),db.delta%=1),db.finalDelta):db.curDelta}function ia(a){a.originalEvent[r]=sa;var b=+new Date;if(J+ra.scrollHijack>b&&Sa[0]!==document&&Sa[0]!==window)return void(J=b);if(ra.scrollBy&&ya.start!==ya.end){var c=ha(a.originalEvent);(ra.scrollTrap||c>0&&ya.dest<ya.end||0>c&&ya.dest>ya.start)&&f(a,1),sa.slideBy(ra.scrollBy*c)}}function ja(a){ra.clickBar&&a.target===za[0]&&(f(a),L($((ra.horizontal?a.pageX-za.offset().left:a.pageY-za.offset().top)-Ca/2)))}function ka(a){if(ra.keyboardNavBy)switch(a.which){case ra.horizontal?37:38:f(a),sa["pages"===ra.keyboardNavBy?"prevPage":"prev"]();break;case ra.horizontal?39:40:f(a),sa["pages"===ra.keyboardNavBy?"nextPage":"next"]()}}function la(a){return ea(this)?void(a.originalEvent[r+"ignore"]=!0):void(this.parentNode!==va[0]||a.originalEvent[r+"ignore"]||sa.activate(this))}function ma(){this.parentNode===Ea[0]&&sa.activatePage(Fa.index(this))}function na(a){ra.pauseOnHover&&sa["mouseenter"===a.type?"pause":"resume"](2)}function oa(a,b){if($a[a]){for(qa=$a[a].length,C.length=0,pa=0;qa>pa;pa++)C.push($a[a][pa]);for(pa=0;qa>pa;pa++)C[pa].call(sa,a,b)}}var pa,qa,ra=a.extend({},d.defaults,p),sa=this,ta=i(b),ua=a(b),va=ra.slidee?a(ra.slidee).eq(0):ua.children().eq(0),wa=0,xa=0,ya={start:0,center:0,end:0,cur:0,dest:0},za=a(ra.scrollBar).eq(0),Aa=za.children().eq(0),Ba=0,Ca=0,Da={start:0,end:0,cur:0},Ea=a(ra.pagesBar),Fa=0,Ga=[],Ha=0,Ia=[],Ja={firstItem:0,lastItem:0,centerItem:0,activeItem:null,activePage:0},Ka=new l(ua[0]),La=new l(va[0]),Ma=new l(za[0]),Na=new l(Aa[0]),Oa="basic"===ra.itemNav,Pa="forceCentered"===ra.itemNav,Qa="centered"===ra.itemNav||Pa,Ra=!ta&&(Oa||Qa||Pa),Sa=ra.scrollSource?a(ra.scrollSource):ua,Ta=ra.dragSource?a(ra.dragSource):ua,Ua=a(ra.forward),Va=a(ra.backward),Wa=a(ra.prev),Xa=a(ra.next),Ya=a(ra.prevPage),Za=a(ra.nextPage),$a={},_a={},ab={},bb={},cb={released:1},db={last:0,delta:0,resetTime:200},eb=0,fb=0,gb=0,hb=0;ta||(b=ua[0]),sa.initialized=0,sa.frame=b,sa.slidee=va[0],sa.pos=ya,sa.rel=Ja,sa.items=Ia,sa.pages=Ga,sa.isPaused=0,sa.options=ra,sa.dragging=cb,sa.reload=function(){K()},sa.getPos=function(a){if(Ra){var b=R(a);return-1!==b?Ia[b]:!1}var c=va.find(a).eq(0);if(c[0]){var d=ra.horizontal?c.offset().left-va.offset().left:c.offset().top-va.offset().top,e=c[ra.horizontal?"outerWidth":"outerHeight"]();return{start:d,center:d-wa/2+e/2,end:d-wa+e,size:e}}return!1},sa.moveBy=function(a){bb.speed=a,!cb.init&&bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)&&(bb.lastTime=+new Date,bb.startPos=ya.cur,aa("button"),cb.init=1,oa("moveStart"),s(hb),P())},sa.stop=function(){"button"===cb.source&&(cb.init=0,cb.released=1)},sa.prev=function(){sa.activate(null==Ja.activeItem?0:Ja.activeItem-1)},sa.next=function(){sa.activate(null==Ja.activeItem?0:Ja.activeItem+1)},sa.prevPage=function(){sa.activatePage(Ja.activePage-1)},sa.nextPage=function(){sa.activatePage(Ja.activePage+1)},sa.slideBy=function(a,b){a&&(Ra?sa[Qa?"toCenter":"toStart"](k((Qa?Ja.centerItem:Ja.firstItem)+ra.scrollBy*a,0,Ia.length)):L(ya.dest+a,b))},sa.slideTo=function(a,b){L(a,b)},sa.toStart=function(a,b){Q("start",a,b)},sa.toEnd=function(a,b){Q("end",a,b)},sa.toCenter=function(a,b){Q("center",a,b)},sa.getIndex=R,sa.activate=function(a,b){var c=T(a);ra.smart&&c!==!1&&(Qa?sa.toCenter(c,b):c>=Ja.lastItem?sa.toStart(c,b):c<=Ja.firstItem?sa.toEnd(c,b):Z())},sa.activatePage=function(a,b){i(a)&&L(Ga[k(a,0,Ga.length-1)],b)},sa.resume=function(a){ra.cycleBy&&ra.cycleInterval&&("items"!==ra.cycleBy||Ia[0]&&null!=Ja.activeItem)&&!(a<sa.isPaused)&&(sa.isPaused=0,gb?gb=clearTimeout(gb):oa("resume"),gb=setTimeout(function(){switch(oa("cycle"),ra.cycleBy){case"items":sa.activate(Ja.activeItem>=Ia.length-1?0:Ja.activeItem+1);break;case"pages":sa.activatePage(Ja.activePage>=Ga.length-1?0:Ja.activePage+1)}},ra.cycleInterval))},sa.pause=function(a){a<sa.isPaused||(sa.isPaused=a||100,gb&&(gb=clearTimeout(gb),oa("pause")))},sa.toggle=function(){sa[gb?"pause":"resume"]()},sa.set=function(b,c){a.isPlainObject(b)?a.extend(ra,b):ra.hasOwnProperty(b)&&(ra[b]=c)},sa.add=function(b,c){var d=a(b);Ra?(null==c||!Ia[0]||c>=Ia.length?d.appendTo(va):Ia.length&&d.insertBefore(Ia[c].el),null!=Ja.activeItem&&c<=Ja.activeItem&&(_a.active=Ja.activeItem+=d.length)):va.append(d),K()},sa.remove=function(b){if(Ra){var c=S(b);if(c>-1){Ha.eq(c).remove();var d=c===Ja.activeItem;null!=Ja.activeItem&&c<Ja.activeItem&&(_a.active=--Ja.activeItem),K(),d&&(_a.active=null,sa.activate(Ja.activeItem))}}else a(b).remove(),K()},sa.moveAfter=function(a,b){X(a,b,1)},sa.moveBefore=function(a,b){X(a,b)},sa.on=function(a,b){if("object"===e(a))for(var c in a)a.hasOwnProperty(c)&&sa.on(c,a[c]);else if("function"===e(b))for(var d=a.split(" "),f=0,g=d.length;g>f;f++)$a[d[f]]=$a[d[f]]||[],-1===Y(d[f],b)&&$a[d[f]].push(b);else if("array"===e(b))for(var h=0,i=b.length;i>h;h++)sa.on(a,b[h])},sa.one=function(a,b){function c(){b.apply(sa,arguments),sa.off(a,c)}sa.on(a,c)},sa.off=function(a,b){if(b instanceof Array)for(var c=0,d=b.length;d>c;c++)sa.off(a,b[c]);else for(var e=a.split(" "),f=0,g=e.length;g>f;f++)if($a[e[f]]=$a[e[f]]||[],null==b)$a[e[f]].length=0;else{var h=Y(e[f],b);-1!==h&&$a[e[f]].splice(h,1)}},sa.destroy=function(){return Sa.add(Aa).add(za).add(Ea).add(Ua).add(Va).add(Wa).add(Xa).add(Ya).add(Za).off("."+r),u.off("keydown",ka),Wa.add(Xa).add(Ya).add(Za).removeClass(ra.disabledClass),Ha&&null!=Ja.activeItem&&Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ea.empty(),ta||(ua.off("."+r),Ka.restore(),La.restore(),Ma.restore(),Na.restore(),a.removeData(b,r)),Ia.length=Ga.length=0,_a={},sa.initialized=0,sa},sa.init=function(){if(!sa.initialized){sa.on(q);var a=["overflow","position"],b=["position","webkitTransform","msTransform","transform","left","top","width","height"];Ka.save.apply(Ka,a),Ma.save.apply(Ma,a),La.save.apply(La,b),Na.save.apply(Na,b);var c=Aa;return ta||(c=c.add(va),ua.css("overflow","hidden"),m||"static"!==ua.css("position")||ua.css("position","relative")),m?n&&c.css(m,n):("static"===za.css("position")&&za.css("position","relative"),c.css({position:"absolute"})),ra.forward&&Ua.on(A,ga),ra.backward&&Va.on(A,ga),ra.prev&&Wa.on(z,ga),ra.next&&Xa.on(z,ga),ra.prevPage&&Ya.on(z,ga),ra.nextPage&&Za.on(z,ga),Sa.on(y,ia),za[0]&&za.on(z,ja),Ra&&ra.activateOn&&ua.on(ra.activateOn+"."+r,"*",la),Ea[0]&&ra.activatePageOn&&Ea.on(ra.activatePageOn+"."+r,"*",ma),Ta.on(v,{source:"slidee"},ba),Aa&&Aa.on(v,{source:"handle"},ba),u.on("keydown",ka),ta||(ua.on("mouseenter."+r+" mouseleave."+r,na),ua.on("scroll."+r,h)),sa.initialized=1,K(!0),ra.cycleBy&&!ta&&sa[ra.startPaused?"pause":"resume"](),sa}}}function e(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof a}function f(a,b){a.preventDefault(),b&&a.stopPropagation()}function g(b){f(b,1),a(this).off(b.type,g)}function h(){this.scrollLeft=0,this.scrollTop=0}function i(a){return!isNaN(parseFloat(a))&&isFinite(a)}function j(a,b){return 0|G(String(a.css(b)).replace(/[^\-0-9.]/g,""))}function k(a,b,c){return b>a?b:a>c?c:a}function l(a){var b={};return b.style={},b.save=function(){if(a&&a.nodeType){for(var c=0;c<arguments.length;c++)b.style[arguments[c]]=a.style[arguments[c]];return b}},b.restore=function(){if(a&&a.nodeType){for(var c in b.style)b.style.hasOwnProperty(c)&&(a.style[c]=b.style[c]);return b}},b}var m,n,o,p="sly",q="Sly",r=p,s=b.cancelAnimationFrame||b.cancelRequestAnimationFrame,t=b.requestAnimationFrame,u=a(document),v="touchstart."+r+" mousedown."+r,w="mousemove."+r+" mouseup."+r,x="touchmove."+r+" touchend."+r,y=(document.implementation.hasFeature("Event.wheel","3.0")?"wheel.":"mousewheel.")+r,z="click."+r,A="mousedown."+r,B=["INPUT","SELECT","BUTTON","TEXTAREA"],C=[],D=Math.abs,E=Math.sqrt,F=Math.pow,G=Math.round,H=Math.max,I=Math.min,J=0;u.on(y,function(a){var b=a.originalEvent[r],c=+new Date;(!b||b.options.scrollHijack<c-J)&&(J=c)}),function(a){function b(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-c)),e=setTimeout(a,d);return c=b,e}t=a.requestAnimationFrame||a.webkitRequestAnimationFrame||b;var c=(new Date).getTime(),d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.clearTimeout;s=function(b){d.call(a,b)}}(window),function(){function a(a){for(var d=0,e=b.length;e>d;d++){var f=b[d]?b[d]+a.charAt(0).toUpperCase()+a.slice(1):a;if(null!=c.style[f])return f}}var b=["","webkit","moz","ms","o"],c=document.createElement("div");m=a("transform"),n=a("perspective")?"translateZ(0) ":""}(),b[q]=d,a.fn[p]=function(b,c){var f,g;return a.isPlainObject(b)||(("string"===e(b)||b===!1)&&(f=b===!1?"destroy":b,g=Array.prototype.slice.call(arguments,1)),b={}),this.each(function(e,h){var i=a.data(h,r);i||f?i&&f&&i[f]&&i[f].apply(i,g):i=a.data(h,r,new d(h,b,c).init())})},d.defaults={slidee:null,horizontal:!1,itemNav:null,itemSelector:null,smart:!1,activateOn:null,activateMiddle:!1,scrollSource:null,scrollBy:0,scrollHijack:300,scrollTrap:!1,dragSource:null,mouseDragging:!1,touchDragging:!1,releaseSwing:!1,swingSpeed:.2,elasticBounds:!1,interactive:null,scrollBar:null,dragHandle:!1,dynamicHandle:!1,minHandleSize:50,clickBar:!1,syncSpeed:.5,pagesBar:null,activatePageOn:null,pageBuilder:function(a){return"<li>"+(a+1)+"</li>"},forward:null,backward:null,prev:null,next:null,prevPage:null,nextPage:null,cycleBy:null,cycleInterval:5e3,pauseOnHover:!1,startPaused:!1,moveBy:300,speed:0,easing:"swing",startAt:null,keyboardNavBy:null,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}}(jQuery,window),function(a,b,c){"use strict";function d(b,p,q){function K(c){var d=0,e=Ga.length;if(ya.old=a.extend({},ya),wa=ta?0:ua[ra.horizontal?"width":"height"](),Ba=za[ra.horizontal?"width":"height"](),xa=ta?b:va[ra.horizontal?"outerWidth":"outerHeight"](),Ga.length=0,ya.start=0,ya.end=H(xa-wa,0),Ra){d=Ia.length,Ha=va.children(ra.itemSelector),Ia.length=0;var f,g=j(va,ra.horizontal?"paddingLeft":"paddingTop"),h=j(va,ra.horizontal?"paddingRight":"paddingBottom"),i="border-box"===a(Ha).css("boxSizing"),l="none"!==Ha.css("float"),m=0,n=Ha.length-1;xa=0,Ha.each(function(b,c){var d=a(c),e=Helpers.modifyRect(c.getBoundingClientRect()),i=G(ra.horizontal?e.width||e.right-e.left:e.height||e.bottom-e.top),k=j(d,ra.horizontal?"marginLeft":"marginTop"),o=j(d,ra.horizontal?"marginRight":"marginBottom"),p=i+k+o,q=!k||!o,r={};r.el=c,r.size=q?i:p,r.half=r.size/2,r.start=xa+(q?k:0),r.center=r.start-G(wa/2-r.size/2),r.end=r.start-wa+r.size,b||(xa+=g),xa+=p,ra.horizontal||l||o&&k&&b>0&&(xa-=I(k,o)),b===n&&(r.end+=h,xa+=h,m=q?o:0),Ia.push(r),f=r}),va[0].style[ra.horizontal?"width":"height"]=(i?xa:xa-g-h)+"px",xa-=m,Ia.length?(ya.start=Ia[0][Pa?"center":"start"],ya.end=Pa?f.center:xa>wa?f.end:ya.start):ya.start=ya.end=0}if(ya.center=G(ya.end/2+ya.start/2),V(),Aa.length&&Ba>0&&(ra.dynamicHandle?(Ca=ya.start===ya.end?Ba:G(Ba*wa/xa),Ca=k(Ca,ra.minHandleSize,Ba),Aa[0].style[ra.horizontal?"width":"height"]=Ca+"px"):Ca=Aa[ra.horizontal?"outerWidth":"outerHeight"](),
Da.end=Ba-Ca,eb||N()),!ta&&wa>0){var o=ya.start,p="";if(Ra)a.each(Ia,function(a,b){Pa?Ga.push(b.center):b.start+b.size>o&&o<=ya.end&&(o=b.start,Ga.push(o),o+=wa,o>ya.end&&o<ya.end+wa&&Ga.push(ya.end))});else for(;o-wa<ya.end;)Ga.push(o),o+=wa;if(Ea[0]&&e!==Ga.length){for(var q=0;q<Ga.length;q++)p+=ra.pageBuilder.call(sa,q);Fa=Ea.html(p).children(),Fa.eq(Ja.activePage).addClass(ra.activeClass)}}if(Ja.slideeSize=xa,Ja.frameSize=wa,Ja.sbSize=Ba,Ja.handleSize=Ca,Ra){c&&null!=ra.startAt&&(T(ra.startAt),sa[Qa?"toCenter":"toStart"](ra.startAt));var r=Ia[Ja.activeItem];L(Qa&&r?r.center:k(ya.dest,ya.start,ya.end))}else c?null!=ra.startAt&&L(ra.startAt,1):L(k(ya.dest,ya.start,ya.end));oa("load")}function L(a,b,c){if(Ra&&cb.released&&!c){var d=U(a),e=a>ya.start&&a<ya.end;Qa?(e&&(a=Ia[d.centerItem].center),Pa&&ra.activateMiddle&&T(d.centerItem)):e&&(a=Ia[d.firstItem].start)}cb.init&&cb.slidee&&ra.elasticBounds?a>ya.end?a=ya.end+(a-ya.end)/6:a<ya.start&&(a=ya.start+(a-ya.start)/6):a=k(a,ya.start,ya.end),ab.start=+new Date,ab.time=0,ab.from=ya.cur,ab.to=a,ab.delta=a-ya.cur,ab.tweesing=cb.tweese||cb.init&&!cb.slidee,ab.immediate=!ab.tweesing&&(b||cb.init&&cb.slidee||!ra.speed),cb.tweese=0,a!==ya.dest&&(ya.dest=a,oa("change"),eb||M()),Z(),V(),W(),O()}function M(){if(sa.initialized){if(!eb)return eb=t(M),void(cb.released&&oa("moveStart"));ab.immediate?ya.cur=ab.to:ab.tweesing?(ab.tweeseDelta=ab.to-ya.cur,D(ab.tweeseDelta)<.1?ya.cur=ab.to:ya.cur+=ab.tweeseDelta*(cb.released?ra.swingSpeed:ra.syncSpeed)):(ab.time=I(+new Date-ab.start,ra.speed),ya.cur=ab.from+ab.delta*a.easing[ra.easing](ab.time/ra.speed,ab.time,0,1,ra.speed)),ab.to===ya.cur?(ya.cur=ab.to,cb.tweese=eb=0):eb=t(M),oa("move"),ta||(m?va[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+-ya.cur+"px)":va[0].style[ra.horizontal?"left":"top"]=-G(ya.cur)+"px"),!eb&&cb.released&&oa("moveEnd"),N()}}function N(){Aa.length&&(Da.cur=ya.start===ya.end?0:((cb.init&&!cb.slidee?ya.dest:ya.cur)-ya.start)/(ya.end-ya.start)*Da.end,Da.cur=k(G(Da.cur),Da.start,Da.end),_a.hPos!==Da.cur&&(_a.hPos=Da.cur,m?Aa[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+Da.cur+"px)":Aa[0].style[ra.horizontal?"left":"top"]=Da.cur+"px"))}function O(){Fa[0]&&_a.page!==Ja.activePage&&(_a.page=Ja.activePage,Fa.removeClass(ra.activeClass).eq(Ja.activePage).addClass(ra.activeClass),oa("activePage",_a.page))}function P(){bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)||sa.stop(),hb=cb.init?t(P):0,bb.now=+new Date,bb.pos=ya.cur+(bb.now-bb.lastTime)/1e3*bb.speed,L(cb.init?bb.pos:G(bb.pos)),cb.init||ya.cur!==ya.dest||oa("moveEnd"),bb.lastTime=bb.now}function Q(a,b,d){if("boolean"===e(b)&&(d=b,b=c),b===c)L(ya[a],d);else{if(Qa&&"center"!==a)return;var f=sa.getPos(b);f&&L(f[a],d,!Qa)}}function R(a){return null!=a?i(a)?a>=0&&a<Ia.length?a:-1:Ha.index(a):-1}function S(a){return R(i(a)&&0>a?a+Ia.length:a)}function T(a,b){var c=R(a);return!Ra||0>c?!1:((_a.active!==c||b)&&(Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ha.eq(c).addClass(ra.activeClass),_a.active=Ja.activeItem=c,W(),oa("active",c)),c)}function U(a){a=k(i(a)?a:ya.dest,ya.start,ya.end);var b={},c=Pa?0:wa/2;if(!ta)for(var d=0,e=Ga.length;e>d;d++){if(a>=ya.end||d===Ga.length-1){b.activePage=Ga.length-1;break}if(a<=Ga[d]+c){b.activePage=d;break}}if(Ra){for(var f=!1,g=!1,h=!1,j=0,l=Ia.length;l>j;j++)if(f===!1&&a<=Ia[j].start+Ia[j].half&&(f=j),h===!1&&a<=Ia[j].center+Ia[j].half&&(h=j),j===l-1||a<=Ia[j].end+Ia[j].half){g=j;break}b.firstItem=i(f)?f:0,b.centerItem=i(h)?h:b.firstItem,b.lastItem=i(g)?g:b.centerItem}return b}function V(b){a.extend(Ja,U(b))}function W(){var a=ya.dest<=ya.start,b=ya.dest>=ya.end,c=(a?1:0)|(b?2:0);if(_a.slideePosState!==c&&(_a.slideePosState=c,Ya.is("button,input")&&Ya.prop("disabled",a),Za.is("button,input")&&Za.prop("disabled",b),Ya.add(Va)[a?"addClass":"removeClass"](ra.disabledClass),Za.add(Ua)[b?"addClass":"removeClass"](ra.disabledClass)),_a.fwdbwdState!==c&&cb.released&&(_a.fwdbwdState=c,Va.is("button,input")&&Va.prop("disabled",a),Ua.is("button,input")&&Ua.prop("disabled",b)),Ra&&null!=Ja.activeItem){var d=0===Ja.activeItem,e=Ja.activeItem>=Ia.length-1,f=(d?1:0)|(e?2:0);_a.itemsButtonState!==f&&(_a.itemsButtonState=f,Wa.is("button,input")&&Wa.prop("disabled",d),Xa.is("button,input")&&Xa.prop("disabled",e),Wa[d?"addClass":"removeClass"](ra.disabledClass),Xa[e?"addClass":"removeClass"](ra.disabledClass))}}function X(a,b,c){if(a=S(a),b=S(b),a>-1&&b>-1&&a!==b&&(!c||b!==a-1)&&(c||b!==a+1)){Ha.eq(a)[c?"insertAfter":"insertBefore"](Ia[b].el);var d=b>a?a:c?b:b-1,e=a>b?a:c?b+1:b,f=a>b;null!=Ja.activeItem&&(a===Ja.activeItem?_a.active=Ja.activeItem=c?f?b+1:b:f?b:b-1:Ja.activeItem>d&&Ja.activeItem<e&&(_a.active=Ja.activeItem+=f?1:-1)),K()}}function Y(a,b){for(var c=0,d=$a[a].length;d>c;c++)if($a[a][c]===b)return c;return-1}function Z(){cb.released&&!sa.isPaused&&sa.resume()}function $(a){return G(k(a,Da.start,Da.end)/Da.end*(ya.end-ya.start))+ya.start}function _(){cb.history[0]=cb.history[1],cb.history[1]=cb.history[2],cb.history[2]=cb.history[3],cb.history[3]=cb.delta}function aa(a){cb.released=0,cb.source=a,cb.slidee="slidee"===a}function ba(b){var c="touchstart"===b.type,d=b.data.source,e="slidee"===d;cb.init||!c&&ea(b.target)||("handle"!==d||ra.dragHandle&&Da.start!==Da.end)&&(!e||(c?ra.touchDragging:ra.mouseDragging&&b.which<2))&&(c||f(b),aa(d),cb.init=0,cb.$source=a(b.target),cb.touch=c,cb.pointer=c?b.originalEvent.touches[0]:b,cb.initX=cb.pointer.pageX,cb.initY=cb.pointer.pageY,cb.initPos=e?ya.cur:Da.cur,cb.start=+new Date,cb.time=0,cb.path=0,cb.delta=0,cb.locked=0,cb.history=[0,0,0,0],cb.pathToLock=e?c?30:10:0,u.on(c?x:w,ca),sa.pause(1),(e?va:Aa).addClass(ra.draggedClass),oa("moveStart"),e&&(fb=setInterval(_,10)))}function ca(a){if(cb.released="mouseup"===a.type||"touchend"===a.type,cb.pointer=cb.touch?a.originalEvent[cb.released?"changedTouches":"touches"][0]:a,cb.pathX=cb.pointer.pageX-cb.initX,cb.pathY=cb.pointer.pageY-cb.initY,cb.path=E(F(cb.pathX,2)+F(cb.pathY,2)),cb.delta=ra.horizontal?cb.pathX:cb.pathY,cb.released||!(cb.path<1)){if(!cb.init){if(cb.path<ra.dragThreshold)return cb.released?da():c;if(!(ra.horizontal?D(cb.pathX)>D(cb.pathY):D(cb.pathX)<D(cb.pathY)))return da();cb.init=1}f(a),!cb.locked&&cb.path>cb.pathToLock&&cb.slidee&&(cb.locked=1,cb.$source.on(z,g)),cb.released&&(da(),ra.releaseSwing&&cb.slidee&&(cb.swing=(cb.delta-cb.history[0])/40*300,cb.delta+=cb.swing,cb.tweese=D(cb.swing)>10)),L(cb.slidee?G(cb.initPos-cb.delta):$(cb.initPos+cb.delta))}}function da(){clearInterval(fb),cb.released=!0,u.off(cb.touch?x:w,ca),(cb.slidee?va:Aa).removeClass(ra.draggedClass),setTimeout(function(){cb.$source.off(z,g)}),ya.cur===ya.dest&&cb.init&&oa("moveEnd"),sa.resume(1),cb.init=0}function ea(b){return~a.inArray(b.nodeName,B)||a(b).is(ra.interactive)}function fa(){sa.stop(),u.off("mouseup",fa)}function ga(a){switch(f(a),this){case Ua[0]:case Va[0]:sa.moveBy(Ua.is(this)?ra.moveBy:-ra.moveBy),u.on("mouseup",fa);break;case Wa[0]:sa.prev();break;case Xa[0]:sa.next();break;case Ya[0]:sa.prevPage();break;case Za[0]:sa.nextPage()}}function ha(a){return db.curDelta=(ra.horizontal?a.deltaY||a.deltaX:a.deltaY)||-a.wheelDelta,db.curDelta/=1===a.deltaMode?3:100,Ra?(o=+new Date,db.last<o-db.resetTime&&(db.delta=0),db.last=o,db.delta+=db.curDelta,D(db.delta)<1?db.finalDelta=0:(db.finalDelta=G(db.delta/1),db.delta%=1),db.finalDelta):db.curDelta}function ia(a){a.originalEvent[r]=sa;var b=+new Date;if(J+ra.scrollHijack>b&&Sa[0]!==document&&Sa[0]!==window)return void(J=b);if(ra.scrollBy&&ya.start!==ya.end){var c=ha(a.originalEvent);(ra.scrollTrap||c>0&&ya.dest<ya.end||0>c&&ya.dest>ya.start)&&f(a,1),sa.slideBy(ra.scrollBy*c)}}function ja(a){ra.clickBar&&a.target===za[0]&&(f(a),L($((ra.horizontal?a.pageX-za.offset().left:a.pageY-za.offset().top)-Ca/2)))}function ka(a){if(ra.keyboardNavBy)switch(a.which){case ra.horizontal?37:38:f(a),sa["pages"===ra.keyboardNavBy?"prevPage":"prev"]();break;case ra.horizontal?39:40:f(a),sa["pages"===ra.keyboardNavBy?"nextPage":"next"]()}}function la(a){return ea(this)?void(a.originalEvent[r+"ignore"]=!0):void(this.parentNode!==va[0]||a.originalEvent[r+"ignore"]||sa.activate(this))}function ma(){this.parentNode===Ea[0]&&sa.activatePage(Fa.index(this))}function na(a){ra.pauseOnHover&&sa["mouseenter"===a.type?"pause":"resume"](2)}function oa(a,b){if($a[a]){for(qa=$a[a].length,C.length=0,pa=0;qa>pa;pa++)C.push($a[a][pa]);for(pa=0;qa>pa;pa++)C[pa].call(sa,a,b)}}if(!(this instanceof d))return new d(b,p,q);var pa,qa,ra=a.extend({},d.defaults,p),sa=this,ta=i(b),ua=a(b),va=ra.slidee?a(ra.slidee).eq(0):ua.children().eq(0),wa=0,xa=0,ya={start:0,center:0,end:0,cur:0,dest:0},za=a(ra.scrollBar).eq(0),Aa=za.children().eq(0),Ba=0,Ca=0,Da={start:0,end:0,cur:0},Ea=a(ra.pagesBar),Fa=0,Ga=[],Ha=0,Ia=[],Ja={firstItem:0,lastItem:0,centerItem:0,activeItem:null,activePage:0},Ka=new l(ua[0]),La=new l(va[0]),Ma=new l(za[0]),Na=new l(Aa[0]),Oa="basic"===ra.itemNav,Pa="forceCentered"===ra.itemNav,Qa="centered"===ra.itemNav||Pa,Ra=!ta&&(Oa||Qa||Pa),Sa=ra.scrollSource?a(ra.scrollSource):ua,Ta=ra.dragSource?a(ra.dragSource):ua,Ua=a(ra.forward),Va=a(ra.backward),Wa=a(ra.prev),Xa=a(ra.next),Ya=a(ra.prevPage),Za=a(ra.nextPage),$a={},_a={},ab={},bb={},cb={released:1},db={last:0,delta:0,resetTime:200},eb=0,fb=0,gb=0,hb=0;ta||(b=ua[0]),sa.initialized=0,sa.frame=b,sa.slidee=va[0],sa.pos=ya,sa.rel=Ja,sa.items=Ia,sa.pages=Ga,sa.isPaused=0,sa.options=ra,sa.dragging=cb,sa.reload=function(){K()},sa.getPos=function(a){if(Ra){var b=R(a);return-1!==b?Ia[b]:!1}var c=va.find(a).eq(0);if(c[0]){var d=ra.horizontal?c.offset().left-va.offset().left:c.offset().top-va.offset().top,e=c[ra.horizontal?"outerWidth":"outerHeight"]();return{start:d,center:d-wa/2+e/2,end:d-wa+e,size:e}}return!1},sa.moveBy=function(a){bb.speed=a,!cb.init&&bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)&&(bb.lastTime=+new Date,bb.startPos=ya.cur,aa("button"),cb.init=1,oa("moveStart"),s(hb),P())},sa.stop=function(){"button"===cb.source&&(cb.init=0,cb.released=1)},sa.prev=function(){sa.activate(null==Ja.activeItem?0:Ja.activeItem-1)},sa.next=function(){sa.activate(null==Ja.activeItem?0:Ja.activeItem+1)},sa.prevPage=function(){sa.activatePage(Ja.activePage-1)},sa.nextPage=function(){sa.activatePage(Ja.activePage+1)},sa.slideBy=function(a,b){a&&(Ra?sa[Qa?"toCenter":"toStart"](k((Qa?Ja.centerItem:Ja.firstItem)+ra.scrollBy*a,0,Ia.length)):L(ya.dest+a,b))},sa.slideTo=function(a,b){L(a,b)},sa.toStart=function(a,b){Q("start",a,b)},sa.toEnd=function(a,b){Q("end",a,b)},sa.toCenter=function(a,b){Q("center",a,b)},sa.getIndex=R,sa.activate=function(a,b){var c=T(a);ra.smart&&c!==!1&&(Qa?sa.toCenter(c,b):c>=Ja.lastItem?sa.toStart(c,b):c<=Ja.firstItem?sa.toEnd(c,b):Z())},sa.activatePage=function(a,b){i(a)&&L(Ga[k(a,0,Ga.length-1)],b)},sa.resume=function(a){ra.cycleBy&&ra.cycleInterval&&("items"!==ra.cycleBy||Ia[0]&&null!=Ja.activeItem)&&!(a<sa.isPaused)&&(sa.isPaused=0,gb?gb=clearTimeout(gb):oa("resume"),gb=setTimeout(function(){switch(oa("cycle"),ra.cycleBy){case"items":sa.activate(Ja.activeItem>=Ia.length-1?0:Ja.activeItem+1);break;case"pages":sa.activatePage(Ja.activePage>=Ga.length-1?0:Ja.activePage+1)}},ra.cycleInterval))},sa.pause=function(a){a<sa.isPaused||(sa.isPaused=a||100,gb&&(gb=clearTimeout(gb),oa("pause")))},sa.toggle=function(){sa[gb?"pause":"resume"]()},sa.set=function(b,c){a.isPlainObject(b)?a.extend(ra,b):ra.hasOwnProperty(b)&&(ra[b]=c)},sa.add=function(b,c){var d=a(b);Ra?(null==c||!Ia[0]||c>=Ia.length?d.appendTo(va):Ia.length&&d.insertBefore(Ia[c].el),null!=Ja.activeItem&&c<=Ja.activeItem&&(_a.active=Ja.activeItem+=d.length)):va.append(d),K()},sa.remove=function(b){if(Ra){var c=S(b);if(c>-1){Ha.eq(c).remove();var d=c===Ja.activeItem;null!=Ja.activeItem&&c<Ja.activeItem&&(_a.active=--Ja.activeItem),K(),d&&(_a.active=null,sa.activate(Ja.activeItem))}}else a(b).remove(),K()},sa.moveAfter=function(a,b){X(a,b,1)},sa.moveBefore=function(a,b){X(a,b)},sa.on=function(a,b){if("object"===e(a))for(var c in a)a.hasOwnProperty(c)&&sa.on(c,a[c]);else if("function"===e(b))for(var d=a.split(" "),f=0,g=d.length;g>f;f++)$a[d[f]]=$a[d[f]]||[],-1===Y(d[f],b)&&$a[d[f]].push(b);else if("array"===e(b))for(var h=0,i=b.length;i>h;h++)sa.on(a,b[h])},sa.one=function(a,b){function c(){b.apply(sa,arguments),sa.off(a,c)}sa.on(a,c)},sa.off=function(a,b){if(b instanceof Array)for(var c=0,d=b.length;d>c;c++)sa.off(a,b[c]);else for(var e=a.split(" "),f=0,g=e.length;g>f;f++)if($a[e[f]]=$a[e[f]]||[],null==b)$a[e[f]].length=0;else{var h=Y(e[f],b);-1!==h&&$a[e[f]].splice(h,1)}},sa.destroy=function(){return d.removeInstance(b),Sa.add(Aa).add(za).add(Ea).add(Ua).add(Va).add(Wa).add(Xa).add(Ya).add(Za).off("."+r),u.off("keydown",ka),Wa.add(Xa).add(Ya).add(Za).removeClass(ra.disabledClass),Ha&&null!=Ja.activeItem&&Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ea.empty(),ta||(ua.off("."+r),Ka.restore(),La.restore(),Ma.restore(),Na.restore(),a.removeData(b,r)),Ia.length=Ga.length=0,_a={},sa.initialized=0,sa},sa.init=function(){if(!sa.initialized){if(d.getInstance(b))throw new Error("There is already a Sly instance on this element");d.storeInstance(b,sa),sa.on(q);var a=["overflow","position"],c=["position","webkitTransform","msTransform","transform","left","top","width","height"];Ka.save.apply(Ka,a),Ma.save.apply(Ma,a),La.save.apply(La,c),Na.save.apply(Na,c);var e=Aa;return ta||(e=e.add(va),ua.css("overflow","hidden"),m||"static"!==ua.css("position")||ua.css("position","relative")),m?n&&e.css(m,n):("static"===za.css("position")&&za.css("position","relative"),e.css({position:"absolute"})),ra.forward&&Ua.on(A,ga),ra.backward&&Va.on(A,ga),ra.prev&&Wa.on(z,ga),ra.next&&Xa.on(z,ga),ra.prevPage&&Ya.on(z,ga),ra.nextPage&&Za.on(z,ga),Sa.on(y,ia),za[0]&&za.on(z,ja),Ra&&ra.activateOn&&ua.on(ra.activateOn+"."+r,"*",la),Ea[0]&&ra.activatePageOn&&Ea.on(ra.activatePageOn+"."+r,"*",ma),Ta.on(v,{source:"slidee"},ba),Aa&&Aa.on(v,{source:"handle"},ba),u.on("keydown",ka),ta||(ua.on("mouseenter."+r+" mouseleave."+r,na),ua.on("scroll."+r,h)),sa.initialized=1,K(!0),ra.cycleBy&&!ta&&sa[ra.startPaused?"pause":"resume"](),sa}}}function e(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof a}function f(a,b){a.preventDefault(),b&&a.stopPropagation()}function g(b){f(b,1),a(this).off(b.type,g)}function h(){this.scrollLeft=0,this.scrollTop=0}function i(a){return!isNaN(parseFloat(a))&&isFinite(a)}function j(a,b){return 0|G(String(a.css(b)).replace(/[^\-0-9.]/g,""))}function k(a,b,c){return b>a?b:a>c?c:a}function l(a){var b={};return b.style={},b.save=function(){if(a&&a.nodeType){for(var c=0;c<arguments.length;c++)b.style[arguments[c]]=a.style[arguments[c]];return b}},b.restore=function(){if(a&&a.nodeType){for(var c in b.style)b.style.hasOwnProperty(c)&&(a.style[c]=b.style[c]);return b}},b}var m,n,o,p="sly",q="Sly",r=p,s=b.cancelAnimationFrame||b.cancelRequestAnimationFrame,t=b.requestAnimationFrame,u=a(document),v="touchstart."+r+" mousedown."+r,w="mousemove."+r+" mouseup."+r,x="touchmove."+r+" touchend."+r,y=(document.implementation.hasFeature("Event.wheel","3.0")?"wheel.":"mousewheel.")+r,z="click."+r,A="mousedown."+r,B=["INPUT","SELECT","BUTTON","TEXTAREA"],C=[],D=Math.abs,E=Math.sqrt,F=Math.pow,G=Math.round,H=Math.max,I=Math.min,J=0;u.on(y,function(a){var b=a.originalEvent[r],c=+new Date;(!b||b.options.scrollHijack<c-J)&&(J=c)}),d.getInstance=function(b){return a.data(b,r)},d.storeInstance=function(b,c){return a.data(b,r,c)},d.removeInstance=function(b){return a.removeData(b,r)},function(a){function b(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-c)),e=setTimeout(a,d);return c=b,e}t=a.requestAnimationFrame||a.webkitRequestAnimationFrame||b;var c=(new Date).getTime(),d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.clearTimeout;s=function(b){d.call(a,b)}}(window),function(){function a(a){for(var d=0,e=b.length;e>d;d++){var f=b[d]?b[d]+a.charAt(0).toUpperCase()+a.slice(1):a;if(null!=c.style[f])return f}}var b=["","Webkit","Moz","ms","O"],c=document.createElement("div");m=a("transform"),n=a("perspective")?"translateZ(0) ":""}(),b[q]=d,a.fn[p]=function(b,c){var f,g;return a.isPlainObject(b)||(("string"===e(b)||b===!1)&&(f=b===!1?"destroy":b,g=Array.prototype.slice.call(arguments,1)),b={}),this.each(function(a,e){var h=d.getInstance(e);h||f?h&&f&&h[f]&&h[f].apply(h,g):h=new d(e,b,c).init()})},d.defaults={slidee:null,horizontal:!1,itemNav:null,itemSelector:null,smart:!1,activateOn:null,activateMiddle:!1,scrollSource:null,scrollBy:0,scrollHijack:300,scrollTrap:!1,dragSource:null,mouseDragging:!1,touchDragging:!1,releaseSwing:!1,swingSpeed:.2,elasticBounds:!1,dragThreshold:3,interactive:null,scrollBar:null,dragHandle:!1,dynamicHandle:!1,minHandleSize:50,clickBar:!1,syncSpeed:.5,pagesBar:null,activatePageOn:null,pageBuilder:function(a){return"<li>"+(a+1)+"</li>"},forward:null,backward:null,prev:null,next:null,prevPage:null,nextPage:null,cycleBy:null,cycleInterval:5e3,pauseOnHover:!1,startPaused:!1,moveBy:300,speed:0,easing:"swing",startAt:null,keyboardNavBy:null,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}}(jQuery,window);var Activities=Activities||{};Activities.base=function(){this.complete=!1,this.content=null,this.page=0,this.setToComplete=function(){this.complete||(this.complete=!0,Global.controller.pageComplete())}},Activities.ClickReveal=function(){function a(){for(var a=0,c=j.length;c>a;a++)$(j[a].clicker).css({cursor:"pointer"}).on("click",{cl:a},b),e.addToResetEventListeners(j[a].clicker)}function b(a){h&&h.removeFromStage(),i&&i.btnObject.setState("done");var b=a.data.cl;j[b].btnObject.setState("selected"),null!=j[b].popup&&j[b].popup.removeFromStage();var e=new Helpers.popup;e.setWidth(j[b].popupwidth),e.setHeight(j[b].popupheight),e.setX(j[b].popupx),e.setY(j[b].popupy),e.setName(j[b].popupid),e.setClosebtn(g.closeButton),e.setOwnerObject(k),e.setClass(j[b].popupbg?"feedbackpopup":"invisiblepopup"),e.addToStage(f),j[b].seen=!0,j[b].popup=e;for(var l=0,m=j[b].clickerpageobj.activities.length;m>l;l++)j[b].clickerpageobj.activities[l].pageNumber==j[b].clickerpageobj.pageposition&&Factory.activityStore.createActivity(j[b].clickerpageobj.activities[l].name,j[b].clickerpageobj,$("#"+e.name)[0]);(null!=j[b].clickerpageobj.pagexml[j[b].clickerpageobj.pageposition].getAttribute("sound")||void 0!=j[b].clickerpageobj.pagexml[j[b].clickerpageobj.pageposition].getAttribute("sound"))&&(e.includeSound(!0),Global.soundController.playSound(j[b].clickerpageobj.pagexml[j[b].clickerpageobj.pageposition].getAttribute("sound"),j[b].clickerpageobj)),c()&&d.setToComplete(),h=e,i=j[b]}function c(){for(var a=0,b=j.length;b>a;a++)if(!j[a].seen)return!1;return!0}var d,e,f,g,h,i,j=[],k=this;this.buildActivity=function(b,c){d=new Activities.base,f=c,e=b,_prefix=c.getAttribute("id")+"-"+b.pageposition;var h=$(e.pagexml[e.pageposition]).children("clickrevealOptions")[0],i=e.pagexml[e.pageposition].getElementsByTagName("clickreveal");g={delayActivation:h.getAttribute("delayactivation"),closeButton:"yes"==h.getAttribute("closebutton")?!0:!1};for(var k=0,l=i.length;l>k;k++)j.push({clickerraw:i[k],clickerpageobj:new Models.page("click reveal"),clickericon:i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue,clickericonover:Helpers.imageExists(i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_over",e.images)?i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_over":null,clickericonselected:Helpers.imageExists(i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_selected",e.images)?i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_selected":null,clickericondone:Helpers.imageExists(i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_done",e.images)?i[k].getElementsByTagName("clicker")[0].firstChild.nodeValue+"_done":null,clickerx:i[k].getElementsByTagName("clicker")[0].getAttribute("x"),clickery:i[k].getElementsByTagName("clicker")[0].getAttribute("y"),clickerreveal:i[k].getElementsByTagName("clicker")[0].getAttribute("revealDelay"),popupx:i[k].getAttribute("x"),popupy:i[k].getAttribute("y"),popupheight:i[k].getAttribute("height"),popupwidth:i[k].getAttribute("width"),popupbg:"no"!==i[k].getAttribute("bg")?!0:!1,popuppages:i[k].getElementsByTagName("page"),popupnumberofpages:i[k].getElementsByTagName("page").length,popupageon:0,popupid:_prefix+"popup"+k,popup:null,seen:!1});for(var m=new TimelineLite,k=0,l=j.length;l>k;k++){for(var n=0,o=e.images.length;o>n;n++)if(e.images[n].id===j[k].clickericon){var p=new Helpers.buttonImage;p.setId(_prefix+"-"+k+"-clickreveal"),p.setState1Image(Helpers.findImage(j[k].clickericon,e.images)),j[k].clickericonover&&p.setState2Image(Helpers.findImage(j[k].clickericonover,e.images)),j[k].clickericonselected&&p.setState3Image(Helpers.findImage(j[k].clickericonselected,e.images)),j[k].clickericondone&&p.setState4Image(Helpers.findImage(j[k].clickericondone,e.images)),p.drawButton(f),j[k].clicker=p.getButton(),j[k].btnObject=p;var m=new TimelineLite;m.set(j[k].clicker,{position:"absolute",left:j[k].clickerx,top:j[k].clickery-10,opacity:0}),m.append(new TweenLite(j[k].clicker,.5,{top:j[k].clickery,opacity:1,delay:j[k].clickerreveal})),e.addToReset(m)}j[k].clickerpageobj.numberofscreens=j[k].popupnumberofpages,j[k].clickerpageobj.pagexml=j[k].clickerraw.getElementsByTagName("page"),j[k].clickerpageobj.linkActivities(j[k].clickerpageobj),j[k].clickerpageobj.sounds=e.sounds,j[k].clickerpageobj.images=e.images,j[k].clickerpageobj.manifest=e.manifest,j[k].clickerpageobj.transcripts=e.transcripts}var q=new TweenMax.delayedCall(g.delayActivation,a);e.addToReset(q)},this.popupClosed=function(a){for(var b=0,c=j.length;c>b;b++)a===j[b].popupid&&j[b].btnObject.setState("done")}},Activities.TextActivity=function(){function a(){for(var a=0,b=g.length;b>a;a++){$(e).append('<p id="st-'+f+"-"+a+'" class="statement">'+g[a].text+"</p>"),TweenLite.set($("#st-"+f+"-"+[a]),{left:g[a].x,top:g[a].y-10,width:g[a].width,opacity:0,textAlign:g[a].align});var c=new TimelineLite;c.to($("#st-"+f+"-"+[a]),.5,{delay:g[a].delay,left:g[a].x,top:g[a].y,opacity:1}),g[a].remove&&c.to($("#st-"+f+"-"+[a]),.2,{autoAlpha:0},"+="+g[a].remove),d.addToReset(c)}}var b,c,d,e,f,g=[];this.buildActivity=function(h,i){f=i.getAttribute("id")+"-"+h.pageposition,b=new Activities.base,e=i,b.page=c,d=h;for(var j=$(d.pagexml[d.pageposition]).children("statement"),k=0,l=j.length;l>k;k++)g.push({text:j[k].childNodes[0].nodeValue,delay:Number(j[k].getAttribute("delay")),x:Number(j[k].getAttribute("x")),y:Number(j[k].getAttribute("y"))+10,width:Number(j[k].getAttribute("width")),align:j[k].getAttribute("align")?j[k].getAttribute("align"):"left",remove:j[k].getAttribute("remove")?j[k].getAttribute("remove"):null});a()}},Activities.BulletActivity=function(){function a(){for(var a=0,b=g.length;b>a;a++){$(e).append('<p id="bu-'+f+"-"+a+'" class="bullet">'+g[a].text+"</p>"),TweenLite.set($("#bu-"+f+"-"+[a]),{left:g[a].x,top:g[a].y-10,width:g[a].width,opacity:0});var c=new TimelineLite;c.to($("#bu-"+f+"-"+[a]),.5,{delay:g[a].delay,left:g[a].x,top:g[a].y,opacity:1}),g[a].remove&&c.to($("#bu-"+f+"-"+[a]),.2,{autoAlpha:0},"+="+g[a].remove),d.addToReset(c)}}var b,c,d,e,f,g=[];this.buildActivity=function(h,i){f=i.getAttribute("id")+"-"+h.pageposition,b=new Activities.base,e=i,b.page=c,d=h;for(var j=$(d.pagexml[d.pageposition]).children("bullet"),k=0,l=j.length;l>k;k++)g.push({text:j[k].childNodes[0].nodeValue,delay:j[k].getAttribute("delay"),x:j[k].getAttribute("x"),y:j[k].getAttribute("y"),width:j[k].getAttribute("width"),remove:j[k].getAttribute("remove")?j[k].getAttribute("remove"):null});a()}},Activities.ActivityText=function(){function a(){for(var a=0,b=h.length;b>a;a++)if("normal"===h[a].style){$(e).append('<p id="'+h[a].id+'" class="normalinstruction">'+h[a].text+"</p>"),TweenLite.set($("#"+h[a].id),{left:h[a].x,top:h[a].y-10,width:h[a].width,opacity:0});var c=TweenLite.to($("#"+h[a].id),.5,{delay:h[a].delay,left:h[a].x,top:h[a].y,opacity:1});d.addToReset(c)}else if("slide"===h[a].style){$(e).append('<p id="'+h[a].id+'" class="slideinstruction">'+h[a].text+"</p>"),TweenLite.set($("#"+h[a].id),{left:h[a].x-2e3,top:h[a].y-10,width:680,opacity:0,skewX:40});var f=new TimelineLite;f.append(TweenLite.to($("#"+h[a].id),.3,{delay:h[a].delay,left:h[a].x,top:h[a].y,opacity:1,skewX:10})),f.to($("#"+h[a].id),.2,{skewX:-10,left:h[a].x}),f.to($("#"+h[a].id),.15,{skewX:10,left:h[a].x}),f.to($("#"+h[a].id),.1,{skewX:0}),d.addToReset(f)}}var b,c,d,e,f,g,h=[];this.buildActivity=function(i,j){g=j.getAttribute("id")+"-"+i.pageposition+"-act-",b=new Activities.base,e=j,b.page=c,d=i,f=$(d.pagexml[d.pageposition]).children("instructionOptions");for(var k=0,l=f.length;l>k;k++)h.push({x:f[k].getAttribute("x"),y:f[k].getAttribute("y"),width:f[k].getAttribute("width"),delay:f[k].getAttribute("delay"),style:"slide"!=f[k].getAttribute("style")?"normal":"slide",text:f[k].getElementsByTagName("instruction")[0].textContent,sound:f[k].getAttribute("sound"),id:"in-"+g+"-"+k});a()}},Activities.DragDropToTargets=function(){"use strict";function a(a){return a?""!==a?Number(a):-1:void 0}function b(a){v||(v=[]);for(var b=0;b<v.length;b++)if(v[b].order==a)return void v[b].required++;u=1,v.push({order:a,required:1,landed:0})}function c(a,b,c){if(!a)return!0;if(a===c)for(var d=0;d<b.length;d++)if(b[d].order==a)return b[d].landed++,b[d].landed===b[d].required&&u++,!0;return!1}function d(a){return{text:a.firstChild.nodeValue,x:Number(a.getAttribute("x")),y:Number(a.getAttribute("y")),width:Number(a.getAttribute("width")),height:Number(a.getAttribute("height")),tickcross:"yes"!==a.getAttribute("tickCross")?!1:!0,tickcrossX:a.getAttribute("tickCrossX")?Number(a.getAttribute("tickCrossX")):void 0,tickcrossY:a.getAttribute("tickCrossY")?Number(a.getAttribute("tickCrossY")):void 0,background:"no"!==a.getAttribute("fbbg")?!0:!1,closeBtn:"no"!==a.getAttribute("closeBtn")?!0:!1,sound:a.getAttribute("sound")?a.getAttribute("sound"):void 0}}function e(){for(var a=0,b=w.length;b>a;a++){var c=Helpers.findImage(w[a].image,m.images);if(c){var d=Helpers.addImage(w[a].image,m.images,n);$(d.pic).attr("id",w[a].id),TweenLite.set($("#"+w[a].id),{position:"absolute",x:w[a].x,y:w[a].y,opacity:0})}else $(n).append('<div id="'+w[a].id+'"></div>'),"invisible"!==w[a].image&&$("#"+w[a].id).addClass("drag-drop-target"),TweenLite.set($("#"+w[a].id),{position:"absolute",x:w[a].x,y:w[a].y,width:w[a].width,height:w[a].height,opacity:0})}}function f(){for(var a=0,b=x.length;b>a;a++){var c=Helpers.findImage(x[a].image,m.images);if(c)x[a].width=c.width,x[a].height=c.height,x[a]["class"]&&$(c).addClass(x[a]["class"]),x[a].imageobj=Helpers.addImage(x[a].image,m.images,n),TweenLite.set(x[a].imageobj.pic,{position:"absolute",x:x[a].x,y:x[a].y,width:x[a].width*x[a].startScaleX,height:x[a].height*x[a].startScaleY,opacity:0}),$(x[a].imageobj.pic).attr("id",x[a].id).addClass("drag-drop-drag"),x[a].width=x[a].imageobj.width,x[a].height=x[a].imageobj.height;else{$(n).append('<div id="'+x[a].id+'" class="drag-drop-text-drag drag-drop-drag"><p id="'+x[a].id+'-text">'+x[a].image+"</p ></div>"),TweenLite.set($("#"+x[a].id),{position:"absolute",x:x[a].x,y:x[a].y,width:x[a].width,height:x[a].height,opacity:0});var d=Helpers.verticalAlignText($("#"+x[a].id+"-text"),$("#"+x[a].id));TweenLite.set($("#"+x[a].id+"-text"),{y:d})}}}function g(){for(var a=0;p>a;a++)s.to($("#"+w[a].id),.5,{opacity:1},0);for(a=0;q>a;a++)s.to($("#"+x[a].id),.5,{opacity:1},0);var b,d,e=$(".drag-drop-drag"),f="50%",g=Global.model.zoom;Draggable.create(e,{type:"x,y",onPress:function(){b=this.x,d=this.y,g=Global.model.zoom},onDrag:function(){if(!createjs.BrowserDetect.isFirefox){var a=1/g-1;TweenMax.set(this.target,{x:"+="+(this.x-b)*a,y:"+="+(this.y-d)*a})}},onRelease:function(b){var d=this.target.getAttribute("id");for(a=0;q>a;a++)if(x[a].id===d){if(x[a].target&&this.hitTest($("#"+x[a].target.id),f)&&c(x[a].order,v,u)){if(this.disable(),x[a].finishx){var e=TweenLite.to($("#"+d),.5,{x:x[a].finishx,y:x[a].finishy,width:x[a].width*x[a].scalex,height:x[a].height*x[a].scaley},0);m.addToReset(e)}else{var g=TweenLite.to($("#"+d),.5,{x:x[a].target.x,y:x[a].target.y,scaleX:x[a].scalex,scaleY:x[a].scaley},0);m.addToReset(g)}x[a].landed=!0,j()&&l.setToComplete(),x[a].cfb&&h(x[a].cfb)}else{var i=TweenLite.to($("#"+d),.5,{x:x[a].x,y:x[a].y});m.addToReset(i),x[a].icfb&&h(x[a].icfb)}break}}})}function h(a){i();var b;b=new Helpers.popup,b.setWidth(a.width),b.setHeight(a.height),b.setX(a.x),b.setY(a.y),b.setName(o+"feedback"),b.setClosebtn(!0),b.addToStage(n),b.addText(a.text),a.sound&&Global.soundController.playSound(a.sound,m),t=b}function i(){t?t.removeFromStage():Global.soundController.stopSound()}function j(){for(var a=0;q>a;a++)if(!x[a].landed&&x[a].target)return!1;return!0}function k(){for(var a=[],b=0;q>b;b++)a.push({y:x[b].y,x:x[b].x});for(Helpers.shuffleArray(a),b=0;q>b;b++)x[b].y=a[b].y,x[b].x=a[b].x}var l,m,n,o,p,q,r,s,t,u,v,w=[],x=[],y=!1;this.buildActivity=function(c,h){l=new Activities.base,m=c,n=h,o=h.getAttribute("id")+"-"+c.pageposition,s=new TimelineLite,m.addToReset(s);var i=$(m.pagexml[m.pageposition]).children("draganddrop")[0];r={delay:i.getAttribute("delay"),targetVisible:"yes"===i.getAttribute("targetVisible")?!0:!1,shufflePositions:"yes"===i.getAttribute("shufflePositions")?!0:!1,oneAtTime:"yes"===i.getAttribute("oneAtTime")?!0:!1};var j=i.getElementsByTagName("target");p=j.length;for(var t=0;p>t;t++){var u={name:j[t].getAttribute("name"),x:Number(j[t].getAttribute("targetx")),y:Number(j[t].getAttribute("targety")),width:Number(j[t].getAttribute("targetWidth")),height:Number(j[t].getAttribute("targetHeight")),image:j[t].firstChild.nodeValue,id:o+"target-"+t};w.push(u)}var v=i.getElementsByTagName("drag");for(q=v.length,t=0;q>t;t++){var z=v[t].getElementsByTagName("dragger")[0],A={name:z.getAttribute("name"),x:Number(z.getAttribute("startingx")),y:Number(z.getAttribute("startingy")),targetname:z.getAttribute("target"),image:z.firstChild.nodeValue,scalex:z.getAttribute("scalex")?Number(z.getAttribute("scalex")):1,scaley:z.getAttribute("scaley")?Number(z.getAttribute("scaley")):1,startScaleX:z.getAttribute("startScaleX")?Number(z.getAttribute("startScaleX")):1,startScaleY:z.getAttribute("startScaleY")?Number(z.getAttribute("startScaleY")):1,finishx:z.getAttribute("finishx")?Number(z.getAttribute("finishx")):void 0,finishy:z.getAttribute("finishy")?Number(z.getAttribute("finishy")):void 0,"class":z.getAttribute("class")?Number(z.getAttribute("class")):void 0,order:a(z.getAttribute("order")),id:o+"dragger-"+t,landed:!1},B=v[t].getElementsByTagName("cfeedback")?v[t].getElementsByTagName("cfeedback")[0]:void 0;A.cfb=B?d(B):void 0;var C=v[t].getElementsByTagName("icfeedback")?v[t].getElementsByTagName("icfeedback")[0]:void 0;A.icfb=C?d(C):void 0,x.push(A)}for(t=0;q>t;t++){for(var D=0,E=w.length;E>D;D++)if(w[D].name===x[t].targetname){x[t].width=w[D].width,x[t].height=w[D].height,x[t].target=w[D];break}x[t].order&&x[t].order>0&&(y=!0,b(x[t].order))}if(y)for(t=0;q>t;t++)(!x[t].order||x[t].order<0)&&(x[t].landed=!0);r.shufflePositions&&k(),e(),f();var F=new TweenMax.delayedCall(r.delay,g);m.addToReset(F)}},Activities.DragDropIntoList=function(){"use strict";function a(){var a=new TimelineLite;i.addToReset(a);for(var d=0;l>d;d++)if(r[d].title){var e=new Helpers.listBox;e.setId(r[d].id),e.setHeight(r[d].height),e.setWidth(r[d].width),e.setTextColour(r[d].textcolour),e.drawBox(j),$("#"+r[d].id).append('<p class="list-box-heading">'+r[d].title+"</p>"),TweenLite.set($("#"+r[d].id),{top:r[d].y,left:r[d].x,opacity:0})}else $(j).append('<div id="'+r[d].id+'"></div>'),TweenLite.set($("#"+r[d].id),{position:"absolute",top:r[d].y,left:r[d].x,width:r[d].width,height:r[d].height,opacity:0});b(),c()}function b(){for(var a=0;m>a;a++){var b=new TimelineLite;i.addToReset(b);var c=new Helpers.Button(s[a].text);c.setWidth(s[a].width),c.setHeight(s[a].height),c.setButtonColour(s[a].colour),c.setFontColour(s[a].tColour),
c.setId(s[a].id),c.drawButton(j),TweenLite.set($("#"+s[a].id),{y:s[a].y,x:s[a].x,opacity:0})}}function c(){for(var a=0;l>a;a++)q.to($("#"+r[a].id),.3,{opacity:1},.5);var b=[];for(a=0;m>a;a++)q.to($("#"+s[a].id),.3,{opacity:1},.5),b.push($("#"+s[a].id));var c,e,f=Global.model.zoom;Draggable.create(b,{type:"x,y",onPress:function(){c=this.x,e=this.y,f=Global.model.zoom},onDrag:function(){if(!createjs.BrowserDetect.isFirefox){var a=1/f-1;TweenMax.set(this.target,{x:"+="+(this.x-c)*a,y:"+="+(this.y-e)*a})}},onRelease:d})}function d(a){for(var b="50%",c=this.target.getAttribute("id"),d=0;m>d;d++)if(s[d].id===c){if(s[d].target&&this.hitTest($("#"+s[d].target.id),b)){for(var f=s[d].target.x+(s[d].target.width/2-s[d].width/2),j=s[d].target.y+s[d].target.toppadding,k=0,l=s[d].target.draggersOn.length;l>k;k++)j+=s[d].target.draggersOn[k].height,j+=n.bottomPadding;TweenLite.to($("#"+c),.5,{x:f,y:j},0),s[d].landed=!0,s[d].target.draggersOn.push(s[d]),s[d].target.numberOn++,g()&&(h.setToComplete(),p&&e(p)),s[d].cfb&&e(s[d].cfb),this.disable(),i.addToResetEventListeners($("#"+c))}else TweenLite.to($("#"+c),.5,{x:s[d].x,y:s[d].y});break}}function e(a){f();var b;b=new Helpers.popup,b.setWidth(a.width),b.setHeight(a.height),b.setX(a.x),b.setY(a.y),b.setName("feedback"),b.setClosebtn(!0),b.addToStage(j),b.addText(a.text),a.sound&&Global.soundController.playSound(a.sound,i),o=b}function f(){o?o.removeFromStage():Global.soundController.stopSound()}function g(){for(var a=0;l>a;a++)if(r[a].numberOn!==r[a].numberRequired)return!1;return!0}var h,i,j,k,l,m,n,o,p,q,r=[],s=[];this.buildActivity=function(b,c){h=new Activities.base,i=b,j=c,k=c.getAttribute("id")+"-"+b.pageposition,q=new TimelineLite,i.addToReset(q);var d=$(i.pagexml[i.pageposition]).children("selectOptions")[0];n={delay:d.getAttribute("delay"),draggerFontSize:Number(d.getAttribute("draggerFontSize")),shufflePositions:"true"===d.getAttribute("shufflePos")?!0:!1,bottomPadding:Number(d.getAttribute("bottomPadding")),yBetween:d.getAttribute("yBetween")?Number(d.getAttribute("yBetween")):void 0};var e=$(d).children("target");l=e.length;for(var f=0;l>f;f++){r.push({x:Number(e[f].getAttribute("x")),y:Number(e[f].getAttribute("y")),width:Number(e[f].getAttribute("width")),height:Number(e[f].getAttribute("height")),toppadding:Number(e[f].getAttribute("lfromtop")),name:e[f].getAttribute("number"),colour:Helpers.convertColour(e[f].getAttribute("colour")),textcolour:Helpers.convertColour(e[f].getAttribute("tColour")),title:e[f].firstChild?e[f].firstChild.nodeValue:!1,id:k+"-list-"+f,numberRequired:0,numberOn:0,targetObject:void 0,draggersOn:[]});e[f].getElementsByTagName("FB")?e[f].getElementsByTagName("FB")[0]:void 0}var g=$(d).children("option");for(m=g.length,f=0;m>f;f++){var o=g[f].getElementsByTagName("dragger")[0];s[f]={x:Number(o.getAttribute("x")),y:n.yBetween&&f>0?s[f-1].y+s[f-1].height+n.yBetween:Number(o.getAttribute("y")),delay:Number(o.getAttribute("delay")),colour:Helpers.convertColour(o.getAttribute("colour")),roColour:Helpers.convertColour(o.getAttribute("roColour")),tColour:Helpers.convertColour(o.getAttribute("tColour")),width:Number(o.getAttribute("width")),height:Number(o.getAttribute("height")),text:o.firstChild.nodeValue,cfb:void 0,id:k+"-dr-"+f,landed:!1};for(var t=0;l>t;t++)g[f].getElementsByTagName("correct")[0].firstChild.nodeValue===r[t].name&&(s[f].target=r[t],r[t].numberRequired++);var u=g[f].getElementsByTagName("correctfb")?g[f].getElementsByTagName("correctfb")[0]:void 0;if(u){var v={x:Number(u.getAttribute("x")),y:Number(u.getAttribute("y")),width:Number(u.getAttribute("width")),height:Number(u.getAttribute("height")),sound:u.getAttribute("sound"),text:u.firstChild.nodeValue};s[f].cfb=v}}var w=$(d).children("fb")?$(d).children("fb")[0]:void 0;if(w&&(p={x:Number(w.getAttribute("x")),y:Number(w.getAttribute("y")),width:Number(w.getAttribute("width")),height:Number(w.getAttribute("height")),sound:w.getAttribute("sound"),text:w.firstChild.nodeValue}),n.shufflePositions){var x=[];for(f=0;m>f;f++)x.push({x:s[f].x,y:s[f].y});for(Helpers.shuffleArray(x),f=0;m>f;f++)s[f].y=x[f].y,s[f].x=x[f].x}var y=new TweenMax.delayedCall(n.delay,a);i.addToReset(y)}},Activities.DragFromScrollerIntoList=function(){function a(){var a=new TimelineLite;p.addToReset(a);for(var b=0;u>b;b++)if(t[b].shadow)$(q).append('<div id="'+t[b].id+'"></div>'),"invisible"!==t[b].image&&$("#"+t[b].id).addClass("drag-drop-target-in-list").css,TweenLite.set($("#"+t[b].id),{position:"absolute",x:t[b].x,y:t[b].y,width:t[b].width,height:t[b].height,opacity:0}),a.to($("#"+t[b].id),.3,{opacity:1},t[b].revealdelay);else{var c=new Helpers.listBox;c.setId(t[b].id),c.setHeight(t[b].height),c.setWidth(t[b].width),c.setTextColour(t[b].textcolour),c.drawBox(q),$("#"+t[b].id).append('<p class="list-box-heading">'+t[b].title+"</p>"),TweenLite.set($("#"+t[b].id),{top:t[b].y,left:t[b].x,opacity:0}),a.to($("#"+t[b].id),.3,{opacity:1},t[b].revealdelay)}}function b(){s.id=r+"-dr-scroller",$(q).append('<div id="'+s.id+'" class="wrap"><div id="scrollholder'+r+'" class="frame oneperframe style="overflow: hidden"><ul id="scrollulvert" class="slidee"></ul></div></div></div>'),TweenLite.set($("#"+s.id),{top:s.y,left:s.x,width:s.width,height:s.height,opacity:0});for(var a=0;y>a;a++){x[a].id=r+"-drag-"+a,$("#scrollulvert").append('<li id="'+r+"-scrollulvertli-"+a+'"><div class="icon-ind-holder" id="'+r+"icon-ind-holder-"+a+'"></div></li>'),TweenLite.set($("#"+r+"-scrollulvertli-"+a),{autoAlpha:0}),0===a&&($("#"+r+"-scrollulvertli-"+a).addClass("active"),TweenLite.set($("#"+r+"-scrollulvertli-"+a),{autoAlpha:1}));var b=r+"-drag-"+a+"-ic",d=new Helpers.iconBox;d.setId(b),d.setHeight(x[a].height),d.setWidth(s.width-5),d.drawIcon("#"+r+"icon-ind-holder-"+a),x[a].dragObj=d,x[a].drag=$("#"+r+"icon-ind-holder-"+a),E[a]=x[a].drag;var e=$("#"+b+" .iconbox-inner");x[a].image=Helpers.addImage(x[a].iconimage,p.images,e),x[a].imagewidth=x[a].image.width,x[a].imageheight=x[a].image.height,$(e).append('<p class="draggertitle" id="draggertitle-'+a+'">'+x[a].title+"</p>"),TweenLite.set($("#draggertitle-"+a),{padding:0,margin:0}),D=x[a].image&&x[a].image.width>D?x[a].image.width:D}for(a=0;y>a;a++){var e=$("#"+r+"-drag-"+a+"-ic .iconbox-inner"),g=Helpers.verticalAlignImage(x[a].image,e);TweenLite.set(x[a].image.pic,{top:g,left:10,width:x[a].image.width,height:x[a].image.height}),TweenLite.set($("#draggertitle-"+a),{left:D+10,margin:"0 5px"});var h=Helpers.verticalAlignText($("#draggertitle-"+a),$("#draggertitle-"+a).parent());TweenLite.set($("#draggertitle-"+a),{top:h})}var i=$("#scrollholder"+r);i.parent();$(q).append('<a id="'+r+'-scrollleft" class="scrollerleft scrollcontrol"><div class="scarrow arrow-left"></div></a>'),$(q).append('<a id="'+r+'-scrollright" class="scrollerright scrollcontrol"><div class="scarrow arrow-right"></div></a>'),TweenLite.set($("#"+r+"-scrollleft"),{height:s.height-20,left:s.x-35,top:s.y+9}),TweenLite.set($("#"+r+"-scrollright"),{height:s.height-20,left:s.x+s.width+10,top:s.y+9});var j=$("#"+r+"-scrollleft").height()/2-10;TweenLite.set($(".scrollcontrol div"),{top:j,left:3}),$("#"+r+"-scrollright").on("click",function(){var a=$("#scrollulvert li.active");c(!0,a)}),$("#"+r+"-scrollleft").on("click",function(){var a=$("#scrollulvert li.active");c(!1,a)}),tl2=new TimelineLite,p.addToReset(tl2),tl2.to($("#"+s.id),.3,{opacity:1}),f()}function c(a,b){a?$(b).next().is("li")&&$(b).removeClass("active").next().addClass("active"):$(b).prev().is("li")&&$(b).removeClass("active").prev().addClass("active"),e()}function d(){$("#scrollulvert li").each(function(){$(this).hasClass("active")}),$("#scrollulvert li").first().addClass("active"),e(!0)}function e(a){var b=a?0:.3;$("#scrollulvert li").each(function(){$(this).hasClass("active")?TweenLite.to($(this),b,{autoAlpha:1}):TweenLite.to($(this),b,{autoAlpha:0})})}function f(){$(x).each(function(){var a=this,b=$(this.drag.children()[0]),c=b.parent().parent(),d=b.position(),e=createjs.BrowserDetect.isChrome?1:Global.model.zoom,f={clone:b.clone().addClass("clone").prependTo(q),element:b,wrapper:c,width:c.outerWidth(),dropped:!1,moved:!1,dragger:a,get x(){return 1*l(c,d).x/e},get y(){return 1*l(c,d).y/e}};f.draggable=h(f),b.on("mousedown touchstart",f,g)})}function g(a){var b=a.data;z=b.dragger,TweenLite.set(b.element,{autoAlpha:0});var c=$(b.element.children(".iconbox-inner")[0]).children("img")[0],d=$(b.clone.children(".iconbox-inner")[0]).children("img")[0];d&&$(b.clone.children(".iconbox-inner")[0]).children("img")[0].remove(),$(c).prependTo(b.clone.children(".iconbox-inner")[0]),TweenLite.set(b.clone,{x:b.x,y:b.y,autoAlpha:1}),b.draggable.startDrag(a.originalEvent)}function h(a){function b(){if(!createjs.BrowserDetect.isFirefox){var b=1/l-1;TweenMax.set(this.target,{x:"+="+(this.x-f)*b,y:"+="+(this.y-g)*b})}if(!a.moved&&!this.hitTest(i)){a.moved=!0;var d=$(z.drag.parent());$(d).is(":last-child")?c(!1,d):c(!0,d)}}function e(){function b(){var a=w?w:A,b=$(e).height(),f=TweenLite.to(e,.1,{top:(a-b)/2});p.addToReset(f);var g=$(c).height();TweenLite.to(c,.1,{top:(a-g)/2});d()}var c,e,f=void 0,g=a.dragger.dragObj.getId(),i=$("#"+g),l=$("#"+g+" .iconbox-inner");if(this.hitTest("#"+a.dragger.target.id,"50%")){var r=w?w:A;c=l.children(["img"])[0];var s=$(c).width(),t=$(c).height();e=l.children(["p"])[1];var u=Number(a.dragger.target.y+a.dragger.target.toppadding+a.dragger.target.numberOn*(r+2));$(z.drag.parent()).remove(),a.dragger.dragObj.removeBg(q);var x=TweenLite.to(i,.3,{height:r,width:a.dragger.target.width-5,overflow:"hidden"});p.addToReset(x);var y=(A-5)/t,B=v&&y*s>v?v/s:y,C=s*B,D=t*B,E=TweenLite.to(c,.3,{width:C,height:D,top:2,left:5});p.addToReset(E);var F=B*s+5,G=TweenLite.to(e,.3,{left:F,width:a.dragger.target.width-75,top:r/2,fontSize:13}),H=TweenLite.to(h,.3,{x:a.dragger.target.x,y:u,onComplete:b});p.addToReset(G),p.addToReset(H),f="+=dropped",a.dragger.target.numberOn++,a.draggable.disable(),a.dragger.complete=!0,a.dragger.cFeedback&&k(a.dragger.cFeedback),a.dragger.target.feedback&&n(a.dragger.target)&&k(a.dragger.target.feedback),m()&&o.setToComplete()}else j(a,f),a.dragger.icoFeedback&&k(a.dragger.icoFeedback)}var f,g,h=a.clone,i=a.wrapper,l=(t[0].width/s.width,Global.model.zoom);return a.draggable=new Draggable(h,{onPress:function(){f=this.x,g=this.y,l=Global.model.zoom},onDrag:b,onRelease:e}),a.draggable}function i(){B&&!B.invisible?B.removeFromStage():Global.soundController.stopSound()}function j(a,b){function c(){a.moved=!1,TweenLite.set(d,{autoAlpha:0});var b=$("#scrollulvert li.active");$(b).removeClass("active"),$(f.parent().parent()).addClass("active"),e(!0),TweenLite.set(f,{autoAlpha:1});var c=$(d.children(".iconbox-inner")[0]).children("img")[0];$(c).prependTo(f.children(".iconbox-inner")[0])}var d=a.clone,f=a.element;a.wrapper;TweenLite.to(d,.3,{scale:1,autoAlpha:1,x:a.x,y:a.y,onComplete:c}),b&&TweenLite.to([f,d],.3,{className:b})}function k(a){i();var b;if(a.activities.length>0?(b=new Helpers.popup,b.setWidth(a.width),b.setHeight(a.height),b.setX(a.x),b.setY(a.y),b.setName("feedback"),b.setClosebtn(a.closeButton),b.addToStage(q)):b={},b.pageObject=new Models.page("popup obj"),b.pageObject.numberofscreens=a.rawpage.getElementsByTagName("page").length,b.pageObject.pagexml=a.rawpage.getElementsByTagName("page"),b.pageObject.sounds=p.sounds,b.pageObject.images=p.images,b.pageObject.manifest=p.manifest,b.pageObject.transcripts=p.transcripts,B=b,a.activities.length>0){b.invisible=!1;for(var c=0,d=a.activities.length;d>c;c++)Factory.activityStore.createActivity(a.activities[c].firstChild.nodeValue,b.pageObject,$("#feedback")[0]);(null!=b.pageObject.pagexml[b.pageObject.pageposition].getAttribute("sound")||void 0!=b.pageObject.pagexml[b.pageObject.pageposition].getAttribute("sound"))&&(b.includeSound(!0),Global.soundController.playSound(b.pageObject.pagexml[b.pageObject.pageposition].getAttribute("sound"),b.pageObject))}else a.activities.length<1&&(null!=b.pageObject.pagexml[0].getAttribute("sound")||void 0!=b.pageObject.pagexml[0].getAttribute("sound"))&&(Global.soundController.playSound(b.pageObject.pagexml[0].getAttribute("sound"),b.pageObject),b.invisible=!0)}function l(a,b){var c=a.offset(),d=$(q).offset();return{x:c.left-d.left+b.left,y:c.top-d.top+b.top}}function m(){for(var a=0,b=x.length;b>a;a++)if(!x[a].complete)return!1;return!0}function n(a){return a.numberRequired===a.numberOn?!0:!1}var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=0,E=[];this.buildActivity=function(c,d){o=new Activities.base,p=c,q=d,r=d.getAttribute("id")+"-"+c.pageposition,C=new TimelineLite,p.addToReset(C);var e=$(p.pagexml[p.pageposition]).children("selectOptions")[0];A=Number($(e).children("buttonheight")>0)?Number($(e).children("buttonheight")):50,v=$(e).children("smallImageMaxWidth")[0]?Number($(e).children("smallImageMaxWidth")[0].firstChild.nodeValue):!1,w=$(e).children("smallMaxHeight")[0]?Number($(e).children("smallMaxHeight")[0].firstChild.nodeValue):!1;var f=$(e).children("target");u=f.length,t=[];for(var g=0;u>g;g++){t.push({x:Number(f[g].getAttribute("x")),y:Number(f[g].getAttribute("y")),width:Number(f[g].getAttribute("width")),height:Number(f[g].getAttribute("height")),toppadding:Number(f[g].getAttribute("lfromtop")),name:f[g].getAttribute("number"),colour:Helpers.convertColour(f[g].getAttribute("lfromtop")),textcolour:Helpers.convertColour(f[g].getAttribute("tColour")),revealdelay:Number(f[g].getAttribute("delay")),fontsize:Number(f[g].getAttribute("fontSize")),title:f[g].firstChild?f[g].firstChild.nodeValue:"",id:r+"-list-"+g,numberRequired:0,numberOn:0,shadow:"true"!==f[g].getAttribute("addShadow")?!1:!0});var h=f[g].getElementsByTagName("FB")?f[g].getElementsByTagName("FB")[0]:void 0;if(h){var i={width:Number(h.getAttribute("width")),height:Number(h.getAttribute("height")),x:Number(h.getAttribute("x")),y:Number(h.getAttribute("y")),bgVisible:"no"!==h.getAttribute("bgVisible")?!0:!1,closeButton:"no"!==h.getAttribute("closeBtn")?!0:!1,tickCross:"yes"===h.getAttribute("tickCross")?!0:!1,tickCrossX:Number(h.getAttribute("tickCrossX")),tickCrossY:Number(h.getAttribute("tickCrossY")),tickCrossMaxSize:Number(h.getAttribute("tcMaxSize")),activities:h.getElementsByTagName("activity"),rawpage:h};t[g].feedback=i}}x=[];var j=$(e).children("option");for(y=j.length,g=0;y>g;g++){var k=j[g].getElementsByTagName("dragger")[0],l=j[g].getElementsByTagName("title")[0],m=j[g].getElementsByTagName("cFB")[0],n=j[g].getElementsByTagName("icFB")[0];if(x[g]={id:r+"-dr-"+g,width:Number(k.getAttribute("width")),height:Number(k.getAttribute("height")),backgroundcolour:Helpers.convertColour(k.getAttribute("bColour")),delay:Number(k.getAttribute("delay")),title:l.firstChild.nodeValue,correctTarget:j[g].getElementsByTagName("correct")[0].firstChild.nodeValue,iconimage:j[g].getElementsByTagName("iconImage")[0].firstChild.nodeValue,complete:!1},m){var z={width:Number(m.getAttribute("width")),height:Number(m.getAttribute("height")),x:Number(m.getAttribute("x")),y:Number(m.getAttribute("y")),bgVisible:"yes"===m.getAttribute("bgVisible")?!0:!1,closeButton:"yes"===m.getAttribute("closeBtn")?!0:!1,tickCross:"yes"===m.getAttribute("tickCross")?!0:!1,tickCrossX:Number(m.getAttribute("tickCrossX")),tickCrossY:Number(m.getAttribute("tickCrossY")),tickCrossMaxSize:Number(m.getAttribute("tcMaxSize")),activities:m.getElementsByTagName("activity"),rawpage:m};x[g].cFeedback=z}if(n){var B={width:Number(n.getAttribute("width")),height:Number(n.getAttribute("height")),x:Number(n.getAttribute("x")),y:Number(n.getAttribute("y")),bgVisible:"yes"===n.getAttribute("bgVisible")?!0:!1,closeButton:"yes"===n.getAttribute("closeBtn")?!0:!1,tickCross:"yes"===n.getAttribute("tickCross")?!0:!1,tickCrossX:Number(n.getAttribute("tickCrossX")),tickCrossY:Number(n.getAttribute("tickCrossY")),tickCrossMaxSize:Number(n.getAttribute("tcMaxSize")),activities:n.getElementsByTagName("activity"),rawpage:n};x[g].icoFeedback=B}for(var D=0;u>D;D++)x[g].correctTarget===t[D].name&&(x[g].target=t[D],x[g].target.numberRequired++)}s={x:Number(e.getAttribute("scrollerx")),y:Number(e.getAttribute("scrollery"))-10,delayActivation:e.getAttribute("delayActivation"),width:Number(e.getAttribute("scrollerNumberVisible"))*(x[0].width+5),height:x[0].height+5,delayReveal:e.getAttribute("scrollerdelay")},a(),C.append(new TweenMax.delayedCall(s.delayReveal,b))}},Activities.OrderItems=function(){function a(){for(var a=0,b=t;b>a;a++)$(p).append('<div id="'+x[a].id+'" class="drag-drop-target"></div>'),TweenLite.set($("#"+x[a].id),{position:"absolute",x:x[a].x,y:x[a].y,width:x[a].width,height:x[a].height})}function b(){var a=5;for(i=0,ii=t;i<ii;i++){var b=new Helpers.listBox;if(b.setWidth(w[i].width),b.setHeight(w[i].height),b.setColour(w[i].colour),b.setOverColour("#74cc78"),b.setSelectColour("#fe7a7a"),b.setTextColour(w[i].fontColour),b.setId(w[i].id),b.drawBox(p),TweenLite.set($("#"+w[i].id),{y:w[i].y,x:w[i].x+40,opacity:0}),TweenLite.set($("#"+w[i].id+" .listbox-gradient"),{position:"absolute"}),w[i].icon){w[i].image=Helpers.addImage(w[i].icon,o.images,$("#"+w[i].id));var c=function(){return w[i].iconMaxSize/w[i].image.height<w[i].iconMaxSize/w[i].image.width?w[i].iconMaxSize/w[i].image.height:w[i].iconMaxSize/w[i].image.width}();w[i].image.scaledwidth=w[i].image.width*c,TweenLite.set(w[i].image.pic,{width:w[i].image.scaledwidth,height:w[i].image.height*c,y:0-(w[i].image.height*c-w[i].height)/2}),a=w[i].image.scaledwidth>a?w[i].image.scaledwidth:a}$("#"+w[i].id).append("<p>"+w[i].text+"</p>"),w[i].obj=b,w[i].drag=$("#"+w[i].id)}for(i=0,ii=t;i<ii;i++){w[i].icon&&TweenLite.set(w[i].image.pic,{x:a/2-w[i].image.scaledwidth/2}),TweenLite.set($("#"+w[i].id+" p"),{position:"absolute",paddingRight:5,left:a+5});var d=Helpers.verticalAlignText($("#"+w[i].id+" p"),$("#"+w[i].id));TweenLite.set($("#"+w[i].id+" p"),{top:d});var e=TweenLite.to($("#"+w[i].id),.3,{x:w[i].x,opacity:1,delay:.05*i});o.addToReset(e)}}function c(){r.button=new Helpers.Button(r.text),r.button.setHeight(r.height),r.button.setWidth(r.width),r.button.setButtonColour(r.colour),r.button.setRollOverColour(r.roColour),r.id=s+"-checkanswer",r.button.setId(r.id),r.button.drawButton(p),TweenLite.set($("#"+r.id),{left:r.x,top:r.y}),$("#"+r.id).on("click",function(){for(var a=0;t>a;a++)y[a].disable(),x[a].draggerOnTarget===x[a].correctOnTarget?x[a].correct=!0:(x[a].correct=!1,x[a].draggerOnTarget.obj.setState("selected")),x[a].draggerOnTarget.obj.removeInteraction();d()?k(_correctFb,!0):k(_incorrectFb,!1),r.button.removeFromStage()})}function d(){for(var a=0;t>a;a++)if(!x[a].correct)return!1;return!0}function e(){$(w).each(function(){var a=this,b=$(this.drag),c=b.parent(),d=(b.position(),{element:b,wrapper:c,width:c.outerWidth(),dropped:!1,moved:!1,dragger:a,get y(){return b}});d.draggable=f(d),y.push(d.draggable),b.on("mousedown touchstart",d,g)})}function f(a){function b(){if(!createjs.BrowserDetect.isFirefox){var b=1/h-1;TweenMax.set(this.target,{x:"+="+(this.x-e)*b,y:"+="+(this.y-f)*b})}if(x[u-1]&&a.draggable.y<x[u-1].y+x[u-1].height){var c=TweenLite.to(x[u-1].draggerOnTarget.drag,.3,{y:x[u].y});o.addToReset(c),x[u].draggerOnTarget=x[u-1].draggerOnTarget,x[u].draggerOnTarget.targetOn=x[u],x[u-1].draggerOnTarget=a.dragger,a.dragger.targetOn=x[u-1],j(a)}if(x[u+1]&&a.draggable.y>x[u+1].y){var d=TweenLite.to(x[u+1].draggerOnTarget.drag,.3,{y:x[u].y});o.addToReset(d),x[u].draggerOnTarget=x[u+1].draggerOnTarget,x[u].draggerOnTarget.targetOn=x[u],x[u+1].draggerOnTarget=a.dragger,a.dragger.targetOn=x[u+1],j(a)}}function d(){z||(c(),z=!0);for(var a=0;t>a;a++){var b=TweenLite.to(x[a].draggerOnTarget.drag,.3,{y:x[a].y});o.addToReset(b)}}var e,f,g=(a.wrapper,a.element),h=Global.model.zoom;return a.draggable=new Draggable(g,{type:"y",onDrag:b,onRelease:d,onPress:function(){e=this.x,f=this.y,h=Global.model.zoom}}),a.draggable}function g(a){var b=a.data;j(b),b.draggable.startDrag(a.originalEvent)}function h(){for(var a=0;t>a;a++)if(!x[a].correct){var b=TweenLite.to(x[a].correctOnTarget.drag,.5,{y:x[a].y});o.addToReset(b)}}function j(a){$(x).each(function(b){return a.dragger.targetOn===this?void(u=b):void 0})}function k(a,b){m();var c;if(c=new Helpers.popup,c.setWidth(a.width),c.setHeight(a.height),c.setX(a.x),c.setY(a.y),c.setName("feedback-order"),c.setClosebtn(!1),c.addToStage(p),c.addText(a.text),a.sound&&Global.soundController.playSound(a.sound,o),v=c,b)n.setToComplete();else{var d=new Helpers.Button("Show answer");d.setWidth(200);var e=s+"-viewanswer";d.setId(e);var f=a.height-50,g=a.width-220;d.drawButton("#feedback-order"),TweenLite.set($("#"+e),{left:g,top:f}),$("#"+e).on("click",function(){var b=new TweenMax.delayedCall(.5,h);o.addToReset(b);var e=new TweenMax.delayedCall(2,l);o.addToReset(e),a.hideOnReorder?c.removeFromStage():d.setState("inactive"),n.setToComplete()})}}function l(){for(var a=0;t>a;a++)w[a].obj.setState("active"),w[a].obj.removeInteraction()}function m(){v?v.removeFromStage():Global.soundController.stopSound()}var n,o,p,q,r,s,t,u,v,w=[],x=[],y=[],z=!1;this.buildActivity=function(c,d){CSSPlugin.defaultTransformPerspective=500,s=d.getAttribute("id")+"-"+c.pageposition,n=new Activities.base,p=d,o=c;var f=$(o.pagexml[o.pageposition]).children("draganddrop")[0];q={targetsDelay:Number(f.getAttribute("targetsdelay")),dragsDelay:Number(f.getAttribute("dragsDelay")),activateDelay:Number(f.getAttribute("activateDelay"))};var g=$(f).children("doneBtn")[0];r={colour:Helpers.convertColour(g.getAttribute("colour")),roColour:Helpers.convertColour(g.getAttribute("roColour")),text:g.getAttribute("text"),x:Number(g.getAttribute("x")),y:Number(g.getAttribute("y")),width:Number(g.getAttribute("width")),height:Number(g.getAttribute("height"))};var h=$(f).children("dragger");t=h.length;for(var i=[],j=0,k=t;k>j;j++)i.push(Number(h[j].getAttribute("targety")));Helpers.shuffleArray(i);for(var j=0,k=t;k>j;j++){var l={width:Number(h[j].getAttribute("width")),height:Number(h[j].getAttribute("height")),currentY:i[j],colour:Helpers.convertColour(h[j].getAttribute("colour")),roColour:Helpers.convertColour(h[j].getAttribute("roColour")),fontSize:Number($(h[j]).children("text")[0].getAttribute("fSize")),fontColour:Helpers.convertColour($(h[j]).children("text")[0].getAttribute("fColour")),text:$(h[j]).children("text")[0].firstChild.nodeValue,icon:$(h[j]).children("libraryicon")[0]?$(h[j]).children("libraryicon")[0].firstChild.nodeValue:null,iconMaxSize:$(h[j]).children("libraryicon")[0]?Number($(h[j]).children("libraryicon")[0].getAttribute("maxSize")):null,id:s+"-dragger-"+j,y:i[j],x:Number(h[j].getAttribute("targetx")),position:j},m={width:Number(h[j].getAttribute("width")),height:Number(h[j].getAttribute("height")),x:Number(h[j].getAttribute("targetx")),y:Number(h[j].getAttribute("targety")),id:s+"-target-"+j,correctOnTarget:l};w.push(l),x.push(m)}for(j=0,k=t;k>j;j++)for(var u=0;t>u;u++)if(x[j].y===w[u].y){x[j].draggerOnTarget=w[u],w[u].targetOn=x[j];break}cfbxml=$(f).children("correctfeedback")[0],_correctFb={x:Number(cfbxml.getAttribute("x")),y:Number(cfbxml.getAttribute("y")),width:Number(cfbxml.getAttribute("width")),height:Number(cfbxml.getAttribute("height")),sound:cfbxml.getAttribute("sound"),text:cfbxml.firstChild.nodeValue,fontColour:Helpers.convertColour(cfbxml.getAttribute("fontColour"))},icfbxml=$(f).children("incorrectfeedback")[0],_incorrectFb={x:Number(icfbxml.getAttribute("x")),y:Number(icfbxml.getAttribute("y")),width:Number(icfbxml.getAttribute("width")),height:Number(icfbxml.getAttribute("height")),sound:icfbxml.getAttribute("sound"),text:icfbxml.firstChild.nodeValue,fontColour:Helpers.convertColour(icfbxml.getAttribute("fontColour")),hideOnReorder:icfbxml.getAttribute("hideOnReorder")&&"false"===icfbxml.getAttribute("hideOnReorder")?!1:!0},a();var v=new TweenMax.delayedCall(q.dragsDelay,b);o.addToReset(v);var y=new TweenMax.delayedCall(q.activateDelay,e);o.addToReset(y)}},Activities.QuestionSeriesWithResponse=function(){"use strict";function a(){for(var a=0;l>a;a++){$(j).prepend('<div id="'+o[a].id+'" class="question-panel"><p>'+o[a].text+'</p><div id="'+o[a].id+'-qup" class="question-panel-answers"></div></div>'),TweenLite.set($("#"+o[a].id),{position:"absolute",top:m.y,left:m.x,width:o[a].width,height:o[a].height,opacity:0}),TweenLite.set($("#"+o[a].id+" p"),{position:"absolute",top:-30,left:10,width:o[a].width-20,opacity:0}),TweenLite.set($("#"+o[a].id+" .question-panel-answers"),{position:"absolute",top:o[a].answers[0].y-3,height:o[a].height-o[a].answers[0].y,left:0,width:"100%"});for(var c=0,e=o[a].answers.length;e>c;c++){o[a].answers[c].buttonid=o[a].id+"-qup-"+c+"-div",$("#"+o[a].id+"-qup").append('<div id="'+o[a].answers[c].buttonid+'" class="question-panel-answers-div question-panel-answers-div-'+a+'"><p id="'+o[a].id+"-qup-"+c+'" class="question-panel-answers-a">'+o[a].answers[c].text+"</p></div>"),TweenLite.set($("#"+o[a].answers[c].buttonid),{height:(o[a].height-o[a].answers[0].y)/e,textAlign:"center",x:-o[a].width-10});var f=Helpers.verticalAlignText($("#"+o[a].id+"-qup-"+c),$("#"+o[a].id+"-qup-"+c+"-div"));TweenLite.set($("#"+o[a].id+"-qup-"+c),{y:f,fontSize:o[a].answers[c].fontSize})}}b(),d(!0)}function b(){n.to($("#"+o[p].id),.3,{opacity:1}),n.to($("#"+o[p].id+" p"),.2,{top:10,opacity:1},"+=0.3"),n.to($("#"+o[p].answers[0].buttonid),.3,{x:0},"+=0.3");for(var a=1,b=o[p].answers.length;b>a;a++)n.to($("#"+o[p].answers[a].buttonid),.3,{x:0},"-=0.1");void 0!=o[p].sound&&Global.soundController.playSound(o[p].sound,i)}function c(){n.to($("#"+o[p].id),.2,{left:0,autoAlpha:0}),n.to($("#"+k+"-panel-next-"+p),.2,{top:600,autoAlpha:0}),n.to($("#"+k+"-popup-"+p),.2,{x:50,autoAlpha:0},"-=0.1")}function d(a){var b,c=o[p].answers.length;switch(a){case!0:for(var d=0;c>d;d++)b=$("#"+o[p].answers[d].buttonid),TweenLite.set(b,{cursor:"pointer"}),b.on("click",{pressed:d},e),i.addToResetEventListeners(b);break;case!1:for(var d=0;c>d;d++)b=$("#"+o[p].answers[d].buttonid),TweenLite.set(b,{cursor:"default"}),b.off()}}function e(a){d(!1);var b=a.data.pressed;o[p].answers[b].correct?(f(!0),$(".question-panel-answers-div-"+p).off()):(f(!1),$("#"+o[p].answers[b].buttonid).addClass("question-panel-answer-incorrect"))}function f(a){var b=new Helpers.popup;b.setWidth(o[p].feedback.width),b.setHeight(o[p].feedback.height),b.setName(k+"-popup-"+p),b.setClosebtn(!1),b.setX(o[p].feedback.x),b.setY(o[p].feedback.y),b.addToStage(j);var c=a?o[p].feedback.correctText:o[p].feedback.incorrectText,d=a?o[p].feedback.correctSound:o[p].feedback.incorrectSound;$("#"+b.name).prepend('<p class="p10">'+c+"</p>"),(null!=d||void 0!=d)&&(b.includeSound(!0),Global.soundController.playSound(d,i));for(var e=0,f=o[p].answers.length;f>e;e++){var h=$("#"+o[p].answers[e].buttonid);o[p].answers[e].correct&&h.addClass("question-panel-answer-correct")}g()}function g(){if(l-1>p){var a=new Helpers.Button("Next Question");a.setId(k+"-panel-next-"+p),a.setWidth(100),a.drawButton(j),TweenLite.set($("#"+k+"-panel-next-"+p),{left:o[p].feedback.x+o[p].feedback.width-110,top:o[p].feedback.y+o[p].feedback.height+20}),$("#"+k+"-panel-next-"+p).on("click",function(){$("#"+k+"-panel-next-"+p).off(),c(),p++,b(),d(!0)})}else h.setToComplete()}var h,i,j,k,l,m,n,o=[],p=0;this.buildActivity=function(b,c){h=new Activities.base,i=b,j=c,k=c.getAttribute("id")+"-"+b.pageposition,n=new TimelineLite,i.addToReset(n);var d=$(i.pagexml[i.pageposition]).children("QuestionSeries")[0];m={delay:d.getAttribute("delay"),transition:d.getAttribute("transition"),x:Number(d.getAttribute("x")),y:Number(d.getAttribute("y"))};var e=d.getElementsByTagName("question");l=e.length;for(var f=0;l>f;f++){for(var g={width:e[f].getAttribute("width"),height:e[f].getAttribute("height"),text:e[f].getElementsByTagName("questiontext")[0].firstChild.nodeValue,sound:e[f].getElementsByTagName("questiontext")[0].getAttribute("sound"),id:k+"-panel-"+f},p=e[f].getElementsByTagName("answer"),q=[],r=0,s=p.length;s>r;r++){var t={correct:"1"===p[r].getAttribute("correct")?!0:!1,delay:Number(p[r].getAttribute("delay")),width:Number(p[r].getAttribute("width")),height:Number(p[r].getAttribute("height")),colour:Helpers.convertColour(p[r].getAttribute("colour")),fontColour:Helpers.convertColour(p[r].getAttribute("fColour")),fontSize:Number(p[r].getAttribute("fSize")),x:Number(p[r].getAttribute("x")),y:Number(p[r].getAttribute("y")),fontAlign:p[r].getAttribute("align")?p[r].getAttribute("align"):"left",text:p[r].firstChild.nodeValue};q.push(t)}g.answers=q;var u=e[f].getElementsByTagName("feedback")[0],v={width:Number(u.getAttribute("width")),height:Number(u.getAttribute("height")),x:Number(u.getAttribute("x")),y:Number(u.getAttribute("y")),correctText:u.getElementsByTagName("correctFeedback")[0].firstChild.nodeValue,correctSound:u.getElementsByTagName("correctFeedback")[0].getAttribute("sound"),incorrectText:u.getElementsByTagName("incorrectFeedback")[0].firstChild.nodeValue,incorrectSound:u.getElementsByTagName("incorrectFeedback")[0].getAttribute("sound")};g.feedback=v,o.push(g)}var w=new TweenMax.delayedCall(m.delay,a);i.addToReset(w)}},Activities.ScenarioSeriesWithSelectionBtns=function(){"use strict";function a(){$(m).prepend('<div id="'+r[s].id+'" class="question-panel"><p>'+r[s].text+'</p><div id="'+r[s].id+'-qimage" class="question-panel-answers"></div></div>'),TweenLite.set($("#"+r[s].id),{position:"absolute",top:p.y,left:p.x,width:r[s].width,height:r[s].height,opacity:0}),TweenLite.set($("#"+r[s].id+" p"),{position:"absolute",top:-30,left:10,width:r[s].width-20,opacity:0}),TweenLite.set($("#"+r[s].id+" .question-panel-answers"),{position:"absolute",top:r[s].answers[0].y-3,height:r[s].height-r[s].answers[0].y,left:0,width:"100%"}),r[s].image&&(r[s].imageObj=Helpers.addImage(r[s].image,l.images,$("#"+r[s].id)),TweenLite.set($(r[s].imageObj.pic),{x:r[s].imagex,y:r[s].imagey}),r[s].effect&&$(r[s].imageObj.pic).addClass("apply-effect"))}function b(){$(m).prepend('<div id="'+r[s].id+'-answers" class="question-panel"><div id="'+r[s].id+'-qup" class="question-panel-answers"></div></div>'),TweenLite.set($("#"+r[s].id+"-answers"),{position:"absolute",top:p.y,left:r[s].answerPanelX,width:r[s].answerPanelWidth,height:r[s].answerPanelHeight,opacity:0});for(var a=0,b=r[s].answers.length;b>a;a++){r[s].answers[a].buttonid=r[s].id+"-qup-"+a+"-div",$("#"+r[s].id+"-qup").append('<div id="'+r[s].answers[a].buttonid+'" class="question-panel-answers-div question-panel-answers-div-'+s+'"><p id="'+r[s].id+"-qup-"+a+'" class="question-panel-answers-a">'+r[s].answers[a].text+"</p></div>"),TweenLite.set($("#"+r[s].answers[a].buttonid),{height:r[s].answerPanelHeight/b,textAlign:"center",x:r[s].answerPanelWidth+20,cursor:"pointer"});var c=Helpers.verticalAlignText($("#"+r[s].id+"-qup-"+a),$("#"+r[s].id+"-qup-"+a+"-div"));TweenLite.set($("#"+r[s].id+"-qup-"+a),{y:c,fontSize:r[s].answers[a].fontSize})}}function c(){q.to($("#"+r[s].id),.3,{opacity:1}),q.to($("#"+r[s].id+" p"),.2,{top:10,opacity:1},"+=0.3"),void 0!=r[s].sound&&Global.soundController.playSound(r[s].sound,l),r[s].continueBtn.btn.drawButton(m),r[s].continueBtn.btn.setState("inactive"),TweenLite.set($("#"+r[s].continueBtn.id),{position:"absolute",left:r[s].continueBtn.x,top:p.y+r[s].answerPanelHeight+20})}function d(){q.to($("#"+r[s].id+"-answers"),.3,{opacity:1});for(var a=0,b=r[s].answers.length;b>a;a++)q.to($("#"+r[s].answers[a].buttonid),.3,{x:0},"-=0.1"),$("#"+r[s].answers[a].buttonid).on("click",{pressed:r[s].answers[a]},e)}function e(a){var b=a.data.pressed;b.selected?($("#"+b.buttonid).removeClass("selected"),b.selected=!1):($("#"+b.buttonid).addClass("selected"),b.selected=!0),g()}function f(){var a,b,c=h();c?(a=r[s].feedback.correctText,b=r[s].feedback.correctSound):(a=r[s].feedback.incorrectText,b=r[s].feedback.incorrectSound),b&&Global.soundController.playSound(b,l),$(m).prepend('<div id="'+r[s].id+'-feedback" class="question-series-feedback-panel"><p>'+a+"</p></div>"),TweenLite.set($("#"+r[s].id+"-feedback"),{width:r[s].feedback.width,height:r[s].feedback.height,x:p.x+100,y:p.y+10}),TweenLite.set($("#"+r[s].id+"-feedback p"),{width:r[s].feedback.width-40,
x:20,y:30,opacity:0}),q.to($("#"+r[s].id+"-feedback"),.2,{x:Number(r[s].width)+Number(p.x-10)}),q.to($("#"+r[s].id+"-feedback p"),.3,{opacity:1});for(var d=0,e=r[s].answers.length;e>d;d++)$("#"+r[s].answers[d].buttonid).off();$("#"+r[s].continueBtn.id).off(),o-1>s?(r[s].continueBtn.btn.setText("Next Question"),r[s].continueBtn.btn.setState("active"),$("#"+r[s].continueBtn.id).on("click",i)):(r[s].continueBtn.btn.removeFromStage(),k.setToComplete())}function g(){$("#"+r[s].continueBtn.id).off();for(var a=0,b=0,c=r[s].answers.length;c>b;b++)if(r[s].answers[b].selected){a++;break}a>0?(r[s].continueBtn.btn.setState("active"),$("#"+r[s].continueBtn.id).on("click",f)):(r[s].continueBtn.btn.setState("inactive"),$("#"+r[s].continueBtn.id).off())}function h(){for(var a=!0,b=0,c=r[s].answers.length;c>b;b++)r[s].answers[b].correct?$("#"+r[s].answers[b].buttonid).addClass("question-panel-answer-correct"):$("#"+r[s].answers[b].buttonid).addClass("question-panel-answer-incorrect"),r[s].answers[b].correct!==r[s].answers[b].selected&&(a=!1);return a}function i(){r[s].continueBtn.btn.removeFromStage(),q.to($("#"+r[s].id+"-feedback"),.2,{x:p.x,autoAlpha:0}),q.to($("#"+r[s].id+"-answers"),.2,{x:20,autoAlpha:0},0),q.to($("#"+r[s].id),.3,{left:0,autoAlpha:0}),q.to($("#"+n+"-panel-next-"+s),.3,{y:50,autoAlpha:0}),q.to($("#"+n+"-popup-"+s),.3,{x:20,autoAlpha:0,onComplete:j},"-=0.1"),s++}function j(){a(),b(),c(),d()}var k,l,m,n,o,p,q,r=[],s=0;this.buildActivity=function(a,b){k=new Activities.base,l=a,m=b,n=b.getAttribute("id")+"-"+a.pageposition,q=new TimelineLite,l.addToReset(q);var c=$(l.pagexml[l.pageposition]).children("questionSeries")[0];p={delay:c.getAttribute("delay"),x:Number(c.getAttribute("x")),y:Number(c.getAttribute("y"))};var d=c.getElementsByTagName("question");o=d.length;for(var e=0;o>e;e++){for(var f={width:d[e].getAttribute("width"),height:d[e].getAttribute("height"),text:d[e].getElementsByTagName("questiontext")[0].firstChild.nodeValue,sound:d[e].getElementsByTagName("questiontext")[0].getAttribute("sound"),image:d[e].getElementsByTagName("questionImage")[0]?d[e].getElementsByTagName("questionImage")[0].firstChild.nodeValue:void 0,imagex:d[e].getElementsByTagName("questionImage")[0]?d[e].getElementsByTagName("questionImage")[0].getAttribute("x"):void 0,imagey:d[e].getElementsByTagName("questionImage")[0]?d[e].getElementsByTagName("questionImage")[0].getAttribute("y"):void 0,effect:d[e].getElementsByTagName("questionImage")[0]&&"yes"===d[e].getElementsByTagName("questionImage")[0].getAttribute("applyEffect")?!0:!1,id:n+"-panel-"+e,answerPanelX:Number(d[e].getAttribute("answerPanelX"))+p.x,answerPanelColour:Helpers.convertColour(d[e].getAttribute("answerPanelColour")),answerPanelHeight:Number(d[e].getAttribute("answerPanelHeight")),answerPanelWidth:Number(d[e].getAttribute("answerPanelWidth"))},g=d[e].getElementsByTagName("answer"),h=[],i=0,s=g.length;s>i;i++){var t={correct:"1"===g[i].getAttribute("correct")?!0:!1,delay:Number(g[i].getAttribute("delay")),width:Number(g[i].getAttribute("width")),height:Number(g[i].getAttribute("height")),colour:Helpers.convertColour(g[i].getAttribute("colour")),fontColour:Helpers.convertColour(g[i].getAttribute("fontColour")),selectedColour:Helpers.convertColour(g[i].getAttribute("selColour")),fontSize:Number(g[i].getAttribute("fontSize")),x:Number(g[i].getAttribute("x")),y:Number(g[i].getAttribute("y")),fontAlign:g[i].getAttribute("align")?g[i].getAttribute("align"):"left",text:g[i].firstChild.nodeValue,selected:!1};h.push(t)}f.answers=h;var u=d[e].getElementsByTagName("feedback")[0],v={width:Number(u.getAttribute("width")),height:Number(u.getAttribute("height")),x:Number(u.getAttribute("x")),y:Number(u.getAttribute("y")),correctText:u.getElementsByTagName("correctFeedback")[0].firstChild.nodeValue,correctSound:u.getElementsByTagName("correctFeedback")[0].getAttribute("sound"),incorrectText:u.getElementsByTagName("incorrectFeedback")[0].firstChild.nodeValue,incorrectSound:u.getElementsByTagName("incorrectFeedback")[0].getAttribute("sound")};f.feedback=v;var w=d[e].getElementsByTagName("checkBtn")[0],x=new Helpers.Button(w.firstChild.nodeValue);x.setId(n+"-panel-check-"+e),x.setWidth(Number(w.getAttribute("width"))),x.setHeight(Number(w.getAttribute("height"))),x.setButtonColour(Helpers.convertColour(w.getAttribute("colour"))),x.setRollOverColour(Helpers.convertColour(w.getAttribute("roColour"))),x.setFontColour(Helpers.convertColour(w.getAttribute("fontColour"))),x.setFontSize(Number(w.getAttribute("fontSize"))),f.continueBtn={x:Number(w.getAttribute("x"))+p.x,btn:x,id:n+"-panel-check-"+e},r.push(f)}var y=new TweenMax.delayedCall(p.delay,j);l.addToReset(y)}},Activities.DefinitionMatcher=function(){function a(){for(var a=[],b=0;r>b;b++)a.push(w[b].correctY);for(Helpers.shuffleArray(a),b=0;r>b;b++)w[b].currentY=a[b]}function b(){p.button=new Helpers.Button("Check Answer"),p.button.setHeight(p.height),p.button.setWidth(p.width),p.button.setFontColour(p.fontColour),p.button.setFontSize(p.fontSize),p.button.setButtonColour(p.bColour),p.button.setRollOverColour(p.roColour);var a=q+"-checkanswer";p.id=a,p.button.setId(a),p.button.drawButton(n),p.y=o.startingY-p.height-10,p.x=o.leftColumnX+o.leftbuttonwidth+o.rightbuttonwidth+o.paddingBetween-p.width,TweenLite.set($("#"+a),{left:p.x,top:p.y})}function c(){for(var a=o.paddingBetween+o.leftColumnX+o.leftbuttonwidth,b=0,c=r;c>b;b++){var d=q+"-term-"+b;v[b].id=d;var e=new Helpers.listBox;e.setId(d),e.setHeight(o.buttonheight),e.setWidth(o.leftbuttonwidth),e.setTextColour(v[b].fontColour),e.drawBox(n),v[b].button=e,$("#"+d).append('<a id="'+q+"-termtext-"+b+'">'+v[b].text+"</a>"),TweenLite.set($("#"+d),{left:o.leftColumnX,top:v[b].y,opacity:0,rotationX:90}),$("#"+d).css({"font-size":v[b].fontSize+"px",position:"absolute"}),$("#"+q+"-termtext-"+b).css({position:"absolute",left:"10px",width:o.leftbuttonwidth-20+"px",top:o.buttonheight/2-$("#"+q+"-termtext-"+b).height()/2+"px"}),$("#"+q+"-termtext-"+b).css({top:o.buttonheight/2-$("#"+q+"-termtext-"+b).height()/2+"px"});var f=q+"-def-"+b,g=new Helpers.iconBox;g.setId(f),w[b].id=f,g.setHeight(o.buttonheight),g.setWidth(o.rightbuttonwidth),g.seticonColour(o.defBgColour),g.iconOverColour(o.defRollColour),g.iconSelectColour(o.defSelectColour),g.drawIcon(n),w[b].button=g,$("#"+f).append('<a id="'+q+"-deftext-"+b+'">'+w[b].text+"</a>"),TweenLite.set($("#"+f),{left:a,top:w[b].currentY-2,opacity:0,rotationX:90}),$("#"+f).css({position:"absolute",display:"block",width:o.rightbuttonwidth,"font-size":w[b].fontSize+"px",color:w[b].fontColour}),$("#"+q+"-deftext-"+b).css({position:"absolute",display:"block",left:"10px",width:o.rightbuttonwidth-20+"px"}),$("#"+q+"-deftext-"+b).css({top:o.buttonheight/2-$("#"+q+"-deftext-"+b).height()/2+"px"})}}function d(){var a=new TimelineLite;l.addToReset(a);for(var b=0,c=r;c>b;b++)a.to($("#"+v[b].id),.5,{opacity:1,rotationX:0},0),a.to($("#"+w[b].id),.5,{opacity:1,rotationX:0},.4)}function e(){for(var a=0;r>a;a++)v[a].button.setState("active");$(".listbox-outer").on("click",function(a){for(var b=a.currentTarget.getAttribute("id"),c=0;r>c;c++)v[c].button.setState("active"),v[c].id===b&&(s=v[c]);s.button.setState("over"),f()}),l.addToResetEventListeners($(".listbox-outer"))}function f(){var a=new TimelineLite;l.addToReset(a);for(var c=0;r>c;c++)w[c].button.setState("active");$(".iconbox-outer").on("click",function(c){for(var d,e,f=c.currentTarget.getAttribute("id"),k=0;r>k;k++)w[k].id===f&&(e=w[k],w[k].button.setState("selected")),w[k].currentY===s.y&&(d=w[k],d.button.setState("selected")),w[k].button.removeInteraction();d.currentY=e.currentY,e.currentY=s.y,a.append(new TweenLite.to($("#"+f),.5,{top:s.y-2}),0),a.append(new TweenLite.to($("#"+d.id),.5,{top:d.currentY-2}),"-=0.4"),p.placed||(b(),$("#"+p.id).on("click",function(){h(),g(),j(i()),$("#"+p.id).off(),p.button.setState("inactive")}),l.addToResetEventListeners($("#"+p.id)),p.placed=!0),g()}),l.addToResetEventListeners($(".iconbox-outer"))}function g(){for(var a=0;r>a;a++)w[a].button.removeInteraction();$(".iconbox-outer").off()}function h(){for(var a=0;r>a;a++)v[a].button.setState("active");$(".listbox-outer").off()}function i(){for(var a=0,b=0;r>b;b++)w[b].currentY===w[b].correctY?(a++,w[b].button.setState("correct")):w[b].button.setState("incorrect"),w[b].button.removeInteraction(),v[b].button.removeInteraction();return a===r?!0:!1}function j(a){if(a){var b=new Helpers.popup;b.setWidth(t.width),b.setHeight(t.height),b.setName(q+"-popup-correct"),b.setClosebtn(!0),b.addToStage(n),$("#"+b.name).prepend('<p class="p10">'+t.text+"</p>"),(null!=t.sound||void 0!=t.sound)&&(b.includeSound(!0),Global.soundController.playSound(t.sound,l)),k.setToComplete();for(var c=0;r>c;c++)m.append(new TweenLite.to($("#"+w[c].id+"-inner"),.5,{backgroundColor:o.defBgColour},2))}else{var b=new Helpers.popup;b.setWidth(u.width),b.setHeight(u.height),b.setName(q+"-popup-incorrect"),b.setClosebtn(!1),b.addToStage(n),$("#"+b.name).append('<p class="p10">'+u.text+"</p>"),(null!=u.sound||void 0!=u.sound)&&(b.includeSound(!0),Global.soundController.playSound(u.sound,l));var d=new Helpers.Button("View Correct Answer");d.setWidth(200);var e=q+"-viewanswer";d.setId(e),d.drawButton("#"+b.name),d.y=o.startingY-p.height-20,d.x=o.leftbuttonwidth+o.rightbuttonwidth+o.paddingBetween;var f=u.width-220,g=u.height-50;TweenLite.set($("#"+e),{left:f,top:g}),$("#"+e).on("click",function(){for(var a=0;r>a;a++){var c=new TimelineLite;c.to($("#"+w[a].id),.5,{top:w[a].correctY-2}),c.to($("#"+w[a].id+"-inner"),.5,{backgroundColor:o.defBgColour},"+=1")}b.removeFromStage(),k.setToComplete()}),l.addToResetEventListeners($("#"+e))}}var k,l,m,n,o,p,q,r,s,t,u,m,v=[],w=[];this.buildActivity=function(b,f){CSSPlugin.defaultTransformPerspective=500,q=f.getAttribute("id")+"-"+b.pageposition,k=new Activities.base,n=f,l=b,m=new TimelineLite;var g=$(l.pagexml[l.pageposition]).children("matcherOptions")[0];o={delayreveal:Number(g.getAttribute("delay")),delayactivation:Number(g.getAttribute("delayactivation")),leftbuttonwidth:Number($(g).children("leftbuttonwidth")[0].firstChild.nodeValue),rightbuttonwidth:Number($(g).children("rightbuttonwidth")[0].firstChild.nodeValue),buttonheight:Number($(g).children("buttonheight")[0].firstChild.nodeValue),leftColumnX:Number($(g).children("leftColumnX")[0].firstChild.nodeValue),startingY:Number($(g).children("startingY")[0].firstChild.nodeValue),paddingBetween:Number($(g).children("paddingBetween")[0].firstChild.nodeValue),paddingBelow:Number($(g).children("paddingBelow")[0].firstChild.nodeValue),termBgColour:$(g).children("termBgColour")[0].firstChild.nodeValue,termRollColour:$(g).children("termRollColour")[0].firstChild.nodeValue,termSelectColour:$(g).children("termSelectColour")[0].firstChild.nodeValue,defBgColour:Helpers.convertColour($(g).children("defBgColour")[0].firstChild.nodeValue),defRollColour:Helpers.convertColour($(g).children("defRollColour")[0].firstChild.nodeValue),defSelectColour:Helpers.convertColour($(g).children("defSelectColour")[0].firstChild.nodeValue)},p={width:Number($(g).children("checkBtn")[0].getAttribute("width")),height:Number($(g).children("checkBtn")[0].getAttribute("height")),bColour:Helpers.convertColour($(g).children("checkBtn")[0].getAttribute("bColour")),roColour:Helpers.convertColour($(g).children("checkBtn")[0].getAttribute("roColour")),fontColour:Helpers.convertColour($(g).children("checkBtn")[0].getAttribute("fontColour")),fontSize:$(g).children("checkBtn")[0].getAttribute("fontSize"),placed:!1},t={width:Number($(g).children("correctfeedback")[0].getAttribute("width")),height:Number($(g).children("correctfeedback")[0].getAttribute("height")),sound:$(g).children("correctfeedback")[0].getAttribute("sound"),fontColour:Helpers.convertColour($(g).children("correctfeedback")[0].getAttribute("fontColour")),text:$(g).children("correctfeedback")[0].firstChild.nodeValue},u={width:Number($(g).children("incorrectfeedback")[0].getAttribute("width")),height:Number($(g).children("incorrectfeedback")[0].getAttribute("height")),sound:$(g).children("incorrectfeedback")[0].getAttribute("sound"),fontColour:Helpers.convertColour($(g).children("incorrectfeedback")[0].getAttribute("fontColour")),text:$(g).children("incorrectfeedback")[0].firstChild.nodeValue};var h=$(g).children("couple");r=h.length;for(var i=0;r>i;i++)v.push({fontColour:Helpers.convertColour($(h[i]).children("term")[0].getAttribute("fontColour")),fontSize:$(h[i]).children("term")[0].getAttribute("fontSize"),text:$(h[i]).children("term")[0].firstChild.nodeValue,y:o.startingY+i*o.buttonheight+i*o.paddingBetween}),w.push({fontColour:Helpers.convertColour($(h[i]).children("definition")[0].getAttribute("fontColour")),fontSize:$(h[i]).children("definition")[0].getAttribute("fontSize"),text:$(h[i]).children("definition")[0].firstChild.nodeValue,correctY:o.startingY+i*o.buttonheight+i*o.paddingBetween});a(),c();var j=new TweenMax.delayedCall(o.delayreveal,d),s=new TweenMax.delayedCall(o.delayactivation,e);l.addToReset(j),l.addToReset(s)}},Activities.RadioButtons=function(){function a(){for(var a=0;k>a;a++){$(i).append('<div id="form-'+a+'"></div>');for(var c=0,d=p[a].radio.length;d>c;c++)$("#form-"+a).append('<label for="qu-'+a+"-an-"+c+'" class="removable" id="qu-'+a+"-an-"+c+'-lab"><input type="radio" name="qu-'+a+'" value="" id="'+p[a].radio[c].id+'"><span></span></label>'),p[a].radio[c].id="qu-"+a+"-an-"+c,TweenLite.set($("#qu-"+a+"-an-"+c+"-lab"),{position:"absolute",left:p[a].radio[c].x,top:p[a].radio[c].y})}switch(TweenMax.staggerFrom($(".removable"),.5,{opacity:0,y:"-=20"},.05),j.showFb){case"select":$("input:radio").change(b)}}function b(a){if(c()){for(var b=0,f=0;k>f;f++)p[f].correct&&b++;b===k?m&&d(!0):n&&d(!1),g.setToComplete()}var h=a.target.getAttribute("name"),i=Number(h.substr(h.indexOf("-")+1));p[i].correct&&p[i].cfb?e(p[i].cfb):!p[i].correct&&p[i].icfb&&e(p[i].icfb)}function c(){for(var a=!0,b=0;k>b;b++)if($("#form-"+b+" input[name='qu-"+b+"']").is(":checked")){if(!p[b].done){for(var c=0,d=p[b].radio.length;d>c;c++)$("input[name='qu-"+b+"']:checked","#form-"+b).attr("id")==p[b].radio[c].id?(p[b].radio[c].selected=!0,p[b].radio[c].correct?p[b].correct=!0:p[b].correct=!1,$("#"+p[b].radio[c].id).prop("disabled",!0)):(p[b].radio[c].selected=!1,$("#"+p[b].radio[c].id).prop("disabled",!0));p[b].horizontal&&($(i).append("<div id='td-"+b+"' class='bgs25'></div>"),p[b].correct?$("#td-"+b).addClass("tickdiv"):$("#td-"+b).addClass("crossdiv"),TweenLite.set($("#td-"+b),{left:p[b].radio[p[b].radio.length-1].x+30,top:p[b].radio[0].y-8}))}p[b].done=!0}else p[b].done=!1,a=!1;return a}function d(a){var b=a?m:n;e(b)}function e(a){f();var b=new Helpers.popup;b.setWidth(a.width),b.setHeight(a.height),b.setName(l+"-popup-feedback"),b.setClosebtn(!0),b.setX(a.x),b.setY(a.y),b.addToStage(i);var c=a.text,d=a.sound;$("#"+b.name).prepend('<p class="p10">'+c+"</p>"),(null!=d||void 0!=d)&&(b.includeSound(!0),Global.soundController.playSound(d,h)),o=b,a.feedbackSeen=!0}function f(){o?o.removeFromStage():Global.soundController.stopSound()}var g,h,i,j,k,l,m,n,o,p=[];this.buildActivity=function(b,c){l=c.getAttribute("id")+"-"+b.pageposition,g=new Activities.base,i=c,h=b;var d=$(h.pagexml[h.pageposition]).children("radiobuttonoptions")[0];j={showFb:d.getAttribute("showFb"),delayReveal:Number(d.getAttribute("revealdelay"))};var e=d.getElementsByTagName("radioGroup");k=e.length;for(var f=0;k>f;f++){for(var o={radio:[]},q=e[f].getElementsByTagName("radio"),r=0,s=q.length;s>r;r++){var t={correct:1==q[r].getAttribute("correct")?!0:!1,x:Number(q[r].getAttribute("x")),y:Number(q[r].getAttribute("y")),width:Number(q[r].getAttribute("width")),id:"qu-"+f+"-an-"+r};o.radio[r]=t}for(p.push(o),p[f].horizontal=!0,r=1,s=q.length;s>r;r++)if(p[f].radio[r].y!==p[f].radio[r-1].y){p[f].horizontal=!1;break}var u=e[f].getElementsByTagName("groupfbcorrect")?e[f].getElementsByTagName("groupfbcorrect")[0]:void 0;if(u){var v={x:Number(u.getAttribute("x")),y:Number(u.getAttribute("y")),width:Number(u.getAttribute("width")),height:Number(u.getAttribute("height")),sound:u.getAttribute("sound"),text:u.firstChild.nodeValue};o.cfb=v}var w=e[f].getElementsByTagName("groupfbincorrect")?e[f].getElementsByTagName("groupfbincorrect")[0]:void 0;if(w){var x={x:Number(w.getAttribute("x")),y:Number(w.getAttribute("y")),width:Number(w.getAttribute("width")),height:Number(w.getAttribute("height")),sound:w.getAttribute("sound"),text:w.firstChild.nodeValue};o.icfb=x}}var y=d.getElementsByTagName("feedbackcorrect")?d.getElementsByTagName("feedbackcorrect")[0]:void 0;y&&(m={x:Number(y.getAttribute("x")),y:Number(y.getAttribute("y")),width:Number(y.getAttribute("width")),height:Number(y.getAttribute("height")),sound:y.getAttribute("sound"),text:y.firstChild.nodeValue});var z=d.getElementsByTagName("feedbackincorrect")?d.getElementsByTagName("feedbackincorrect")[0]:void 0;z&&(n={x:Number(z.getAttribute("x")),y:Number(z.getAttribute("y")),width:Number(z.getAttribute("width")),height:Number(z.getAttribute("height")),sound:z.getAttribute("sound"),text:z.firstChild.nodeValue});var A=new TweenMax.delayedCall(j.delayReveal,a);h.addToReset(A)}},Activities.SelectItems=function(){function a(){for(var a=0,b=q;b>a;a++){v[a].button.drawButton(o),v[a].button.btn=v[a].button.getButton(),TweenLite.set(v[a].button.btn,{x:v[a].x,y:v[a].y,opacity:0,rotationY:90,position:"absolute"});var c=TweenLite.to(v[a].button.btn,.5,{opacity:1,rotationY:0,delay:.05*a});n.addToReset(c)}}function b(){for(var a=0,b=q;b>a;a++)d(v[a].button);f()}function c(){u=!0,setTimeout(function(){u=!1},500)}function d(a){$(a.btn).off(),a.setBg(1),a.setSelected(!1),$(a.btn).css({cursor:"pointer"}).on("touchend",function(){$(a.btn).off(),e(a),c()}).on("click",function(){u||e(a)})}function e(a){w&&(w=!1,s.button.setState("active"),$("#"+s.id).on("click",function(){g(),i(h()),$("#"+s.id).off()})),$(a.btn).off(),a.setBg(3),a.setSelected(!0),$(a.btn).on("touchend",function(){$(a.btn).off(),d(a),c()}).on("click",function(){u||d(a)})}function f(){s.button=new Helpers.Button("Check Answer"),s.button.setHeight(s.height),s.button.setWidth(s.width),s.button.setFontColour(s.fontColour),s.button.setButtonColour(s.bColour),s.button.setRollOverColour(s.roColour),s.button.setSelectColour(s.selColour),s.toggleAnswers=new Helpers.Button("View Your Answer"),s.toggleAnswers.setHeight(s.height),s.toggleAnswers.setWidth(s.width),s.toggleAnswers.setFontColour(s.fontColour),s.toggleAnswers.setButtonColour(s.bColour),s.toggleAnswers.setRollOverColour(s.roColour),s.toggleAnswers.setSelectColour(s.selColour);var a=r+"-checkanswer";s.id=a,s.button.setId(a),s.toggleAnswers.setId(r+"-toggleanswer"),s.button.drawButton(o),s.button.setState("inactive"),s.y=s.y,s.x=s.x,TweenLite.set($("#"+a),{left:s.x,top:s.y})}function g(){for(var a=0;q>a;a++)v[a].button.removeInteraction()}function h(){for(var a=0;q>a;a++)if(v[a].button.getCorrect()!==v[a].button.getSelected())return!1;return!0}function i(a){var b=a?_cfeedback:_icofeedback,c=new Helpers.popup;if(c.setWidth(b.width),c.setHeight(b.height),c.setName(r+"-popup-feedback"),c.setClosebtn(!1),c.setX(b.x),c.setY(b.y),c.addToStage(o),$("#"+c.name).prepend('<p class="t30 l20">'+b.text+"</p>"),(null!=b.sound||void 0!=b.sound)&&(c.includeSound(!0),Global.soundController.playSound(b.sound,n)),s.button.removeFromStage(),b===_cfeedback)m.setToComplete();else{var d=new Helpers.Button("View Correct Answer");d.setWidth(200);var e=r+"-viewanswer";d.setId(e),d.drawButton("#"+c.name);var f=b.width-220,g=b.height-50;TweenLite.set($("#"+e),{left:f,top:g}),$("#"+e).on("click tap",function(){s.toggleAnswers.drawButton(o),TweenLite.set($("#"+r+"-toggleanswer"),{left:s.x,top:s.y}),$("#"+r+"-toggleanswer").on("click tap",function(){l()}),d.removeFromStage(),j(),m.setToComplete()})}}function j(){x=!1;for(var a=0,b=q;b>a;a++)v[a].button.getCorrect()?v[a].button.setBg(3):v[a].button.setBg(1)}function k(){x=!0;for(var a=0,b=q;b>a;a++)v[a].button.getSelected()?v[a].button.setBg(3):v[a].button.setBg(1)}function l(){x?(j(),$("#"+r+"-toggleanswer p").text("View Your Answer")):(k(),$("#"+r+"-toggleanswer p").text("View Correct Answer"))}var m,n,o,p,q,r,s,t,u,v=[],w=!0,x=!1;this.buildActivity=function(c,d){CSSPlugin.defaultTransformPerspective=500,r=d.getAttribute("id")+"-"+c.pageposition,m=new Activities.base,o=d,n=c,t=new TimelineLite;var e=$(n.pagexml[n.pageposition]).children("selectItemsOptions")[0];p={delayActivation:Number($(e).children("delayActivation")[0].firstChild.nodeValue),delayReveal:Number($(e).children("delayReveal")[0].firstChild.nodeValue),shiftLeft:e.getElementsByTagName("shiftLeft")[0]?Number(e.getElementsByTagName("shiftLeft")[0].firstChild.nodeValue):0};var f=$(e).children("clickitem");q=f.length;for(var g=0,h=q;h>g;g++){var i=new Helpers.buttonImage;i.setId(r+"-"+g+"-selectButton"),i.setCorrect(0===Number($(f[g]).children("correct")[0].firstChild.nodeValue)?!1:!0),i.setState1Image(Helpers.findImage($(f[g]).children("button")[0].firstChild.nodeValue,n.images)),i.setState2Image(Helpers.findImage($(f[g]).children("button")[0].firstChild.nodeValue+"_over",n.images)),i.setState3Image(Helpers.findImage($(f[g]).children("button")[0].firstChild.nodeValue+"_selected",n.images)),v.push({button:i,x:Number($(f[g]).children("x")[0].firstChild.nodeValue)-p.shiftLeft,y:Number($(f[g]).children("y")[0].firstChild.nodeValue)})}s={width:Number($(e).children("checkAnswerButton")[0].getAttribute("bWidth")),height:Number($(e).children("checkAnswerButton")[0].getAttribute("bHeight")),x:Number($(e).children("checkAnswerButton")[0].getAttribute("x")),y:Number($(e).children("checkAnswerButton")[0].getAttribute("y")),bColour:Helpers.convertColour($(e).children("checkAnswerButton")[0].getAttribute("bColour")),roColour:Helpers.convertColour($(e).children("checkAnswerButton")[0].getAttribute("bRoColour")),selColour:Helpers.convertColour($(e).children("checkAnswerButton")[0].getAttribute("bSelColour")),fontColour:Helpers.convertColour($(e).children("checkAnswerButton")[0].getAttribute("fontColour")),fontSize:$(e).children("checkAnswerButton")[0].getAttribute("fontSize")},_cfeedback={width:Number($(e).children("correctFb")[0].getAttribute("width")),height:Number($(e).children("correctFb")[0].getAttribute("height")),x:Number($(e).children("correctFb")[0].getAttribute("x")),y:Number($(e).children("correctFb")[0].getAttribute("y")),sound:$(e).children("correctFb")[0].getAttribute("sound"),fontColour:Helpers.convertColour($(e).children("correctFb")[0].getAttribute("fontColour")),text:$(e).children("correctFb")[0].firstChild.nodeValue},_icofeedback={width:Number($(e).children("incorrectFb")[0].getAttribute("width")),height:Number($(e).children("incorrectFb")[0].getAttribute("height")),x:Number($(e).children("incorrectFb")[0].getAttribute("x")),y:Number($(e).children("incorrectFb")[0].getAttribute("y")),sound:$(e).children("incorrectFb")[0].getAttribute("sound"),fontColour:Helpers.convertColour($(e).children("incorrectFb")[0].getAttribute("fontColour")),text:$(e).children("incorrectFb")[0].firstChild.nodeValue};var j=new TweenMax.delayedCall(p.delayReveal,a),k=new TweenMax.delayedCall(p.delayActivation,b);n.addToReset(j),n.addToReset(k)}},Activities.Assessment=function(){function a(){t=Helpers.shuffleArray(s);for(var a=t.length;t.length>o.numberOfQus;)t.splice(a,1),a--;for(var a=0,c=o.numberOfQus-1;c>a;a++)Helpers.shuffleArray(t[u].answers);b()}function b(){$(n).append('<div id="question-bg"><div id="qunumber"><p id="Q">Q</p></div></div>'),p=new Helpers.Button("Next Question");var a=m+"-continue";p.setId(a),p.drawButton(n),p.setState("inactive");$("#question-bg").height()+o.bgY+20,o.bgX+$("#question-bg").width()-160;TweenLite.set($("#"+p.getId()),{top:535,left:675}),d()}function c(){$("#form"+u+" label").click(function(){"active"!==p.getState()&&(p.setState("active"),$("#"+p.getId()).click(function(){for(var a=$("#form"+u+" input[type='radio']:checked").val(),b=0,c=t[u].answers.length;c>b;b++)t[u].answers[b].id===a&&(t[u].answers[b].selected=!0);f()}))})}function d(){var a=u+1;a==o.numberOfQus&&p.setText("Submit answers"),$("#qunumber").append('<p id="qnumber" class="removable">'+a+" / "+o.numberOfQus+"</p>"),$("#question-bg").append('<p id="qu-'+m+"-"+u+'" class="statement removable">'+t[u].qu.content+"</p><hr>"),l.set($("#question-bg"),{position:"absolute",left:o.bgX,top:o.bgY,width:Helpers.horizontalCentreWidth(o.bgX,$(n)),opacity:1}),l.set($("#qu-"+m+"-"+u),{left:o.quX-o.bgX,top:o.quY-o.bgY-10,opacity:1,color:o.quFontColour});var b=o.ansPanelX-o.bgX;for($("#question-bg").append('<div id="form'+u+'" class="formbox removable"></fieldset>'),l.set($("#form"+u),{position:"absolute",left:b,width:Helpers.horizontalCentreWidth(b,$("#question-bg")),top:o.ansPanelY-o.bgY,opacity:1}),i=0;i<4;i++)$("#form"+u).append('<label for="qu-'+m+"-"+u+"-an"+i+'" class="removable"><input type="radio" name="qu-'+m+"-"+u+'" value="'+t[u].answers[i].id+'" id="qu-'+m+"-"+u+"-an"+i+'"><span>'+t[u].answers[i].content+"</span></label>");c()}function e(){for(var a=0;4>a;a++)if(t[u].answers[a].selected&&t[u].answers[a].correct){t[u].answeredCorrectly=!0;break}}function f(){p.setState("inactive"),$("#"+p.getId()).off(),e(),u+1<o.numberOfQus?($(".removable").remove(),u++,d()):g()}function g(){var a,b=0;q=0,p.setState("inactive"),$("#"+m+"-continue").off();for(var c=0,d=t.length;d>c;c++)t[c].answeredCorrectly?(b++,q+=r):v.push(t[c].pageref);for(var e=t.length;e--;)t[e].answeredCorrectly&&t.splice(e,1);switch(x){case!1:b===o.numberOfQus?a="passed":b>=o.numberOfQus-o.tolerance?a="tolwrong":b<o.numberOfQus-o.tolerance&&(a="intolwrong");break;case!0:if(b<o.numberOfQus)switch(Global.model.getAfterAssessment()){case!1:a="stillwrong";break;case!0:a="intolwrong"}else a="passed"}h(a)}function h(a){for(var c,d,e=0,f=w.length;f>e;e++)if(w[e].name===a){c=w[e];break}if(View.clearContents(!0),d=c.text,$(n).append('<p id="assessment_fb" class="statement">'+c.text+"</p>"),"intolwrong"===a)Global.controller.failedAssessment(q);else if("stillwrong"===a)switch(Global.model.getAfterAssessment()){case!1:Global.controller.miniCourse(Helpers.uniqueArray(v),q);break;case!0:Global.controller.failedAssessment(q)}else if("tolwrong"===a){x=!0,Global.controller.sendScore(q);var g=new Helpers.Button("Try again"),h=m+"-btn";g.setId(h),g.drawButton(n),g.setState("active");var i=$("#question-bg").height()+o.bgY+20,j=o.bgX+$("#question-bg").width()-160;TweenLite.set($("#"+h),{left:j,top:i}),$("#"+h).click(function(){u=0,o.numberOfQus=t.length,$(n).empty(),b()})}else"passed"===a&&Global.controller.passedAssessment()}var j,k,l,m,n,o,p,q,r,s=[],t=[],u=0,v=[],w=[],x=!1;this.buildActivity=function(b,c){CSSPlugin.defaultTransformPerspective=500,m=c.getAttribute("id")+"-"+b.pageposition,j=new Activities.base,n=c,k=b,l=new TimelineLite;var d=$(k.pagexml[k.pageposition]).children("assessmentOptions")[0];o={tolerance:Number($(d).children("tolerance")[0].firstChild.nodeValue),bgX:Number($(d).children("bgX")[0].firstChild.nodeValue),bgY:Number($(d).children("bgY")[0].firstChild.nodeValue),quFontColour:Helpers.convertColour($(d).children("quFontColour")[0].firstChild.nodeValue),quFontSize:Number($(d).children("quFontSize")[0].firstChild.nodeValue),quX:Number($(d).children("quX")[0].firstChild.nodeValue),quY:Number($(d).children("quY")[0].firstChild.nodeValue),numberOfQus:Number($(d).children("noofqspermod")[0].firstChild.nodeValue),ansPanelX:Number($(d).children("ansPanelX")[0].firstChild.nodeValue),ansPanelY:Number($(d).children("ansPanelY")[0].firstChild.nodeValue),ansPanelWidth:Number($(d).children("ansPanelWidth")[0].firstChild.nodeValue),ansFontSize:Number($(d).children("ansFontSize")[0].firstChild.nodeValue),ansBgColour:Helpers.convertColour($(d).children("ansBgColour")[0].firstChild.nodeValue),ansRoColour:Helpers.convertColour($(d).children("ansRoColour")[0].firstChild.nodeValue),ansSelColour:Helpers.convertColour($(d).children("ansSelColour")[0].firstChild.nodeValue)},w=[{name:"passed"},{name:"tolwrong"},{name:"intolwrong"},{name:"intolfirstgowrong"},{name:"stillwrong"}];for(var e=0,f=w.length;f>e;e++)w[e].sound=$(d).children(w[e].name)[0].getAttribute("sound"),w[e].image=$(d).children(w[e].name)[0].getAttribute("image"),w[e].text=$(d).children(w[e].name)[0].firstChild.nodeValue;var g=d.getElementsByTagName("question");for(e=0,f=g.length;f>e;e++){for(var h={content:$(g[e]).children("text")[0].firstChild.nodeValue,width:$(g[e]).children("text")[0].getAttribute("width"),sound:$(g[e]).children("text")[0].getAttribute("sound")},i=g[e].getElementsByTagName("ans"),p=[],q=0,t=i.length;t>q;q++){var v={content:i[q].firstChild.nodeValue,correct:1===Number(i[q].getAttribute("correct"))?!0:!1,sound:i[q].getAttribute("sound"),selected:!1,id:u+"-"+q};p.push(v)}s.push({qu:h,answers:p,answeredCorrectly:!1,pageref:Number(g[e].getAttribute("refPageNo"))})}r=100/o.numberOfQus,a()}},Activities.ImageActivity=function(){function placeImages(){function playIt(a,b,c){var d=a.playIt();if(d&&_pageObject.addToReset(d),b){var e=TweenLite.to(c,.5,{scaleX:b,scaleY:b});_pageObject.addToReset(e)}}function setToComplete(){base.setToComplete()}for(var i=0,ii=_pageObject.images.length;ii>i;i++)for(var a=0,aa=_images.length;aa>a;a++)if(_pageObject.images[i].id==_images[a].getAttribute("name")){$(_pageObject.images[i].pic).css({position:"absolute",visibility:"visible"}),null!=_images[a].getAttribute("applyEffect")&&void 0!=_images[a].getAttribute("applyEffect")&&"yes"===_images[a].getAttribute("applyEffect")&&$(_pageObject.images[i].pic).addClass("apply-effect"),$(_holder).append(_pageObject.images[i].pic);var centred=null!=_images[a].getAttribute("centre")&&void 0!=_images[a].getAttribute("centre")&&"true"===_images[a].getAttribute("centre")?!0:!1,stx=centred?_images[a].getAttribute("x")-_pageObject.images[i].pic.width/2:_images[a].getAttribute("x"),sty=centred?_images[a].getAttribute("y")-_pageObject.images[i].pic.height/2:_images[a].getAttribute("y"),wid=_pageObject.images[i].width,hei=_pageObject.images[i].height,tl=new TimelineLite;centred?tl.set(_pageObject.images[i].pic,{left:stx,top:sty,width:wid,height:hei,opacity:0}):tl.set(_pageObject.images[i].pic,{x:stx,y:sty,width:wid,height:hei,opacity:0}),_pageObject.addToReset(tl);var tweens=_images[a].getElementsByTagName("moveImage"),tweenObj=new Helpers.tweenObject(tweens,_pageObject.images[i].pic,tl,centred)}for(i=0,ii=_pageObject.customjs.length;ii>i;i++)for(a=0,aa=_images.length;aa>a;a++)if(_pageObject.customjs[i].id===_images[a].getAttribute("name")){var centre=null!=_images[a].getAttribute("centre")&&void 0!=_images[a].getAttribute("centre")&&"true"===_images[a].getAttribute("centre")?!0:!1,result=eval(_pageObject.customjs[i].namespace+"."+_pageObject.customjs[i].id),res=new result,sx=centre?_images[a].getAttribute("x")-div.width/2:_images[a].getAttribute("x"),sy=centre?_images[a].getAttribute("y")-div.height/2:_images[a].getAttribute("y"),div=res.placeOnScreen(_holder),tl2=new TimelineLite;_pageObject.addToReset(tl2),tl2.set(div,{left:sx,top:sy,opacity:0}),tl2.to(div,.5,{left:sx,top:sy,opacity:1});for(var nextsteps=_images[a].getElementsByTagName("moveImage"),e=0,ee=nextsteps.length;ee>e;e++){var t=nextsteps[e].getAttribute("playit")?Number(nextsteps[e].getAttribute("playit")):null,s=nextsteps[e].getAttribute("scaleX")?Number(nextsteps[e].getAttribute("scaleX")):null;if(t){var d1=new TweenMax.delayedCall(t,playIt,[res,s,div]);_pageObject.addToReset(d1)}}$(document).on("bespokeFinished",setToComplete)}}var base,_pageNumber,_pageObject,_holder,_images=[];this.buildActivity=function(a,b){base=new Activities.base,base.page=_pageNumber,_pageObject=a,_images=$(_pageObject.pagexml[_pageObject.pageposition]).children("placeImage"),_holder=b,placeImages()}},Activities.Video=function(){function a(){for(var a=0;a<d.videoManifest.length;a++)for(var b=0,c=f;c>b;b++)if(d.videoManifest[a].id==g[b].getAttribute("name")){$(e).append('<div id="stageVideoContainer'+a+"\" class='pf-container'></div>");var h=Number(g[b].getAttribute("x")),i=Number(g[b].getAttribute("y"));
TweenLite.set($("#stageVideoContainer"+a),{position:"absolute",left:h,top:i});new PlayerFramework.Player("stageVideoContainer"+a,{mediaPluginFallbackOrder:["VideoElementMediaPlugin","SilverlightMediaPlugin"],width:Number(g[b].getAttribute("width")),height:Number(g[b].getAttribute("height")),sources:[{src:d.videoManifest[a].src,type:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'}]})}$(".pf-full-browser-control").remove()}var b,c,d,e,f,g=[];this.buildActivity=function(h,i){b=new Activities.base,b.page=c,d=h,g=$(d.pagexml[d.pageposition]).children("placeVideo"),f=g.length,e=i,a()}};var Models=Models||{};Models.global=function(){"use strict";this.modTitle,this.courseTitle,this.numberOfPages,this.pageOn,this.currentPageObject,this.pages=[],this.secondAttemptPages=[],this.secondAttemptNumberOfPages,this.onAfterAssessment=!1,this.development=!1,this.sidePanels=[],this.zoom=1,this.zoomBrowser,this.scorm=!1,this.scormInitialised=!1,this.scormProgress=[],this.scormBookmark=0,this.scormCompletion,this.manifestLoading=0,this.setScormProgressString=function(a){if(void 0===a||""===a||"0"===a)for(var b=0;b<this.numberOfPages;b++)this.scormProgress.push("0");else this.scormProgress=a.split(",")},this.setScormBookmark=function(a){this.scormBookmark=a},this.setCompletion=function(a){this.scormCompletion=a},this.addSidePanel=function(a){this.sidePanels.push(a)},this.setModTitle=function(a){this.modTitle=a},this.setCourseTitle=function(a){this.courseTitle=a},this.setNumberOfPages=function(a){this.numberOfPages=a},this.setScorm=function(a){this.scorm=a},this.setPageOn=function(a){this.pageOn=a,this.currentPageObject=this.pages[a]},this.setPageObject=function(a){this.currentPageObject=a},this.addPageToArray=function(a){this.pages.push(a)},this.setAfterAssessment=function(a){this.onAfterAssessment=a},this.getAfterAssessment=function(){return this.onAfterAssessment},this.setAllPagesIncomplete=function(){for(var a=0;a<this.numberOfPages;a++)this.pages[a].completed=!1},this.setAllPagesComplete=function(){for(var a=0;a<this.numberOfPages;a++)this.pages[a].setComplete(!0)},this.setPageIncomplete=function(a){void 0!=this.pages[a-1]&&this.pages[a-1].setComplete(!1)},this.setPageUnavailable=function(a){void 0!=this.pages[a-1]&&this.pages[a-1].setAvailable(!1)},this.setSecondAttemptPages=function(){this.secondAttemptNumberOfPages=0;for(var a=0,b=this.numberOfPages;b>a;a++)this.pages[a].completed||(this.secondAttemptPages.push(this.pages[a]),this.secondAttemptNumberOfPages++)},this.setZoomBrowser=function(a){this.zoomBrowser=a},this.setZoom=function(a){if(this.zoomBrowser)if(a)this.zoom=a;else{var b=window.innerWidth,c=window.innerHeight,d=b>=1009*(c/661)?c/662:b/1009;this.zoom=d}}},Models.page=function(a){function b(a){this.xml=a.result.documentElement;for(var b=this.xml.getElementsByTagName("page"),e=0,f=b.length;f>e;e++)"#document"==b[e].parentNode.parentNode.nodeName&&this.pagexml.push(b[e]);this.numberOfScreens=this.pagexml.length;var g=this.xml.getElementsByTagName("transcript");for(e=0,f=g.length;f>e;e++)this.transcripts.push({sound:g[e].getAttribute("sound"),text:g[e].firstChild.nodeValue});var h=[];for(this.xml.getElementsByTagName("LoaderMax")[0]&&this.xml.getElementsByTagName("LoaderMax")[0].childNodes.length>0&&(h=this.xml.getElementsByTagName("LoaderMax")[0].childNodes),e=0,f=h.length;f>e;e++)if(1===h[e].nodeType){var i={src:h[e].getAttribute("url"),id:h[e].getAttribute("name")};if(h[e].hasAttribute("extras"))for(var j=h[e].getAttribute("extras").replace(/ /g,"").split(","),k=0,l=j.length;l>k;k++){var m=i.src.replace(/\.swf$/,"_"+j[k]+".png"),n=i.id;n+="_"+j[k];var o={src:m,id:n};this.manifest.push(o)}if(h[e].hasAttribute("replaceext")){var p=h[e].getAttribute("replaceext").replace(/ /g,"");i.src=i.src.replace(/\.swf$/,"."+p),"mp4"===p?this.videoManifest.push(i):this.manifest.push(i)}else{var q=i.src.substr(i.src.lastIndexOf(".")+1);"mp4"==q&&this.videoManifest.push(i),this.manifest.push(i)}}c(this),d(this),this.linkActivities(this)}function c(a){for(var b=0,c=a.manifest.length;c>b;b++){var d=a.manifest[b].src.substr(a.manifest[b].src.lastIndexOf(".")+1);"swf"==d&&(a.manifest[b].src=a.manifest[b].src.substr(0,a.manifest[b].src.lastIndexOf(".")+1)+"png")}}function d(a){a.queue=new createjs.LoadQueue(!0),a.queue.installPlugin(createjs.Sound),a.queue.on("fileload",e,a),a.queue.on("complete",f,a),a.queue.on("error",function(b){if(b.data&&"png"===b.data.ext){var c=b.data.src.substr(0,b.data.src.lastIndexOf(".")+1)+"js";a.queue.loadFile({id:b.data.id,src:c})}}),a.queue.on("progress",function(){a.percentLoaded=Math.round(100*a.queue.progress)}),a===Global.model.pages[0]&&Global.controller.chooseLoader()}function e(a){switch(a.item.ext){case"mp3":a.item.sound=a.result,this.sounds.push(a.item);break;case"png":a.item.pic=a.result,a.item.width=a.result.width,a.item.height=a.result.height,this.images.push(a.item);break;case"mp4":a.item.vid=a.result,a.item.width=a.result.width,a.item.height=a.result.height,this.videos.push(a.item);break;case"js":a.item.namespace=a.item.src.substr(0,a.item.src.lastIndexOf("/")).substring(a.item.src.indexOf("/")+1).substring(a.item.src.indexOf("/")+2),this.customjs.push(a.item)}}function f(a){this.loaded=!0,Global.controller._loading=!1,Global.controller.chooseLoader()}THIS=this,this.name=a,this.images=[],this.sounds=[],this.videos=[],this.customjs=[],this.transcripts=[],this.activities=[],this.loaded=!1,this.route,this.xml,this.pagexml=[],this.pageposition=0,this.title,this.percentLoaded=0,this.manifest=[];this.videoManifest=[],this.numberOfScreens=1,this.completed=!1,this.available=!1,this.timeLinesToReset=[],this.eventsToReset=[],this.timedProgression=[],this.continueBtn=[],this.noSound=[],this.noRemove=[],this.stopSound=[],this.interval=void 0,this.queue=void 0,this.queueReady=!1,this.loadData=function(){var a=new createjs.LoadQueue(!1);a.on("fileload",b,this),a.loadFile(this.route)},this.addToReset=function(a){this.timeLinesToReset.push(a)},this.addToResetEventListeners=function(a){this.eventsToReset.push(a)},this.pageReset=function(){for(var a=0,b=this.timeLinesToReset.length;b>a;a++)this.timeLinesToReset[a].kill();for(a=0,b=this.eventsToReset.length;b>a;a++)$(this.eventsToReset[a]).off();this.pageposition=0,this.timeLinesToReset=[],this.interval&&clearInterval(this.interval)},this.setAvailable=function(a){this.available=a},this.linkActivities=function(a){for(var b=0;b<a.numberOfScreens;b++){var c=$(a.pagexml[b]).children("activities").children("activity"),d="true"===a.pagexml[b].getAttribute("noRemove")?!0:!1;this.noRemove.push(d);var e="true"===a.pagexml[b].getAttribute("continueBtn")?!0:!1,f={exists:e};e&&(f.x=a.pagexml[b].getAttribute("continueBtnX")?Number(a.pagexml[b].getAttribute("continueBtnX")):null,f.y=a.pagexml[b].getAttribute("continueBtnY")?Number(a.pagexml[b].getAttribute("continueBtnY")):null,f.text=a.pagexml[b].getAttribute("continueBtnText")?a.pagexml[b].getAttribute("continueBtnText"):"Continue"),this.continueBtn.push(f),void 0!=a.pagexml[b].getAttribute("clearTime")?this.timedProgression.push(Number(a.pagexml[b].getAttribute("clearTime"))):this.timedProgression.push(null);for(var g=0,h=c.length;h>g;g++){var i={name:c[g].childNodes[0].nodeValue,pageNumber:b};a.activities.push(i)}void 0!=a.pagexml[b].getAttribute("stopSoundWithTransition")&&"true"===a.pagexml[b].getAttribute("stopSoundWithTransition")?this.stopSound.push(!0):this.stopSound.push(!1)}return a.activities},this.setComplete=function(a){this.completed=a}},function(){function a(a){}function b(a){var b=a.result.documentElement;d=[],pagesxml=[],d=b.getElementsByTagName("XMLLoader"),Global.model.setCourseTitle(b.getElementsByTagName("coursetitle")[0].childNodes[0].nodeValue),Global.model.setModTitle(b.getElementsByTagName("modtitle")[0].childNodes[0].nodeValue),b.getElementsByTagName("iAmDeveloping")[0]&&(Global.model.development="true"==b.getElementsByTagName("iAmDeveloping")[0].childNodes[0].nodeValue?!0:!1),b.getElementsByTagName("scorm")[0]&&(Global.model.setScorm("true"===b.getElementsByTagName("scorm")[0].childNodes[0].nodeValue?!0:!1),Global.model.scorm&&(Global.scormController=new Controllers.scormController,Global.model.scormInitialised=Global.scormController.loadPage())),View.addCourseTitle(),pagesxml=b.getElementsByTagName("page"),Global.model.setNumberOfPages(pagesxml.length);for(var f=0,g=pagesxml.length;g>f;f++){var h=new Models.page(d[f].getAttribute("name"));h.route=d[f].getAttribute("url"),Global.model.addPageToArray(h),c(h),Global.model.development&&!Global.model.scormInitialised?(h.setComplete(!0),h.setAvailable(!0)):Global.model.development&&Global.model.scormInitialised?(h.setComplete(!1),h.setAvailable(!0)):!Global.model.development&&Global.model.scormInitialised&&("1"===Global.model.scormProgress[f]?h.setComplete(!0):h.setComplete(!1),(!Global.model.pages[f-1]||Global.model.pages[f-1].completed)&&h.setAvailable(!0)),h.loadData()}Global.menuController.setMenu(Global.model.pages),Global.model.scormInitialised&&Global.model.scormBookmark>0?e.setBookmarkPopup():e.setPage(0)}function c(a){for(var b=0,c=pagesxml.length;c>b;b++)if(pagesxml[b].getAttribute("xmlName")==a.name){a.title=pagesxml[b].childNodes[0].nodeValue;break}}var d,e;this.loadXml=function(c,d){e=d;var f=new createjs.LoadQueue(!1);f.on("fileload",b),f.on("error",a),f.loadFile(c)},this.loadGlossary=function(b,c){var d=new createjs.LoadQueue(!1);d.on("fileload",c.handleXml),d.on("error",a),d.loadFile(b)}}.apply(moduleXmlloader);var Controllers=Controllers||{};Controllers.master=function(){function a(b){console.log(b),console.log(b.manifest),b.queue?(console.log("WE HAVE A QUEUE"),b.queue.loadManifest(b.manifest),f._loading=!0):(console.log("WE DONT HAVE A QUEUE"),setTimeout(function(){a(b,b.manifest)},500))}function b(){return d[Global.model.pageOn]&&!d[Global.model.pageOn].loaded?Global.model.pageOn:d[Global.model.pageOn+1]&&!d[Global.model.pageOn+1].loaded?d+1:!1}function c(a){if(null!=a.timedProgression[a.pageposition]){var b=new TweenMax.delayedCall(a.timedProgression[a.pageposition],Global.controller.pageComplete);a.addToReset(b)}}var d=[];this.currentPage=0,this.pages=[];var e,f=this;this.begin=function(){function a(){Global.model.setZoom(),View.resizeView()}moduleXmlloader.loadXml("modxml/modulexml.xml",this),this.setPageArray("normal"),Global.model.zoomBrowser&&(a(),$(window).resize(function(){a()}))},this.loadGlossary=function(){var a=new Controllers.glossaryController;a.setGlossary(),moduleXmlloader.loadGlossary("../common/globalxml/glossary.xml",a),e=a,e.addButton($("#btn-glossary")),e.activateButton(e)},this.loadHelp=function(){var a=new Controllers.helpController;a.setHelp(),a.activateButton($("#btn-help"),a)},this.chooseLoader=function(c){if(!f._loading)if(c)a(c,c.manifest);else{var e=b();"number"==typeof e&&a(d[e])}},this.setPageArray=function(a){var a=a?a:"normal";switch(a){case"normal":d=Global.model.pages;break;case"afterAssessment":d=Global.model.secondAttemptPages}},this.setPage=function(a){function b(){return f.loaded?(clearInterval(g),$("#preloader").remove(),View.launchPage(f),c(f),void Global.controller.chooseLoader()):void $("#preloader").text("LOADING: "+f.percentLoaded+"%")}function e(){g=setInterval(function(){b()},500),f.interval=g}void 0!==Global.model.pageOn&&(TweenMax.killTweensOf($("#btn-next")),Global.model.currentPageObject.pageReset()),View.clearContents(),Global.soundController.stopSound(),Global.soundController.playDummy();var f=d[a];Global.model.setPageOn(a),Global.model.setPageObject(f),f.setAvailable(!0),View.setPageNumber(f),Global.model.scormInitialised&&Global.scormController.sendBookmark(a),Global.menuController.setButtonStatus(),this.activateNav(f,this);var g;return f.loaded?(View.launchPage(f),c(f),void Global.controller.chooseLoader()):(0===f.percentLoaded?($("#stage").append('<p id="preloader">Fetching page information</p>'),Global.controller.chooseLoader()):(console.log(f),$("#stage").append('<p id="preloader">LOADING: '+f.percentLoaded+"% </p>")),void e())},this.closeSidePanels=function(){for(var a=0,b=Global.model.sidePanels.length;b>a;a++)Global.model.sidePanels[a].setMenuOpen(!1),TweenLite.to($("#"+Global.model.sidePanels[a].getId()),.3,{width:0,zIndex:0})},this.pageComplete=function(){if(Global.model.currentPageObject.pageposition===Global.model.currentPageObject.numberOfScreens-1)Global.model.currentPageObject.setComplete(!0),Global.model.scormInitialised&&(Global.scormController.sendProgress(),Global.scormController.commit()),Global.model.currentPageObject.pageposition=0,d[Global.model.pageOn+1].setAvailable(!0),Global.menuController.setButtonStatus(),Global.controller.activateNav(Global.model.currentPageObject,Global.controller),View.buttonPulse($("#btn-next"));else if(Global.model.currentPageObject.pageposition<Global.model.currentPageObject.numberOfScreens-1)if(Global.model.currentPageObject.continueBtn[Global.model.currentPageObject.pageposition].exists){var a=new Helpers.Button("Continue"),b="shell_continue_page"+Global.model.currentPageObject.pageposition;a.setId(b),a.setText(Global.model.currentPageObject.continueBtn[Global.model.currentPageObject.pageposition].text),a.drawButton($("#stage")),TweenLite.set($("#"+b),{left:Global.model.currentPageObject.continueBtn[Global.model.currentPageObject.pageposition].x,top:Global.model.currentPageObject.continueBtn[Global.model.currentPageObject.pageposition].y}),$("#"+b).on("click",function(){View.clearContents(!0),Global.model.currentPageObject.stopSound[Global.model.currentPageObject.pageposition]&&Global.soundController.stopSound(),Global.model.currentPageObject.pageposition++,TweenMax.delayedCall(.5,View.launchPage,[Global.model.currentPageObject])})}else Global.model.currentPageObject.noRemove[Global.model.currentPageObject.pageposition]||(Global.model.currentPageObject.stopSound[Global.model.currentPageObject.pageposition]&&Global.soundController.stopSound(),View.clearContents(!0)),Global.model.currentPageObject.pageposition++,TweenMax.delayedCall(.5,View.launchPage,[Global.model.currentPageObject]),c(Global.model.currentPageObject)},this.setPages=function(a){pages=a},this.activateNav=function(a,b){var c=$("#btn-next"),d=$("#btn-prev"),f=$("#btn-replay"),g=$("#closebtn");$("#btn-menu, #btn-contr, #btn-next, #btn-prev, #btn-replay").off().removeClass("offNavButtons"),e&&e.activateButton(e);var h;switch(Global.model.getAfterAssessment()){case!1:h=Global.model.numberOfPages;break;case!0:h=Global.model.secondAttemptNumberOfPages}Global.model.pageOn>0?(d.on("click",function(){b.setPage(Global.model.pageOn-1)}),View.activeButton(d)):(d.off(),View.inactiveButton(d)),Global.model.pageOn+1<h&&a.completed?(c.on("click",function(){b.setPage(Global.model.pageOn+1)}),View.activeButton(c)):($(c).off(),View.inactiveButton(c)),$("#btn-menu").on("click",function(){Global.menuController.toggleMenu()}),$(f).on("click",function(){b.setPage(Global.model.pageOn)}),$(g).on("click",function(){Global.model.scormInitialised&&Global.scormController.doQuit(),parent.top.close()})},this.deactivateNav=function(){$("#btn-menu, #btn-contr, #btn-next, #btn-prev, #btn-replay").off().addClass("offNavButtons"),e&&e.deactivateButton()},this.failedAssessment=function(a){var b=this;Global.model.setAllPagesIncomplete(),Global.model.setAfterAssessment(!1),this.resetCourse(),View.activeButton($("#btn-next")),$("#btn-next").on("click",function(){b.setPage(0)}),b.sendScore(a),$("#btn-next").removeClass("offNavButtons")},this.passedAssessment=function(){var a=this;Global.model.setAfterAssessment(!1),Global.model.setAllPagesComplete(),a.sendScore(100,"completed")},this.sendScore=function(a,b){Global.model.scormInitialised&&(Global.scormController.sendScore(a),b&&(Global.model.setCompletion("completed"),Global.scormController.sendCompletion()),Global.scormController.commit())},this.miniCourse=function(a,b){var c=this;b&&c.sendScore(b),a.push(Global.model.numberOfPages),console.log(a),Global.model.setAfterAssessment(!0);for(var e=0,f=a.length;f>e;e++)Global.model.setPageIncomplete(a[e]),Global.model.setPageUnavailable(a[e]);Global.model.scormInitialised&&(Global.scormController.sendProgress(),Global.scormController.commit()),Global.model.setSecondAttemptPages(),Global.controller.setPageArray("afterAssessment"),Global.menuController.setMenuItems(d),$("#btn-next").on("click",function(){Global.model.currentPageObject.pageposition=0,c.setPage(0),Global.menuController.setButtonStatus()}),View.activeButton($("#btn-next")),View.buttonPulse($("#btn-next")),$("#btn-next").removeClass("offNavButtons")},this.resetCourse=function(){Global.controller.setPageArray("normal"),Global.menuController.setMenuItems(d);for(var a=0,b=Global.model.numberOfPages;b>a;a++)Global.model.pages[a].setComplete(!1),a>0?Global.model.pages[a].setAvailable(!1):Global.model.pages[a].setAvailable(!0);Global.menuController.setButtonStatus(),Global.model.scormInitialised&&(Global.scormController.sendProgress(),Global.scormController.commit())},this.setBookmarkPopup=function(){View.launchBookmarkPopup("bookmark_pg1","bookmark_bm"),$("#bookmark_pg1").on("click",function(){Global.soundController.playDummy(),View.clearContents(),$("#bookmark_pg1, #bookmark_bm").off(),Global.controller.setPage(0)}),$("#bookmark_bm").on("click",function(){Global.soundController.playDummy(),View.clearContents(),$("#bookmark_pg1, #bookmark_bm").off(),Global.controller.setPage(Global.model.scormBookmark)})}},Controllers.soundController=function(a){var b,c,d,e=this,f="";createjs.Sound.registerSound({id:"pop",src:"../common/commonassets/pop.mp3"}),createjs.Sound.registerSound({id:"blank",src:"../common/commonassets/blank.mp3"}),this.playSound=function(a,g){b=void 0;for(var h=0,i=g.manifest.length;i>h;h++)if(g.manifest[h].id===a){b=g.manifest[h].src;break}if(c){for(h=0,i=g.transcripts.length;i>h;h++)if(g.transcripts[h].sound===a){f=g.transcripts[h].text;break}c.html(f)}if(void 0!=b){createjs.Sound.play("blank"),createjs.Sound.stop(b),clearTimeout(d);var j=createjs.Sound.play(b);j.on("complete",e.resetDummyTimer)}},this.resetDummyTimer=function(){clearTimeout(d),d=setTimeout(e.playDummy,1e4)},this.playDummy=function(){createjs.Sound.play("blank"),e.resetDummyTimer()},this.playPop=function(){createjs.Sound.play("pop")},this.stopSound=function(){createjs.Sound.stop(b),e.resetDummyTimer()},this.activateTranscript=function(a,b,d){c=$(a);var e=$(b),f=c.parent(),g=$(d);$(f).append('<a id="close-transcript" class="boxclose"></a>'),$("#close-transcript").on("click",function(){$(f).toggle()});var h,i,j=Global.model.zoom;new Draggable(f,{trigger:g,onPress:function(){h=this.x,i=this.y,j=Global.model.zoom},onDrag:function(){if(!createjs.BrowserDetect.isFirefox){l;var a=1/j-1;TweenMax.set(this.target,{x:"+="+(this.x-h)*a,y:"+="+(this.y-i)*a})}}});$(e).on("click",function(){TweenMax.set($("#transcript"),{x:0,y:0}),$(f).toggle()})}},Controllers.menuController=function(){var a,b=[],c=!1;this.setMenuOpen=function(a){c=a},this.getId=function(){return"holderwrap"},this.setMenu=function(b){$("#holder").append('<div id="'+this.getId()+'" class="sliderwrap"><h2>Module Menu</h2><div id="module-menu"><ul id="module-menu-li"></ul></div><div class="mscrollbar"><div class="handle"><div class="mousearea"></div></div></div></div>'),this.addCloseButton(),this.setMenuItems(b);var c=$("#module-menu"),d=(c.children("ul").eq(0),c.parent());a=new Sly(c,{itemNav:"basic",smart:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:0,scrollBar:d.find(".mscrollbar"),scrollBy:1,speed:300,elasticBounds:1,dragHandle:1,dynamicHandle:1,clickBar:1}).init(),this.setButtonStatus(),Global.model.addSidePanel(this)},this.setMenuItems=function(c){b=[],$("#module-menu-li").empty();for(var d=0,e=c.length;e>d;d++)$("#module-menu-li").append('<li class="menu-item"><a id="menu-link-'+d+'">'+c[d].title+"</a></li>"),b.push({link:"menu-link-"+d,page:c[d]});a&&a.reload(),this.setButtonStatus()},this.addCloseButton=function(){$("#"+this.getId()).append('<a id="closeMenu" class="sliderclose">Close</a>'),TweenLite.set($("#closeMenu"),{x:240,y:10}),$("#closeMenu").on("click",function(a){Global.controller.closeSidePanels()})},this.setButtonStatus=function(){for(var a=0,c=b.length;c>a;a++)$("#"+b[a].link).removeClass(),$("#"+b[a].link).off(),b[a].page.completed&&$("#"+b[a].link).addClass("menu-item-completed"),b[a].page.available?$("#"+b[a].link).addClass("menu-item-available"):b[a].page.available||$("#"+b[a].link).addClass("menu-item-unavailable");$(".menu-item-available").on("click",function(a){Global.menuController.toggleMenu();var b=a.currentTarget.getAttribute("id"),c=Number(b.substr(b.lastIndexOf("-")+1));Global.controller.setPage(c)})},this.toggleMenu=function(){c?(c=!1,Global.controller.closeSidePanels()):(Global.controller.closeSidePanels(),c=!0,TweenLite.to($("#holderwrap"),.3,{width:300,zIndex:1e3}))}},Controllers.glossaryController=function(){"use strict";var a,b=[],c=!1,d=!1,e=null;this.setMenuOpen=function(a){d=a},this.getId=function(){return"glossarywrap"},this.setGlossary=function(a){$("#holder").append('<div id="'+this.getId()+'" class="sliderwrap"></div>'),Global.model.addSidePanel(this),this.addCloseButton()},this.handleXml=function(a){c=!0,$("#glossarywrap").append('<h2>Glossary</h2><div id="module-glossary"><ul id="glossary-li"></ul></div><div class="mscrollbar"><div class="handle"><div class="mousearea"></div></div></div><div id="glossary-definition"></div>');for(var d=a.result.documentElement,f=d.getElementsByTagName("heading"),g=0,h=f.length;h>g;g++){var i=f[g].getAttribute("name"),j="gl-"+g;b.push({id:j,term:i,definition:f[g].childNodes[0].nodeValue}),$("#glossary-li").append('<li class="menu-item "><a id='+j+' class="glossary-item" >'+i+"</a></li>")}$(".glossary-item").on("click",function(){for(e=this.getAttribute("id"),g=0,h=f.length;h>g;g++)b[g].id===e?($("#"+b[g].id).addClass("selected"),$("#glossary-definition").html("<p><b>"+b[g].term+"</b><br /><br />"+b[g].definition+"</p>")):$("#"+b[g].id).removeClass("selected")}),e||$("#glossary-definition").html("<p><b>Glossary</b><br /><br />Select a term from the left</p>");var k=$("#module-glossary"),l=(k.children("ul").eq(0),k.parent());k.sly({itemNav:"basic",smart:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:0,scrollBar:l.find(".mscrollbar"),scrollBy:1,speed:300,elasticBounds:1,dragHandle:1,dynamicHandle:1,clickBar:1})},this.deactivateButton=function(){$(a).off().addClass("offNavButtons")},this.activateButton=function(b){$(a).off(),$(a).on("click",function(){b.toggleMenu()}).removeClass("offNavButtons")},this.addButton=function(b){a=b},this.addCloseButton=function(){$("#"+this.getId()).append('<a id="closeGloss" class="sliderclose">Close</a>'),TweenLite.set($("#closeGloss"),{x:640,y:10}),$("#closeGloss").on("click",function(a){Global.controller.closeSidePanels()})},this.toggleMenu=function(){d?Global.controller.closeSidePanels():(Global.controller.closeSidePanels(),d=!0,TweenLite.to($("#glossarywrap"),.3,{width:700,zIndex:1e3}))}},Controllers.helpController=function(){"use strict";var a=!1;this.setMenuOpen=function(b){a=b},this.getId=function(){return"helpwrap"},this.setHelp=function(a){$("#holder").append('<div id="'+this.getId()+'" class="sliderwrap"><h2>Help</h2></div>'),$("#"+this.getId()).append('<img id="helppopupimage" src="../common/images/help.png" width="623" height="394" alt=""/>'),Global.model.addSidePanel(this),this.addCloseButton()},this.activateButton=function(a,b){$(a).on("click",function(){b.toggleMenu()})},this.addCloseButton=function(){$("#"+this.getId()).append('<a id="closeHelp" class="sliderclose">Close</a>'),TweenLite.set($("#closeHelp"),{x:640,y:10}),$("#closeHelp").on("click",function(a){Global.controller.closeSidePanels()})},this.toggleMenu=function(){a?Global.controller.closeSidePanels():(Global.controller.closeSidePanels(),a=!0,TweenLite.to($("#helpwrap"),.3,{width:700,zIndex:1e3}))}},Controllers.scormController=function(){function a(){e=(new Date).getTime()}function b(){var a;if(0!=e){var b=(new Date).getTime(),d=b-e;a=c(d)}else a="00:00:00.0";LMSSetValue("cmi.core.session_time",a)}function c(a){for(var b=0,c=0,d=0;a>=36e5;)d+=1,a-=36e5;for(;a>=6e4;)c+=1,a-=6e4;for(;a>=1e3;)b+=1,a-=1e3;10>d&&(d="0"+d),10>c&&(c="0"+c),10>b&&(b="0"+b);var e=d+":"+c+":"+b;return e}function d(){for(var a="",b=0;b<Global.model.numberOfPages;b++)a+=Global.model.pages[b].completed?"1":"0",b<Global.model.numberOfPages-1&&(a+=",");return a}var e,f=!1;this.loadPage=function(){f=!1;var b=LMSInitialize();return Global.model.setCompletion(LMSGetValue("cmi.core.lesson_status")),Global.model.setScormProgressString(this.getProgress()),Global.model.setScormBookmark(this.getBookmark()),Global.model.scormCompletion.toLowerCase(),"not attempted"===Global.model.scormCompletion&&(Global.model.setCompletion("incomplete"),this.sendCompletion(),LMSCommit()),a(),b?!0:!1},this.doQuit=function(){if(!f){b();var a=LMSCommit();f=!0,a=LMSFinish()}},this.sendScore=function(a){LMSSetValue("cmi.core.score.raw",a)},this.sendProgress=function(){var a=d();LMSSetValue("cmi.suspend_data",a)},this.sendBookmark=function(a){LMSSetValue("cmi.core.lesson_location",a)},this.sendCompletion=function(){LMSSetValue("cmi.core.lesson_status",Global.model.scormCompletion)},this.getProgress=function(){var a=LMSGetValue("cmi.suspend_data");return a},this.getBookmark=function(){var a=LMSGetValue("cmi.core.lesson_location");return Number(a)},this.commit=function(){return LMSCommit()}};var View=View||{};View.clearContents=function(a){"use strict";var b=null!=a||void 0!=a?a:!1,c=document.getElementById("stage");if(b)for(var d=0,e=c.childNodes.length;e>d;d++)TweenLite.to(c.childNodes[d],.25,{autoAlpha:0});else for(;c.firstChild;)c.removeChild(c.firstChild)},View.launchPage=function(a){"use strict";for(var b=document.getElementById("stage"),c=0,d=a.activities.length;d>c;c++)a.activities[c].pageNumber==a.pageposition&&Factory.activityStore.createActivity(a.activities[c].name,a,b);null==a.pagexml[a.pageposition].getAttribute("sound")&&void 0==a.pagexml[a.pageposition].getAttribute("sound")||"true"===a.pagexml[a.pageposition].getAttribute("noSoundHTML")||Global.soundController.playSound(a.pagexml[a.pageposition].getAttribute("sound"),a)},View.setPageNumber=function(a){var b;b=Global.model.getAfterAssessment()?Global.model.secondAttemptNumberOfPages:Global.model.numberOfPages,$("#pagenumber").html(Global.model.pageOn+1+" / "+b),View.editPageTitle(a.title)};var Factory=Factory||{};Factory.activityStore={createActivity:function(a,b,c){switch(a){case"Image":var d=new Activities.ImageActivity;d.buildActivity(b,c);break;case"Bullets":var d=new Activities.BulletActivity;d.buildActivity(b,c);break;case"AddText":var d=new Activities.TextActivity;d.buildActivity(b,c);break;case"ActivityText":var d=new Activities.ActivityText;d.buildActivity(b,c);break;case"ClickRevealStandard":var d=new Activities.ClickReveal;d.buildActivity(b,c);break;case"DefinitionMatcher":var d=new Activities.DefinitionMatcher;d.buildActivity(b,c);break;case"DragFromScrollerIntoList":var d=new Activities.DragFromScrollerIntoList;d.buildActivity(b,c);break;case"SelectItems":var d=new Activities.SelectItems;d.buildActivity(b,c);break;case"Assessment":var d=new Activities.Assessment;d.buildActivity(b,c),Global.controller.deactivateNav();break;case"DragDropToTargets":var d=new Activities.DragDropToTargets;d.buildActivity(b,c);break;case"Crossword":var d=new Activities.Crossword;d.buildActivity(b,c);break;case"QuestionSeriesWithResponse":var d=new Activities.QuestionSeriesWithResponse;d.buildActivity(b,c);break;case"DragDropIntoList":var d=new Activities.DragDropIntoList;d.buildActivity(b,c);break;case"LinkLists":var d=new Activities.LinkLists;d.buildActivity(b,c);break;case"ScenarioSeriesWithSelectionBtns":var d=new Activities.ScenarioSeriesWithSelectionBtns;d.buildActivity(b,c);break;case"RadioButtons":var d=new Activities.RadioButtons;d.buildActivity(b,c);break;case"OrderItems":var d=new Activities.OrderItems;d.buildActivity(b,c);break;case"DragFromScrollerAnimated":var d=new Activities.DragFromScrollerIntoListAnimated;d.buildActivity(b,c);break;case"Video":var d=new Activities.Video;d.buildActivity(b,c)}}},View.addCourseTitle=function(){$("#shelltop").prepend('<h1 id="courseTitle">'+Global.model.courseTitle+"</h1>"),$("#shelltop").prepend('<h2 id="pageTitle"></h2>')},View.editPageTitle=function(a){$("#pageTitle").text(a)},View.activeButton=function(a){"use strict";a.hasClass("active")||a.addClass("active"),a.hasClass("inactive")&&a.removeClass("inactive")},View.inactiveButton=function(a){"use strict";a.hasClass("inactive")||a.addClass("inactive"),a.hasClass("active")&&a.removeClass("active")},View.buttonPulse=function(a){"use strict";var b=TweenMax.to(a,.6,{boxShadow:"0px 0px 1px 1px rgb(168,255,164)",repeat:-1,yoyo:!0,ease:Linear.easeNone,paused:!0});b.play(),a.on("mouseleave",function(){b.play()}),a.on("mouseenter",function(){var a=b.time();b.reverse(a)}),Global.model.currentPageObject.addToReset(b)},View.resizeView=function(){$("#holder").css({zoom:Global.model.zoom,"-moz-transform":"scale("+Global.model.zoom+")"})},View.launchBookmarkPopup=function(a,b){var c=new Helpers.popup;c.setName("bookmark_popup"),c.setClosebtn(!1),c.setWidth(500),c.setHeight(200),c.addToStage($("#stage")),$("#"+c.name).append("<h3 style='text-align:center; margin:30px auto;'>Would you like to continue the course where you left off?</h3>");var d=new Helpers.Button("Yes");d.setWidth(200),d.setId(b),d.drawButton("#bookmark_popup");var e=c.width-220,f=c.height-50;TweenLite.set($("#"+b),{left:e,top:f});var g=new Helpers.Button("No");g.setWidth(200),g.setId(a),g.drawButton("#bookmark_popup");var h=20,i=c.height-50;TweenLite.set($("#"+a),{left:h,top:i})};